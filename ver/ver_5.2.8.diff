=== modified file '.bzrignore'
--- .bzrignore	2016-12-30 14:10:51 +0000
+++ .bzrignore	2017-02-20 10:01:14 +0000
@@ -1,60 +1,51 @@
-.idea
+.bzrignore
 butt.py
 bwl/clr2.py
 changes.txt
-chg.py
-csv/all_data_types.py
-doc/Bowls.pdf
-doc/Bowls.rst
-doc/Changes.rst
-doc/Contact.rst
-doc/Downloads.rst
-doc/Manual.pdf
-doc/Manual.rst
+csv/allcoy.py
+csv/allcoy.txt
+csv/ldraws_fld.csv
+csv/ldraws_idx.csv
+csv/lentry_fld.csv
+csv/lentry_idx.csv
+csv/lfixed_fld.csv
+csv/lfixed_idx.csv
+csv/lotsys.py
+csv/ltrans_fld.csv
+csv/ltrans_idx.csv
 doc/Notes.txt
-doc/QuickStart.pdf
-doc/Rsync.rst
-doc/Support.rst
 doc/Vacation.rst
 doc/bankserv.txt
 doc/bkmdoc.py
 doc/dkimspf.rst
-doc/gnugpl.rst
-doc/gnugpl.txt
-doc/manual.css
 doc/mynut.txt
-doc/mystylesheet
 doc/nfs_setup.rst
 doc/nut_ups.odt
 doc/postfix_vacation.txt
 doc/postgresql_upgrade.txt
-doc/stylesheet
 doc/tarlic.pdf
-doc/tarlic.rst
 doc/vnc_setup.rst
 doc/volmoed_client.sh
-doprt.py
+doc/vpn_files.txt
 flake.ign
 flakes
 lon/implon.py
 lon/rneim2.py
 lon/rneimp.py
+lon/rnelon.py
 mst/csv
 mst/doc
 mst/img
-penv.py
-repprt.py
+mst/thm
 scp/all.sh
 scp/doitall
 scp/pop.py
 scp/states
 sdy/
-sqltab.py
 std/fcrypt.py
 std/fpdf/
 std/ghostscript/
 std/paramiko/
-std/profilehooks.py
 std/progressbar/
 std/pychart/
 std/pymagic.py
@@ -62,32 +53,21 @@
 std/tarchg.py
 std/tarmod.py
 sve/
-uty/SumatraPDF-settings.txt
+thm/
 uty/SumatraPDF.exe
 uty/chksms.py
 uty/gzip.exe
-uty/pdfp.exe
-uty/pdftops.exe
-uty/redpr.exe
 uty/sed.exe
+uty/sqldiff.exe
 uty/sqlite3.exe
+uty/sqlite3_analyzer.exe
 uty/unzip.exe
 uty/vim.exe
 uty/zip.exe
 ver/
-web
-mst/thm
-thm
-img/tcltk.png
-doc/vpn_files.txt
-lon/rnelon.py
-csv/ldraws_fld.csv
-csv/ldraws_idx.csv
-csv/lentry_fld.csv
-csv/lentry_idx.csv
-csv/lfixed_fld.csv
-csv/lfixed_idx.csv
-csv/lotsys.py
-csv/ltrans_fld.csv
-csv/ltrans_idx.csv
-tmp
+web/
+doc/Rsync.rst
+doc/gnugpl.rst
+doc/gnugpl.txt
+men/posmen.py
+img/ptrust.jpg

=== modified file 'ass/ar1010.py'
--- ass/ar1010.py	2016-02-27 13:18:41 +0000
+++ ass/ar1010.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2010.py'
--- ass/ar2010.py	2016-02-27 13:18:41 +0000
+++ ass/ar2010.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2020.py'
--- ass/ar2020.py	2016-02-27 13:18:41 +0000
+++ ass/ar2020.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2030.py'
--- ass/ar2030.py	2016-02-27 13:18:41 +0000
+++ ass/ar2030.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3010.py'
--- ass/ar3010.py	2016-02-27 13:18:41 +0000
+++ ass/ar3010.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3020.py'
--- ass/ar3020.py	2016-02-27 13:18:41 +0000
+++ ass/ar3020.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3030.py'
--- ass/ar3030.py	2016-02-27 13:18:41 +0000
+++ ass/ar3030.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3040.py'
--- ass/ar3040.py	2016-05-21 12:42:32 +0000
+++ ass/ar3040.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3050.py'
--- ass/ar3050.py	2016-02-27 13:18:41 +0000
+++ ass/ar3050.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'ass/ar4010.py'
--- ass/ar4010.py	2016-07-10 11:57:24 +0000
+++ ass/ar4010.py	2017-01-28 08:53:07 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar6010.py'
--- ass/ar6010.py	2016-02-27 13:18:41 +0000
+++ ass/ar6010.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/ar6020_rne.py'
--- ass/ar6020_rne.py	2016-02-27 13:18:41 +0000
+++ ass/ar6020_rne.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'ass/ar6030_rne.py'
--- ass/ar6030_rne.py	2016-02-27 13:18:41 +0000
+++ ass/ar6030_rne.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'ass/arc110.py'
--- ass/arc110.py	2016-02-27 13:18:41 +0000
+++ ass/arc110.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/arc210.py'
--- ass/arc210.py	2016-07-10 11:57:24 +0000
+++ ass/arc210.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/arc310.py'
--- ass/arc310.py	2016-02-27 13:18:41 +0000
+++ ass/arc310.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/arc320.py'
--- ass/arc320.py	2016-02-27 13:18:41 +0000
+++ ass/arc320.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk1010.py'
--- bkm/bk1010.py	2016-05-21 12:42:32 +0000
+++ bkm/bk1010.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk1020.py'
--- bkm/bk1020.py	2016-05-21 12:42:32 +0000
+++ bkm/bk1020.py	2017-01-28 08:53:08 +0000
@@ -23,7 +23,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'bkm/bk2010.py'
--- bkm/bk2010.py	2016-02-27 13:18:41 +0000
+++ bkm/bk2010.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'bkm/bk3010.py'
--- bkm/bk3010.py	2016-05-21 12:42:32 +0000
+++ bkm/bk3010.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3020.py'
--- bkm/bk3020.py	2016-12-30 14:10:51 +0000
+++ bkm/bk3020.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3030.py'
--- bkm/bk3030.py	2016-05-21 12:42:32 +0000
+++ bkm/bk3030.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import datetime, os, time

=== modified file 'bkm/bk3040.py'
--- bkm/bk3040.py	2016-02-27 13:18:41 +0000
+++ bkm/bk3040.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3050.py'
--- bkm/bk3050.py	2016-02-27 13:18:41 +0000
+++ bkm/bk3050.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3060.py'
--- bkm/bk3060.py	2016-02-27 13:18:41 +0000
+++ bkm/bk3060.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'bkm/bk3070.py'
--- bkm/bk3070.py	2016-02-27 13:18:41 +0000
+++ bkm/bk3070.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3080.py'
--- bkm/bk3080.py	2016-09-03 14:07:52 +0000
+++ bkm/bk3080.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import PrintBookingInvoice, Sql, TartanDialog

=== modified file 'bkm/bk3090.py'
--- bkm/bk3090.py	2016-05-21 12:42:32 +0000
+++ bkm/bk3090.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CreateChart, TartanDialog, Sql

=== modified file 'bkm/bkc110.py'
--- bkm/bkc110.py	2016-02-27 13:18:41 +0000
+++ bkm/bkc110.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bkc210.py'
--- bkm/bkc210.py	2016-02-27 13:18:41 +0000
+++ bkm/bkc210.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'bkm/bkc310.py'
--- bkm/bkc310.py	2016-02-27 13:18:41 +0000
+++ bkm/bkc310.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'bkm/bkc410.py'
--- bkm/bkc410.py	2016-02-27 13:18:41 +0000
+++ bkm/bkc410.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'bkm/bkc510.py'
--- bkm/bkc510.py	2016-02-27 13:18:41 +0000
+++ bkm/bkc510.py	2017-01-28 08:53:08 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bks/bs1010.py'
--- bks/bs1010.py	2016-06-22 08:28:55 +0000
+++ bks/bs1010.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bks/bs3010.py'
--- bks/bs3010.py	2016-11-07 16:11:53 +0000
+++ bks/bs3010.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, requests, time, urllib2

=== modified file 'bks/bsc110.py'
--- bks/bsc110.py	2016-06-22 08:28:55 +0000
+++ bks/bsc110.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bks/bsc210.py'
--- bks/bsc210.py	2016-11-07 16:11:53 +0000
+++ bks/bsc210.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc1010.py'
--- bwl/bc1010.py	2016-09-03 14:07:52 +0000
+++ bwl/bc1010.py	2017-02-07 10:47:28 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -44,7 +44,7 @@
         else:
             self.memmst = True
         gc = GetCtl(self.opts["mf"])
-        bwlctl = gc.getCtl("bwlctl", 1)
+        bwlctl = gc.getCtl("bwlctl", self.opts["conum"])
         if not bwlctl:
             return
         self.mlint = bwlctl["ctb_mlint"]
@@ -104,7 +104,8 @@
             r2s = (("Skip","4"), ("Third","3"), ("Second","2"), ("Lead","1"))
         fld = [
             (("T",0,0,0),"I@btb_tab",0,"","",
-                "","Y",self.doTab,tab,None,("efld",)),
+                "","Y",self.doTab,tab,None,("efld",),None,
+                "Note: Tab numbers Must be Unique."),
             [("T",0,1,0),"I@btb_memno",0,"","",
                 "","N",self.doMember,mlm,self.doDelete,("efld",)],
             (("T",0,2,0),"I@btb_surname",0,"","",
@@ -286,6 +287,10 @@
                 tab = chk[self.sql.bwltab_col.index("btb_tab")]
                 self.doTab(frt, pag, 0, 1, 0, 0, tab)
                 return "ff3"
+            if self.mstart < self.fstart and self.tab >= self.fstart:
+                self.df.loadEntry(frt, pag, p+1, data="F")
+            elif self.fstart < self.mstart and self.tab < self.mstart:
+                self.df.loadEntry(frt, pag, p+1, data="F")
             return
         if not self.sname == self.snam or not w == self.fnam:
             but = [("Amendment", "A"), ("Re-Issue", "R"), ("Neither", "N")]
@@ -308,14 +313,14 @@
         if self.tab < self.nstart:
             if self.mstart < self.fstart:
                 if self.gender == "M" and self.tab >= self.fstart:
-                    return "ff1|Invalid Tab Number for Gender"
+                    return "ff5|Invalid Gender for Tab Number"
                 elif self.gender == "F" and self.tab < self.fstart:
-                    return "ff1|Invalid Tab Number for Gender"
+                    return "ff5|Invalid Gender for Tab Number"
             else:
-                if self.gender == "F" and self.tab >= self.fstart:
-                    return "ff1|Invalid Tab Number for Gender"
-                elif self.gender == "M" and self.tab < self.fstart:
-                    return "ff1|Invalid Tab Number for Gender"
+                if self.gender == "F" and self.tab >= self.mstart:
+                    return "ff5|Invalid Gender for Tab Number"
+                elif self.gender == "M" and self.tab < self.mstart:
+                    return "ff5|Invalid Gender for Tab Number"
 
     def doEmail(self, frt, pag, r, c, p, i, w):
         if self.dbase in ("C","P") and self.df.t_work[0][0][13] == "0":

=== modified file 'bwl/bc1020.py'
--- bwl/bc1020.py	2016-02-27 13:18:41 +0000
+++ bwl/bc1020.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os

=== modified file 'bwl/bc1030.py'
--- bwl/bc1030.py	2016-02-27 13:18:41 +0000
+++ bwl/bc1030.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc1040.py'
--- bwl/bc1040.py	2016-11-07 16:11:53 +0000
+++ bwl/bc1040.py	2017-02-21 09:30:42 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql
@@ -145,6 +145,8 @@
         self.cfmat = w
 
     def doTSize(self, frt, pag, r, c, p, i, w):
+        if self.cfmat == "D" and w not in (2, 3):
+            return "Invalid Team Size"
         self.tsize = w
         if self.cfmat in ("D", "K", "R"):
             self.df.loadEntry(frt, pag, p+1, data=0)

=== modified file 'bwl/bc2010.py'
--- bwl/bc2010.py	2016-12-30 14:10:51 +0000
+++ bwl/bc2010.py	2017-02-09 14:16:34 +0000
@@ -88,7 +88,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import random, time

=== modified file 'bwl/bc2020.py'
--- bwl/bc2020.py	2016-05-21 12:42:32 +0000
+++ bwl/bc2020.py	2017-02-05 10:29:56 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, MyFpdf, TartanDialog, Sql
@@ -27,7 +27,7 @@
 
     def setVariables(self):
         gc = GetCtl(self.opts["mf"])
-        bwlctl = gc.getCtl("bwlctl", 1)
+        bwlctl = gc.getCtl("bwlctl", self.opst["conum"])
         if not bwlctl:
             return
         self.nstart = bwlctl["ctb_nstart"]

=== modified file 'bwl/bc2030.py'
--- bwl/bc2030.py	2016-02-27 13:18:41 +0000
+++ bwl/bc2030.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc2040.py'
--- bwl/bc2040.py	2016-11-07 16:11:53 +0000
+++ bwl/bc2040.py	2017-01-31 08:52:40 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog
@@ -24,7 +24,7 @@
             self.opts["mf"].startLoop()
 
     def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwltab", "bwlclb",
+        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwltab",
             "bwlent", "bwltyp", "bwlgme"], prog=__name__)
         if self.sql.error:
             return

=== modified file 'bwl/bc2050.py'
--- bwl/bc2050.py	2016-11-07 16:11:53 +0000
+++ bwl/bc2050.py	2017-02-21 10:28:45 +0000
@@ -21,7 +21,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, random, time
@@ -40,14 +40,17 @@
             self.opts["mf"].startLoop()
 
     def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwlgme", "bwltab",
-            "bwltyp", "bwlpts", "bwlrnd", "bwlent", "tplmst"], prog=__name__)
+        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwlgme", "bwltms",
+            "bwltab", "bwltyp", "bwlpts", "bwlrnd", "bwlent", "tplmst"],
+            prog=__name__)
         if self.sql.error:
             return
         gc = GetCtl(self.opts["mf"])
-        bwlctl = gc.getCtl("bwlctl", 1)
+        bwlctl = gc.getCtl("bwlctl", self.opts["conum"])
         if not bwlctl:
             return
+        self.mstart = bwlctl["ctb_mstart"]
+        self.fstart = bwlctl["ctb_fstart"]
         self.nstart = bwlctl["ctb_nstart"]
         t = time.localtime()
         self.today = ((t[0] * 10000) + (t[1] * 100) + t[2])
@@ -122,9 +125,10 @@
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
-            eflds=fld, tend=tnd, txit=txt, view=("Y","V"), mail=("Y","Y"))
+            eflds=fld, tend=tnd, txit=txt, view=("X","V"), mail=("Y","Y"))
         self.df.setWidget(self.df.topEntry[0][12][2][0], state="hide")
-        self.df.setWidget(self.df.topEntry[0][12][3][0], state="hide")
+        if len(self.df.topEntry[0][12]) == 4:
+            self.df.setWidget(self.df.topEntry[0][12][3][0], state="hide")
 
     def doCmpCod(self, frt, pag, r, c, p, i, w):
         bwlcmp = self.sql.getRec(tables="bwlcmp", where=[("bcm_cono",
@@ -157,6 +161,8 @@
                 "There is an Uneven Number of Teams (%s)" % self.totskp)
             return "rf"
         if self.cfmat in ("D", "K"):
+            if len(self.df.topEntry[0][12]) == 4:
+                self.df.setWidget(self.df.topEntry[0][12][3][0], state="show")
             if self.totskp > 64:
                 showError(self.opts["mf"].body, "Maximum Exceeded",
                     "There are Too Many Entries (%s)" % self.totskp)
@@ -168,11 +174,13 @@
             else:
                 self.games = 1
         elif self.cfmat == "R":
-            self.df.setWidget(self.df.topEntry[0][12][4][0], state="hide")
+            if len(self.df.topEntry[0][12]) == 4:
+                self.df.setWidget(self.df.topEntry[0][12][3][0], state="hide")
             self.games = self.totskp - 1
             self.drawn = self.games
         else:
-            self.df.setWidget(self.df.topEntry[0][12][4][0], state="hide")
+            if len(self.df.topEntry[0][12]) == 4:
+                self.df.setWidget(self.df.topEntry[0][12][3][0], state="hide")
             self.games = bwltyp[self.sql.bwltyp_col.index("bct_games")]
         self.ends = bwltyp[self.sql.bwltyp_col.index("bct_ends")]
         self.groups = bwltyp[self.sql.bwltyp_col.index("bct_groups")]
@@ -369,7 +377,7 @@
         self.date = w
         self.datd = self.df.t_disp[pag][0][i]
         self.grpsel = False
-        if self.cfmat == "R":
+        if self.cfmat in ("R", "X"):
             self.hapair = "N"
             self.df.loadEntry(frt, pag, p+1, data="N")
             return "sk3"
@@ -378,7 +386,7 @@
                 self.grpsel = True
             self.hapair = "N"
             self.df.loadEntry(frt, pag, p+1, data="N")
-            if not self.cfmat == "R" or self.grpsel:
+            if self.grpsel:
                 return "sk1"
             else:
                 return "sk3"
@@ -521,7 +529,7 @@
         if self.gtyp == "D":
             # Drawn Games
             if self.cfmat == "X":
-                # Match
+                # Teams
                 teams = {"H": {}, "V": {}}
                 ents = self.sql.getRec(tables="bwlent", where=[("bce_cono",
                     "=", self.opts["conum"]), ("bce_ccod", "=", self.ccod)])
@@ -882,6 +890,22 @@
                 return "%s, %s (%s)" % (rec[0], rec[1].split()[0][0], mem[1])
             else:
                 return rec[0]
+        if self.reprint:
+            self.teams = {}
+            recs = self.sql.getRec(tables="bwltms", where=[("btd_cono",
+                "=", self.opts["conum"]), ("btd_ccod", "=", self.ccod)],
+                order="btd_scod")
+            for rec in recs:
+                self.teams[rec[2]] = []
+                for mem in rec[2:]:
+                    if not mem:
+                        continue
+                    tab = self.sql.getRec(tables="bwltab", cols=["btb_gender",
+                        "btb_pos1", "btb_rate1"], where=[("btb_cono", "=",
+                        self.opts["conum"]), ("btb_tab", "=", mem)], limit=1)
+                    self.teams[rec[2]].append([mem] + tab)
+        if not self.teams:
+            return
         head = [(self.opts["conam"], 14), ("Teams for %s" % self.cdes, 12)]
         cols = [
             ["a", "NA", 25, "Skip", "y"]]
@@ -891,9 +915,17 @@
         data = []
         for skip in self.teams:
             dat = []
+            if not self.reprint:
+                sql = [self.opts["conum"], self.ccod]
             for mem in self.teams[skip]:
                 dat.append(getNames(mem))
+                if not self.reprint:
+                    sql.append(mem[0])
             data.append(dat)
+            if not self.reprint:
+                if len(sql) == 4:
+                    sql.append(0)
+                self.sql.insRec("bwltms", data=sql)
         RepPrt(self.opts["mf"], name=__name__, tables=data, heads=head,
             cols=cols, ttype="D", repprt=self.df.repprt, repeml=self.df.repeml)
 
@@ -1110,44 +1142,88 @@
 
     def doCompletionDates(self):
         tit = ("Completion Dates",)
-        fld = []
+        r1s = (("Variable", "V"), ("Fixed", "F"))
+        fld = [
+            [("T",0,0,0),("IRB",r1s),0,"Starting Times","",
+                "V","N",self.doComTyp,None,None,None]]
         for x in xrange(self.rnds):
-            fld.append((("T",0,x,0),"ID1",10,"Round %s Date" % (x + 1),"",
+            if x + 1 == self.rnds:
+                dt = "Id1"
+                tm = "ItM"
+            else:
+                dt = "ID1"
+                tm = "ITM"
+            fld.append((("T",0,x+1,0),dt,10,"Round %s Date" % (x + 1),"",
                 0,"N",self.doComDate,None,None,("efld",)))
+            fld.append((("T",0,x+1,0),tm,5,"Time","",
+                0,"N",None,None,None,("efld",)))
         but = (("Quit",None,self.doCompletionQuit,1,None,None),)
         self.df.setWidget(self.df.mstFrame, state="hide")
         self.cd = TartanDialog(self.opts["mf"], title=tit, tops=True,
             eflds=fld, butt=but, tend=((self.doCompletionEnd,"y"),),
             focus=False)
-        dates = self.sql.getRec(tables="bwlrnd", cols=["bcr_date"],
+        dates = self.sql.getRec(tables="bwlrnd", cols=["bcr_date", "bcr_time"],
             where=[("bcr_cono", "=", self.opts["conum"]), ("bcr_ccod", "=",
-            self.ccod)], order="bcr_date")
+            self.ccod)], order="bcr_date, bcr_time")
         if dates:
             self.newdte = False
+            if dates[0][1]:
+                self.comtyp = "F"
+            else:
+                self.comtyp = "V"
+            self.cd.topf[0][0][5] = self.comtyp
+            self.cd.loadEntry("T", 0, 0, data=self.comtyp)
             for num, dte in enumerate(dates):
-                self.cd.loadEntry("T", 0, num, data=dte[0])
+                p = (num * 2) + 1
+                if dte[0] == 99991231:
+                    dt = 0
+                    tm = 0
+                else:
+                    dt, tm = dte
+                self.cd.loadEntry("T", 0, p, data=dt)
+                self.cd.loadEntry("T", 0, p+1, data=tm)
         else:
             self.newdte = True
         self.cd.focusField("T", 0, 1, clr=False)
         self.opts["mf"].startLoop()
         self.df.setWidget(self.df.mstFrame, state="show")
 
+    def doComTyp(self, frt, pag, r, c, p, i, w):
+        self.comtyp = w
+
     def doComDate(self, frt, pag, r, c, p, i, w):
-        if w < self.today:
-            return "Date in the Past"
-        if i and w < self.cd.t_work[0][0][i-1]:
+        if not w and self.comtyp == "F" and p == ((self.rnds * 2) - 1):
+            pass
+        elif w < self.today:
+            if self.reprint:
+                return "nd"
+            else:
+                return "Date in the Past"
+        elif i > 1 and w < self.cd.t_work[0][0][i - 2]:
             return "Date Before Previous Date"
+        if not w or self.comtyp == "V":
+            self.cd.loadEntry(frt, pag, p+1, data=0)
+            return "sk1"
 
     def doCompletionEnd(self, widget=None):
         self.cd.closeProcess()
         self.cdates = []
+        self.ctimes = []
         if not self.newdte:
             self.sql.delRec("bwlrnd", where=[("bcr_cono", "=",
                 self.opts["conum"]), ("bcr_ccod", "=", self.ccod)])
-        for rnd, dte in enumerate(self.cd.t_work[0][0]):
+        dat = copyList(self.cd.t_work[0][0][1:])
+        for rnd in range(0, len(dat), 2):
+            if not dat[rnd]:
+                dte = 99991231
+                tim = 0
+            else:
+                dte = dat[rnd]
+                tim = dat[rnd + 1]
             self.cdates.append(CCD(dte, "D1", 10).disp)
-            self.sql.insRec("bwlrnd", data=[self.opts["conum"], self.ccod,
-                rnd+1, dte])
+            self.ctimes.append(CCD(tim, "TM", 5).disp)
+            self.sql.insRec("bwlrnd", data=[self.opts["conum"],
+                self.ccod, rnd+1, dte, tim])
         if self.reprint:
             self.opts["mf"].dbm.commitDbase()
         self.opts["mf"].closeLoop()
@@ -1599,7 +1675,16 @@
         self.fpdf.drawText()
         text = []
         for x in xrange(self.rnds):
-            text.append("Complete By\n%s" % self.cdates[x])
+            if self.comtyp == "V":
+                text.append("Complete By\n%s" % self.cdates[x])
+            elif self.cdates[x] == "9999-12-31":
+                text.append("To Be\nAnnounced")
+            else:
+                if self.ctimes[x] <= "12:00":
+                    txt = "%s AM" % self.ctimes[x]
+                else:
+                    txt = "%s PM" % self.ctimes[x]
+                text.append("%s\n%s" % (self.cdates[x], txt))
         text.append("Competition\nWinner")
         x = self.fpdf.get_x()
         y = self.fpdf.get_y()

=== modified file 'bwl/bc2060.py'
--- bwl/bc2060.py	2016-11-07 16:11:53 +0000
+++ bwl/bc2060.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -162,6 +162,10 @@
                 for x in xrange(1, 7):
                     self.rinks.append("%s%s" % (g[0], x))
                 rinks += 6
+            elif len(g) == 2 and g[1] == "7":
+                for x in range(1, 8):
+                    self.rinks.append("%s%s" % (g[0], x))
+                rinks += 7
             else:
                 for r in g[1:]:
                     self.rinks.append("%s%s" % (g[0], r))

=== modified file 'bwl/bc2070.py'
--- bwl/bc2070.py	2016-11-07 16:11:53 +0000
+++ bwl/bc2070.py	2017-02-18 08:48:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, TartanDialog, Sql
@@ -211,6 +211,10 @@
         self.totpts = (w * self.epts) + self.gpts
         if self.skins == "Y":
             self.totpts = self.totpts + ((w / self.sends) * self.spts)
+        if self.bonus == "Y":
+            self.maxpts = float(ASD(self.totpts) + ASD(1))
+        else:
+            self.maxpts = self.totpts
 
     def doSkpCod(self, frt, pag, r, c, p, i, w):
         chk = self.sql.getRec(tables=["bwlgme", "bwltab"], cols=["btb_surname",
@@ -290,6 +294,8 @@
     def doPoints(self, frt, pag, r, c, p, i, w):
         if w and w % 1 not in (0.0, 0.5):
             return "Invalid Decimal in Points"
+        if w > self.maxpts:
+            return "Invalid Points, Exceed Maximum"
         if i == 3:
             self.p_for = w
             self.df.loadEntry(frt, pag, p + 1, data=self.opp)

=== modified file 'bwl/bc3010.py'
--- bwl/bc3010.py	2016-06-22 08:28:55 +0000
+++ bwl/bc3010.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'bwl/bc3020.py'
--- bwl/bc3020.py	2016-09-03 14:07:52 +0000
+++ bwl/bc3020.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'bwl/bc3030.py'
--- bwl/bc3030.py	2016-02-27 13:18:41 +0000
+++ bwl/bc3030.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import MyFpdf, Sql, TartanDialog

=== modified file 'bwl/bc3040.py'
--- bwl/bc3040.py	2016-05-21 12:42:32 +0000
+++ bwl/bc3040.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os

=== modified file 'bwl/bc3050.py'
--- bwl/bc3050.py	2016-02-27 13:18:41 +0000
+++ bwl/bc3050.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, RepPrt, Sql

=== modified file 'bwl/bc3060.py'
--- bwl/bc3060.py	2016-02-27 13:18:41 +0000
+++ bwl/bc3060.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, RepPrt, Sql

=== modified file 'bwl/bc3070.py'
--- bwl/bc3070.py	2016-05-21 12:42:32 +0000
+++ bwl/bc3070.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time
@@ -43,10 +43,13 @@
                 ("bcm_name", "", 0, "Name", "Y"),
                 ("bcm_date", "", 0, "Date")),
             "where": [("bcm_cono", "=", self.opts["conum"])]}
+        r1s = (("Alphabtic", "A"), ("Numeric", "N"))
         fld = (
             (("T",0,0,0),"I@bcm_code",0,"","",
                 "","N",self.doCmpCod,com,None,("notzero",)),
-            (("T",0,0,0),"ONA",30,""))
+            (("T",0,0,0),"ONA",30,""),
+            (("T",0,1,0),("IRB",r1s),0,"Order","",
+                "A","N",self.doCmpOrd,None,None,None))
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
@@ -62,6 +65,9 @@
         self.cnam = chk[0]
         self.df.loadEntry(frt, pag, p+1, data=self.cnam)
 
+    def doCmpOrd(self, frt, pag, r, c, p, i, w):
+        self.cord = w
+
     def doEnd(self):
         self.df.closeProcess()
         col = ["btb_tab", "btb_surname", "btb_names", "btb_cell",
@@ -71,8 +77,12 @@
             ("bce_ccod", "=", self.ccod),
             ("btb_cono=bce_cono",),
             ("btb_tab=bce_scod",)]
+        if self.cord == "A":
+            odr = "btb_surname"
+        else:
+            odr = "btb_tab"
         recs = self.sql.getRec(tables=["bwlent", "bwltab"], cols=col,
-            where=whr, order="btb_surname")
+            where=whr, order=odr)
         if recs:
             self.fpdf = MyFpdf(auto=True, foot=True)
             self.fpdf.header = self.doHead

=== modified file 'bwl/bc3080.py'
--- bwl/bc3080.py	2016-11-07 16:11:53 +0000
+++ bwl/bc3080.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time
@@ -65,7 +65,7 @@
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
-            eflds=fld, tend=tnd, txit=txt, view=("N","V"))
+            eflds=fld, tend=tnd, txit=txt, view=("N","V"), mail=("Y","N"))
 
     def doCmpCod(self, frt, pag, r, c, p, i, w):
         chk = self.sql.getRec(tables="bwlcmp", cols=["bcm_name", "bcm_type"],

=== modified file 'bwl/bc3090.py'
--- bwl/bc3090.py	2016-11-07 16:11:53 +0000
+++ bwl/bc3090.py	2017-01-28 08:53:09 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, TartanDialog, Sql

=== removed file 'bwl/bc3100.py'
--- bwl/bc3100.py	2016-05-21 12:42:32 +0000
+++ bwl/bc3100.py	1970-01-01 00:00:00 +0000
@@ -1,297 +0,0 @@
-#! /usr/bin/python
-
-"""
-SYNOPSIS
-    Bowls Competition Game Results.
-
-    This file is part of Tartan Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
-"""
-
-from TartanClasses import ASD, CCD, MyFpdf, TartanDialog, Sql
-from tartanFunctions import doPrinter, copyList, getModName
-
-class bc3100:
-    def __init__(self, **opts):
-        self.opts = opts
-        if self.setVariables():
-            self.mainProcess()
-            self.opts["mf"].startLoop()
-
-    def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwlgme", "bwltab",
-            "bwltyp", "bwlpts", "bwlent"], prog=__name__)
-        if self.sql.error:
-            return
-        self.groups = ["None", "A", "B", "C", "D", "E"]
-        return True
-
-    def mainProcess(self):
-        tit = ("%03i %s" % (self.opts["conum"], self.opts["conam"]),
-            "Game Results (%s)" % __name__)
-        com = {
-            "stype": "R",
-            "tables": ("bwlcmp",),
-            "cols": (
-                ("bcm_code", "", 0, "Cod"),
-                ("bcm_name", "", 0, "Name", "Y")),
-            "where": [("bcm_cono", "=", self.opts["conum"])]}
-        gme = {
-            "stype": "R",
-            "tables": ("bwlgme",),
-            "cols": (("bcg_game", "", 0, "GC"),),
-            "where": [("bcg_cono", "=", self.opts["conum"])],
-            "whera": [("T", "bcg_ccod", 0, 0)],
-            "group": "bcg_game"}
-        fld = (
-            (("T",0,0,0),"I@bcm_code",0,"","",
-                0,"N",self.doCmpCod,com,None,None),
-            (("T",0,0,0),"ONA",30,""),
-            (("T",0,1,0),"I@bcg_game",0,"","",
-                0,"N",self.doGame,gme,None,("efld",)))
-        tnd = ((self.doEnd,"y"),)
-        txt = (self.doExit,)
-        self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
-            eflds=fld, tend=tnd, txit=txt, view=("N","V"))
-
-    def doCmpCod(self, frt, pag, r, c, p, i, w):
-        chk = self.sql.getRec(tables="bwlcmp", where=[("bcm_cono", "=",
-            self.opts["conum"]), ("bcm_code", "=", w)], limit=1)
-        if not chk:
-            return "Invalid Competition Code"
-        self.ccod = w
-        self.cdes = chk[self.sql.bwlcmp_col.index("bcm_name")]
-        self.ctyp = chk[self.sql.bwlcmp_col.index("bcm_type")]
-        chk = self.sql.getRec(tables="bwltyp", where=[("bct_cono", "=",
-            self.opts["conum"]), ("bct_code", "=", self.ctyp)], limit=1)
-        self.cfmat = chk[self.sql.bwltyp_col.index("bct_cfmat")]
-        self.grgame = chk[self.sql.bwltyp_col.index("bct_grgame")]
-        game = self.sql.getRec(tables="bwlgme", cols=["bcg_game", "bcg_aflag",
-            "sum(bcg_points)"], where=[("bcg_cono", "=", self.opts["conum"]),
-            ("bcg_ccod", "=", self.ccod)], group="bcg_game, bcg_aflag",
-            order="bcg_game")
-        self.game = 0
-        for g in game:
-            if not g[1] and not g[2]:
-                break
-            if not g[1] == "A":
-                self.game = g[0]
-        if not self.game:
-            return "Knockout or No Completed Games to Print"
-        self.df.loadEntry(frt, pag, p+1, data=self.cdes)
-        self.df.loadEntry(frt, pag, p+2, data=self.game)
-
-    def doGame(self, frt, pag, r, c, p, i, w):
-        if not w:
-            chk = self.sql.getRec(tables="bwlgme", cols=["bcg_game",
-                "sum(bcg_points)"], where=[("bcg_cono", "=",
-                self.opts["conum"]), ("bcg_ccod", "=", self.ccod)],
-                group="bcg_game", order="bcg_game")
-            self.game = 0
-            for g in chk:
-                if g[1]:
-                    self.game = g[0]
-                else:
-                    break
-            if not self.game:
-                return "No Completed Games"
-            self.df.loadEntry(frt, pag, p, data=self.game)
-        else:
-            self.game = w
-        chk = self.sql.getRec(tables="bwlgme", cols=["count(*)"],
-            where=[("bcg_cono", "=", self.opts["conum"]), ("bcg_ccod",
-            "=", self.ccod), ("bcg_game", "=", self.game), ("bcg_aflag",
-            "=", "A")], group="bcg_aflag", limit=1)
-        if chk and chk[0]:
-            return "Game Abandoned"
-        chk = self.sql.getRec(tables="bwlgme", where=[("bcg_cono", "=",
-            self.opts["conum"]), ("bcg_ccod", "=", self.ccod), ("bcg_game",
-            "=", self.game), ("bcg_aflag", "in", ("", "D"))])
-        if not chk:
-            return "Invalid Game Number"
-        ptyp = chk[0][self.sql.bwlgme_col.index("bcg_type")]
-        pts = self.sql.getRec(tables="bwlpts", where=[("bcp_cono",
-            "=", self.opts["conum"]), ("bcp_code", "=", self.ctyp),
-            ("bcp_ptyp", "=", ptyp)], limit=1)
-        ponly = pts[self.sql.bwlpts_col.index("bcp_p_only")]
-        non = []
-        for c in chk:
-            scod = c[self.sql.bwlgme_col.index("bcg_scod")]
-            ocod = c[self.sql.bwlgme_col.index("bcg_ocod")]
-            if scod > 900000 or ocod > 900000:
-                continue
-            if ponly == "Y":
-                fors = c[self.sql.bwlgme_col.index("bcg_points")]
-                agts = self.sql.getRec(tables="bwlgme",
-                    cols=["bcg_points"], where=[("bcg_cono", "=",
-                    self.opts["conum"]), ("bcg_ccod", "=", self.ccod),
-                    ("bcg_game", "=", self.game), ("bcg_scod",
-                    "=", ocod)], limit=1)[0]
-            else:
-                fors = c[self.sql.bwlgme_col.index("bcg_shots_for")]
-                agts = c[self.sql.bwlgme_col.index("bcg_shots_agt")]
-            if not fors and not agts:
-                if not scod in non:
-                    non.append(scod)
-        if non:
-            return "%s Result(s) Not Yet Entered" % (len(non) / 2)
-
-    def doEnd(self):
-        self.df.closeProcess()
-        chk = self.sql.getRec(tables="bwlgme", cols=["bcg_group", "bcg_scod"],
-            where=[("bcg_cono", "=", self.opts["conum"]), ("bcg_ccod", "=",
-            self.ccod), ("bcg_game", "=", self.game)], order="bcg_group")
-        grps = {}
-        for rec in chk:
-            if self.game <= self.grgame:
-                rec[0] = 0
-            if rec[0] not in grps:
-                grps[rec[0]] = [rec[1]]
-            else:
-                grps[rec[0]].append(rec[1])
-        keys = grps.keys()
-        keys.sort()
-        where = [
-            ("bcg_cono", "=", self.opts["conum"]),
-            ("bcg_ccod", "=", self.ccod),
-            ("bcg_game", "=", self.game),
-            ("btb_tab=bcg_scod",)]
-        self.fpdf = MyFpdf(name=__name__, head=65, foot=True)
-        self.pglin = 999
-        lastg = None
-        for g in keys:
-            whr = copyList(where)
-            whr.append(("bcg_scod", "in", grps[g]))
-            col = ["bcg_scod", "btb_surname", "btb_names"]
-            col.extend(["sum(bcg_shots_for) as sfor",
-                "sum(bcg_shots_agt) as sagt",
-                "sum(bcg_shots_for - bcg_shots_agt) as agg",
-                "sum(bcg_points) as pts"])
-            recs = self.sql.getRec(tables=["bwlgme", "bwltab"], cols=col,
-                where=whr, group="btb_tab, btb_surname, btb_names",
-                order="pts desc, agg desc, sagt asc")
-            if not recs:
-                continue
-            if self.cfmat == "X":
-                tms = {"H": [0, 0, 0, 0], "V": [0, 0, 0, 0]}
-            for num, (scod,snam,fnam,sfor,sagt,agg,pts) in enumerate(recs):
-                if self.pglin > self.fpdf.lpp:
-                    self.pageHeading()
-                if not g == lastg:
-                    if len(recs) > (self.fpdf.lpp - self.pglin - 4):
-                        self.pageHeading()
-                    self.groupHeading(g)
-                    lastg = g
-                if fnam:
-                    nam = "%s, %s" % (snam.upper(), fnam.split()[0].upper())
-                else:
-                    nam = snam.upper()
-                a = CCD(num+1, "UI", 3)
-                b = CCD(nam, "NA", 30)
-                c = CCD(sfor, "SD", 7.1)
-                d = CCD(sagt, "SD", 7.1)
-                e = CCD(agg, "SD", 7.1)
-                f = CCD(pts, "SD", 7.1)
-                self.printLine(a.disp, b.disp, c.disp, d.disp, e.disp, f.disp)
-                if self.cfmat == "X":
-                    tm = self.sql.getRec(tables="bwlent", cols=["bce_tcod"],
-                        where=[("bce_cono", "=", self.opts["conum"]),
-                        ("bce_ccod", "=", self.ccod), ("bce_scod", "=", scod)],
-                        limit=1)
-                    tms[tm[0]][0] = float(ASD(tms[tm[0]][0]) + ASD(c.work))
-                    tms[tm[0]][1] = float(ASD(tms[tm[0]][1]) + ASD(d.work))
-                    tms[tm[0]][2] = float(ASD(tms[tm[0]][2]) + ASD(e.work))
-                    tms[tm[0]][3] = float(ASD(tms[tm[0]][3]) + ASD(f.work))
-                self.pglin += 1
-        if self.cfmat == "X":
-            cwth = self.fpdf.cwth
-            self.fpdf.drawText()
-            self.fpdf.drawText("Game Summary", font=["courier", "B", 18])
-            self.fpdf.setFont(style="B")
-            self.fpdf.drawText()
-            self.fpdf.drawText("Home", w=cwth * 32, h=8, border="TLRB",
-                align="C", fill=1, ln=0)
-            self.fpdf.drawText("Visitors", w=cwth * 32, h=8, border="TLRB",
-                align="C", fill=1, ln=1)
-            x = self.fpdf.get_x()
-            y = self.fpdf.get_y()
-            for tm in ("H", "V"):
-                self.fpdf.drawText(" +For", x=x, y=y, w=cwth * 8, h=8,
-                    font="B", border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][0], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    font=[""], border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText(" -Agt", x=x, y=y, w=cwth * 8, h=8,
-                    font="B", border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][1], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    font=[""], border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText(" =Dif", x=x, y=y, w=cwth * 8, h=8,
-                    font="B", border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][2], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    font=[""], border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText("  Pts", x=x, y=y, w=cwth * 8, h=8,
-                    font="B", border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][3], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    font=[""], border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-        pdfnam = getModName(self.opts["mf"].rcdic["wrkdir"], __name__,
-            "report", ext="pdf")
-        self.fpdf.output(pdfnam, "F")
-        doPrinter(mf=self.opts["mf"], conum=1, pdfnam=pdfnam,
-            repprt=self.df.repprt)
-        self.opts["mf"].closeLoop()
-
-    def pageHeading(self):
-        self.fpdf.add_page()
-        self.fpdf.drawText(self.cdes, font=["courier", "B", 24])
-        self.pglin = 1
-
-    def groupHeading(self, group):
-        self.fpdf.drawText(font=["courier", "B", 18])
-        head = "Results for Game Number: %s" % self.game
-        if group:
-            head += "  for Group: %s" % self.groups[group]
-        self.fpdf.drawText(head, font=["courier", "B", 18])
-        self.fpdf.drawText()
-        self.fpdf.setFont(style="B")
-        self.printLine("Pos", "%-30s" % "Name", "  +For ", "  -Agt ",
-            "  =Dif ", "   Pts ", fill=1)
-        self.fpdf.setFont()
-        self.pglin += 4
-
-    def printLine(self, a, b, c, d, e, f, fill=0):
-        x = 10
-        w = self.fpdf.get_string_width("X"*len(a)) + 1
-        self.fpdf.drawText(a, x=x, w=w, border="TLB", fill=fill, ln=0)
-        x += w
-        w = self.fpdf.get_string_width("X"*len(b)) + 1
-        self.fpdf.drawText(b, x=x, w=w, border="TLB", fill=fill, ln=0)
-        x += w
-        w = self.fpdf.get_string_width("X"*len(c)) + 1
-        self.fpdf.drawText(c, x=x, w=w, border="TLB", fill=fill, ln=0)
-        x += w
-        w = self.fpdf.get_string_width("X"*len(d)) + 1
-        self.fpdf.drawText(d, x=x, w=w, border="TLB", fill=fill, ln=0)
-        x += w
-        w = self.fpdf.get_string_width("X"*len(e)) + 1
-        self.fpdf.drawText(e, x=x, w=w, border="TLB", fill=fill, ln=0)
-        x += w
-        w = self.fpdf.get_string_width("X"*len(f)) + 1
-        self.fpdf.drawText(f, x=x, w=w, border="TLRB", fill=fill)
-
-    def doExit(self):
-        self.df.closeProcess()
-        self.opts["mf"].closeLoop()
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== renamed file 'bwl/bc3110.py' => 'bwl/bc3100.py'
--- bwl/bc3110.py	2016-11-07 16:11:53 +0000
+++ bwl/bc3100.py	2017-01-28 08:53:09 +0000
@@ -10,14 +10,14 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os
 from TartanClasses import ASD, CCD, MyFpdf, TartanDialog, Sql
 from tartanFunctions import askQuestion, copyList, doPrinter, getModName
 
-class bc3110:
+class bc3100:
     def __init__(self, **opts):
         self.opts = opts
         if self.setVariables():
@@ -56,14 +56,16 @@
             (("T",0,0,0),"ONA",30,""),
             (("T",0,1,0),"IUI",2,"Last Game","",
                 0,"N",self.doLstGam,gme,None,("efld",)),
-            (("T",0,2,0),("IRB",r1s),0,"Session Prizes","",
+            (("T",0,2,0),("IRB",r1s),0,"Game Report","",
+                "N","N",self.doGamRep,None,None,None),
+            (("T",0,3,0),("IRB",r1s),0,"Session Prizes","",
                 "N","N",self.doSesPrz,None,None,None),
-            (("T",0,3,0),("IRB",r1s),0,"Session Prizes by Group","",
+            (("T",0,4,0),("IRB",r1s),0,"Session Prizes by Group","",
                 "N","N",self.doSesGrp,None,None,None))
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
-            eflds=fld, tend=tnd, txit=txt, view=("N","V"))
+            eflds=fld, tend=tnd, txit=txt, view=("N","V"), mail=("B","N"))
 
     def doCmpCod(self, frt, pag, r, c, p, i, w):
         chk = self.sql.getRec(tables="bwlcmp", where=[("bcm_cono", "=",
@@ -89,15 +91,15 @@
             "sum(bcg_points)"], where=[("bcg_cono", "=", self.opts["conum"]),
             ("bcg_ccod", "=", self.ccod)], group="bcg_game, bcg_aflag",
             order="bcg_game")
-        self.game = 0
+        self.lgame = 0
         for g in game:
             if not g[1] and not g[2]:
                 break
-            self.game = g[0]
-        if not self.game:
+            self.lgame = g[0]
+        if not self.lgame:
             return "Knockout or No Completed Games to Print"
         self.df.loadEntry(frt, pag, p+1, data=self.cdes)
-        self.df.loadEntry(frt, pag, p+2, data=self.game)
+        self.df.loadEntry(frt, pag, p+2, data=self.lgame)
 
     def doLstGam(self, frt, pag, r, c, p, i, w):
         if not w:
@@ -105,26 +107,26 @@
                 "sum(bcg_points)"], where=[("bcg_cono", "=",
                 self.opts["conum"]), ("bcg_ccod", "=", self.ccod)],
                 group="bcg_game", order="bcg_game")
-            self.game = 0
+            game = 0
             for g in chk:
                 if g[1]:
-                    self.game = g[0]
+                    game = g[0]
                 else:
                     break
-            if not self.game:
+            if not game:
                 return "No Completed Games"
-            self.df.loadEntry(frt, pag, p, data=self.game)
+            self.df.loadEntry(frt, pag, p, data=game)
         else:
-            self.game = w
+            game = w
         chk = self.sql.getRec(tables="bwlgme", cols=["count(*)"],
             where=[("bcg_cono", "=", self.opts["conum"]), ("bcg_ccod",
-            "=", self.ccod), ("bcg_game", "=", self.game), ("bcg_aflag",
+            "=", self.ccod), ("bcg_game", "=", game), ("bcg_aflag",
             "=", "A")], group="bcg_aflag", limit=1)
         if chk and chk[0]:
             return "Game Abandoned"
         chk = self.sql.getRec(tables="bwlgme", where=[("bcg_cono", "=",
             self.opts["conum"]), ("bcg_ccod", "=", self.ccod), ("bcg_game",
-            "=", self.game), ("bcg_aflag", "in", ("", "D"))])
+            "=", game), ("bcg_aflag", "in", ("", "D"))])
         if not chk:
             return "Invalid Game Number"
         ptyp = chk[0][self.sql.bwlgme_col.index("bcg_type")]
@@ -143,7 +145,7 @@
                 agts = self.sql.getRec(tables="bwlgme",
                     cols=["bcg_points"], where=[("bcg_cono", "=",
                     self.opts["conum"]), ("bcg_ccod", "=", self.ccod),
-                    ("bcg_game", "=", self.game), ("bcg_scod",
+                    ("bcg_game", "=", game), ("bcg_scod",
                     "=", ocod)], limit=1)[0]
             else:
                 fors = c[self.sql.bwlgme_col.index("bcg_shots_for")]
@@ -153,8 +155,25 @@
                     non.append(scod)
         if non:
             return "%s Result(s) Not Yet Entered" % (len(non) / 2)
-        self.lgame = w
-        if self.lgame < self.games:
+        self.pgame = w
+        if self.pgame == 1:
+            self.gamrep = "N"
+            self.df.loadEntry(frt, pag, p+1, data=self.gamrep)
+            if self.pgame < self.games:
+                self.sesp = "N"
+                self.sesg = "N"
+                self.df.loadEntry(frt, pag, p+1, data=self.sesp)
+                self.df.loadEntry(frt, pag, p+2, data=self.sesg)
+                return "sk3"
+            return "sk1"
+        if self.pgame < self.lgame:
+            self.df.topf[0][3][5] = "N"
+        else:
+            self.df.topf[0][3][5] = "Y"
+
+    def doGamRep(self, frt, pag, r, c, p, i, w):
+        self.gamrep = w
+        if self.pgame < self.games:
             self.sesp = "N"
             self.sesg = "N"
             self.df.loadEntry(frt, pag, p+1, data=self.sesp)
@@ -175,10 +194,10 @@
         self.df.closeProcess()
         chk = self.sql.getRec(tables="bwlgme", cols=["bcg_group", "bcg_scod"],
             where=[("bcg_cono", "=", self.opts["conum"]), ("bcg_ccod", "=",
-            self.ccod), ("bcg_game", "=", self.lgame)], order="bcg_group")
+            self.ccod), ("bcg_game", "=", self.pgame)], order="bcg_group")
         self.grps = {}
         for rec in chk:
-            if self.lgame <= self.grgame:
+            if self.pgame <= self.grgame:
                 rec[0] = 0
             if rec[0] not in self.grps:
                 self.grps[rec[0]] = [[rec[1]], [], []]
@@ -186,104 +205,16 @@
                 self.grps[rec[0]][0].append(rec[1])
         self.keys = self.grps.keys()
         self.keys.sort()
-        where = [
-            ("bcg_cono", "=", self.opts["conum"]),
-            ("bcg_ccod", "=", self.ccod),
-            ("bcg_game", "<=", self.lgame),
-            ("btb_tab=bcg_scod",)]
         self.fpdf = MyFpdf(name=__name__, head=65, foot=True)
-        self.pglin = 999
-        lastg = None
+        self.lastg = None
         for g in self.keys:
-            whr = copyList(where)
-            whr.append(("bcg_scod", "in", self.grps[g][0]))
-            col = ["bcg_scod", "btb_surname", "btb_names"]
-            if self.lgame <= self.grgame:
-                col.extend([
-                    "sum(bcg_shots_for) as sfor",
-                    "sum(bcg_shots_agt) as sagt",
-                    "sum(bcg_shots_for - bcg_shots_agt) as agg",
-                    "sum(bcg_points) as pts"])
-            else:
-                col.extend([
-                    "sum(bcg_a_shots_for) as sfor",
-                    "sum(bcg_a_shots_agt) as sagt",
-                    "sum(bcg_a_shots_for - bcg_a_shots_agt) as agg",
-                    "sum(bcg_a_points) as pts"])
-            recs = self.sql.getRec(tables=["bwlgme", "bwltab"], cols=col,
-                where=whr, group="btb_tab, btb_surname, btb_names",
-                order="pts desc, agg desc, sagt asc")
-            if not recs:
-                continue
-            if self.cfmat == "X":
-                tms = {"H": [0, 0, 0, 0], "V": [0, 0, 0, 0]}
-            for num, (scod,snam,fnam,sfor,sagt,agg,pts) in enumerate(recs):
-                if self.pglin > self.fpdf.lpp:
+            self.pageHeading()
+            if self.gamrep == "Y":
+                self.doReport("G", g)
+                if g == 0 and len(chk) > 20:
                     self.pageHeading()
-                if not g == lastg:
-                    if len(recs) > (self.fpdf.lpp - self.pglin - 4):
-                        self.pageHeading()
-                    self.groupHeading(g)
-                    lastg = g
-                if fnam:
-                    nam = "%s, %s" % (snam.upper(), fnam.split()[0].upper())
-                else:
-                    nam = snam.upper()
-                a = CCD(num+1, "UI", 3)
-                b = CCD(nam, "NA", 30)
-                c = CCD(sfor, "SD", 7.1)
-                d = CCD(sagt, "SD", 7.1)
-                e = CCD(agg, "SD", 7.1)
-                f = CCD(pts, "SD", 7.1)
-                self.printLine(a.disp, b.disp, c.disp, d.disp, e.disp, f.disp)
-                if self.cfmat == "X":
-                    tm = self.sql.getRec(tables="bwlent", cols=["bce_tcod"],
-                        where=[("bce_cono", "=", self.opts["conum"]),
-                        ("bce_ccod", "=", self.ccod), ("bce_scod", "=", scod)],
-                        limit=1)
-                    tms[tm[0]][0] = float(ASD(tms[tm[0]][0]) + ASD(c.work))
-                    tms[tm[0]][1] = float(ASD(tms[tm[0]][1]) + ASD(d.work))
-                    tms[tm[0]][2] = float(ASD(tms[tm[0]][2]) + ASD(e.work))
-                    tms[tm[0]][3] = float(ASD(tms[tm[0]][3]) + ASD(f.work))
-                self.pglin += 1
-        if self.cfmat == "X":
-            cwth = self.fpdf.cwth
-            self.fpdf.drawText()
-            self.fpdf.drawText("Match Summary", font=["courier", "B", 18])
-            self.fpdf.setFont(style="B")
-            self.fpdf.drawText()
-            self.fpdf.drawText("Home", w=cwth * 32, border="TLRB",
-                align="C", fill=1, ln=0)
-            self.fpdf.drawText("Visitors", w=cwth * 32, border="TLRB",
-                align="C", fill=1, ln=1)
-            x = self.fpdf.get_x()
-            y = self.fpdf.get_y()
-            for tm in ("H", "V"):
-                self.fpdf.drawText("+For", x=x, y=y, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][0], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText("-Agt", x=x, y=y, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][1], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText("=Dif", x=x, y=y, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][2], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-                self.fpdf.drawText("Pts", x=x, y=y, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=1)
-                val = CCD(tms[tm][3], "SD", 7.1)
-                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
-                    border="TLRB", align="C", fill=0)
-                x += (cwth * 8)
-        if self.lgame == self.games:
+            self.doReport("M", g)
+        if self.pgame == self.games:
             # Enter Prizes
             for key in self.keys:
                 self.doPrizes(key)
@@ -294,7 +225,7 @@
             self.where = [
                 ("bcg_cono", "=", self.opts["conum"]),
                 ("bcg_ccod", "=", self.ccod),
-                ("bcg_game", "<=", self.lgame),
+                ("bcg_game", "<=", self.pgame),
                 ("btb_cono=bcg_cono",),
                 ("btb_tab=bcg_scod",)]
             for grp in xrange(self.gqty):
@@ -335,10 +266,124 @@
         pdfnam = getModName(self.opts["mf"].rcdic["wrkdir"], __name__,
             "report", ext="pdf")
         self.fpdf.output(pdfnam, "F")
-        doPrinter(mf=self.opts["mf"], conum=1, pdfnam=pdfnam,
-            repprt=self.df.repprt)
+        if self.df.repeml[1] == "Y":
+            if not self.df.repeml[2]:
+                col = ["btb_mail"]
+                whr = [
+                    ("bce_cono", "=", self.opts["conum"]),
+                    ("bce_ccod", "=", self.ccod),
+                    ("btb_cono=bce_cono",),
+                    ("btb_tab=bce_scod",),
+                    ("btb_mail", "<>", "")]
+                recs = self.sql.getRec(tables=["bwlent", "bwltab"], cols=col,
+                    where=whr)
+                self.df.repeml[2] = []
+                for rec in recs:
+                    self.df.repeml[2].append(rec[0])
+        head = "%s - Results after game %s" % (self.cdes, self.pgame)
+        doPrinter(mf=self.opts["mf"], conum=self.opts["conum"], pdfnam=pdfnam,
+            head=head, repprt=self.df.repprt, repeml=self.df.repeml)
         self.opts["mf"].closeLoop()
 
+    def doReport(self, rtyp, grp):
+        whr = [
+            ("bcg_cono", "=", self.opts["conum"]),
+            ("bcg_ccod", "=", self.ccod),
+            ("btb_tab=bcg_scod",)]
+        col = ["bcg_scod", "btb_surname", "btb_names"]
+        if rtyp == "G":
+            whr.extend([
+                ("bcg_scod", "in", self.grps[grp][0]),
+                ("bcg_game", "=", self.pgame)])
+            col.extend([
+                "sum(bcg_shots_for) as sfor",
+                "sum(bcg_shots_agt) as sagt",
+                "sum(bcg_shots_for - bcg_shots_agt) as agg",
+                "sum(bcg_points) as pts"])
+        else:
+            whr.extend([
+                ("bcg_scod", "in", self.grps[grp][0]),
+                ("bcg_game", "<=", self.pgame)])
+            if self.pgame <= self.grgame:
+                col.extend([
+                    "sum(bcg_shots_for) as sfor",
+                    "sum(bcg_shots_agt) as sagt",
+                    "sum(bcg_shots_for - bcg_shots_agt) as agg",
+                    "sum(bcg_points) as pts"])
+            else:
+                col.extend([
+                    "sum(bcg_a_shots_for) as sfor",
+                    "sum(bcg_a_shots_agt) as sagt",
+                    "sum(bcg_a_shots_for - bcg_a_shots_agt) as agg",
+                    "sum(bcg_a_points) as pts"])
+        recs = self.sql.getRec(tables=["bwlgme", "bwltab"], cols=col,
+            where=whr, group="btb_tab, btb_surname, btb_names",
+            order="pts desc, agg desc, sagt asc")
+        if not recs:
+            return
+        self.groupHeading(rtyp, grp)
+        if self.cfmat == "X":
+            tms = {"H": [0, 0, 0, 0], "V": [0, 0, 0, 0]}
+        for num, (scod,snam,fnam,sfor,sagt,agg,pts) in enumerate(recs):
+            if fnam:
+                nam = "%s, %s" % (snam.upper(), fnam.split()[0].upper())
+            else:
+                nam = snam.upper()
+            a = CCD(num+1, "UI", 3)
+            b = CCD(nam, "NA", 30)
+            c = CCD(sfor, "SD", 7.1)
+            d = CCD(sagt, "SD", 7.1)
+            e = CCD(agg, "SD", 7.1)
+            f = CCD(pts, "SD", 7.1)
+            self.printLine(a.disp, b.disp, c.disp, d.disp, e.disp, f.disp)
+            if self.cfmat == "X":
+                tm = self.sql.getRec(tables="bwlent", cols=["bce_tcod"],
+                    where=[("bce_cono", "=", self.opts["conum"]),
+                    ("bce_ccod", "=", self.ccod), ("bce_scod", "=", scod)],
+                    limit=1)
+                tms[tm[0]][0] = float(ASD(tms[tm[0]][0]) + ASD(c.work))
+                tms[tm[0]][1] = float(ASD(tms[tm[0]][1]) + ASD(d.work))
+                tms[tm[0]][2] = float(ASD(tms[tm[0]][2]) + ASD(e.work))
+                tms[tm[0]][3] = float(ASD(tms[tm[0]][3]) + ASD(f.work))
+            self.pglin += 1
+        if self.cfmat == "X":
+            cwth = self.fpdf.cwth
+            self.fpdf.drawText()
+            self.fpdf.drawText("Match Summary", font=["courier", "B", 18])
+            self.fpdf.setFont(style="B")
+            self.fpdf.drawText()
+            self.fpdf.drawText("Home", w=cwth * 32, border="TLRB",
+                align="C", fill=1, ln=0)
+            self.fpdf.drawText("Visitors", w=cwth * 32, border="TLRB",
+                align="C", fill=1, ln=1)
+            x = self.fpdf.get_x()
+            y = self.fpdf.get_y()
+            for tm in ("H", "V"):
+                self.fpdf.drawText("+For", x=x, y=y, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=1)
+                val = CCD(tms[tm][0], "SD", 7.1)
+                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=0)
+                x += (cwth * 8)
+                self.fpdf.drawText("-Agt", x=x, y=y, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=1)
+                val = CCD(tms[tm][1], "SD", 7.1)
+                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=0)
+                x += (cwth * 8)
+                self.fpdf.drawText("=Dif", x=x, y=y, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=1)
+                val = CCD(tms[tm][2], "SD", 7.1)
+                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=0)
+                x += (cwth * 8)
+                self.fpdf.drawText("Pts", x=x, y=y, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=1)
+                val = CCD(tms[tm][3], "SD", 7.1)
+                self.fpdf.drawText(val.disp, x=x, w=cwth * 8, h=8,
+                    border="TLRB", align="C", fill=0)
+                x += (cwth * 8)
+
     def doSesWin(self):
         # Session Winners
         sess = {}
@@ -502,9 +547,12 @@
         else:
             self.pglin = 1
 
-    def groupHeading(self, group):
+    def groupHeading(self, rtyp, group):
         self.fpdf.drawText(font=["courier", "B", 18])
-        head = "Match Results After Game Number: %s" % self.lgame
+        if rtyp == "G":
+            head = "Results for Game Number: %s" % self.pgame
+        else:
+            head = "Match Results After Game Number: %s" % self.pgame
         if group:
             head += "  for Group: %s" % self.grpcod[group]
         self.fpdf.drawText(head, font=["courier", "B", 18])

=== renamed file 'bwl/bc3120.py' => 'bwl/bc3110.py'
--- bwl/bc3120.py	2016-02-27 13:18:41 +0000
+++ bwl/bc3110.py	2017-01-28 08:53:10 +0000
@@ -10,13 +10,13 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import MyFpdf, Sql, TartanDialog
 from tartanFunctions import getModName, doPrinter
 
-class bc3120:
+class bc3110:
     def __init__(self, **opts):
         self.opts = opts
         self.setVariables()

=== modified file 'bwl/bc6010.py'
--- bwl/bc6010.py	2016-09-03 14:07:52 +0000
+++ bwl/bc6010.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, SplashScreen, Sql, TartanDialog

=== modified file 'bwl/bc6020.py'
--- bwl/bc6020.py	2016-11-07 16:11:53 +0000
+++ bwl/bc6020.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, SplashScreen, Sql

=== modified file 'bwl/bc6030.py'
--- bwl/bc6030.py	2016-02-27 13:18:41 +0000
+++ bwl/bc6030.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bcc110.py'
--- bwl/bcc110.py	2016-09-03 14:07:52 +0000
+++ bwl/bcc110.py	2017-02-07 10:41:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -145,16 +145,19 @@
         if w < self.mstart or w < self.fstart or w > 890000:
             return "Invalid Number, Less than Male or Female or > 890000"
         if self.mstart == self.fstart:
+            t = "Members"
             r = w - self.mstart
             m = 400
         elif self.fstart < self.mstart:
+            t = "Male"
             r = w - self.mstart
             m = 200
         else:
+            t = "Female"
             r = w - self.fstart
             m = 200
         if r < m:
-            return "Invalid Number, Too Few Visitor Tabs. (Minimum %s)" % m
+            return "Invalid Number, Too Few %s Tabs. (Minimum %s)" % (t, m)
         self.nstart = w
 
     def doBase(self, frt, pag, r, c, p, i, w):
@@ -173,7 +176,7 @@
         if self.same == "Y":
             if self.mstart + 400 > self.nstart:
                 err = "Invalid Range, Too Few Members Allowed For"
-        elif self.mstart == self.fstart and not self.same == "Y":
+        elif self.mstart == self.fstart and self.same == "N":
             err = "Same Male and Female Starting Numbers"
         elif self.mstart < self.fstart:
             if self.fstart - self.mstart < 200:

=== modified file 'bwl/bcc210.py'
--- bwl/bcc210.py	2016-02-27 13:18:41 +0000
+++ bwl/bcc210.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'crs/cr1010.py'
--- crs/cr1010.py	2016-02-27 13:18:41 +0000
+++ crs/cr1010.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr1010_rne.py'
--- crs/cr1010_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr1010_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2010.py'
--- crs/cr2010.py	2016-02-27 13:18:41 +0000
+++ crs/cr2010.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2010_rne.py'
--- crs/cr2010_rne.py	2016-09-03 14:07:52 +0000
+++ crs/cr2010_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import glob, os, time, xml.parsers.expat

=== modified file 'crs/cr2020_rne.py'
--- crs/cr2020_rne.py	2016-09-03 14:07:52 +0000
+++ crs/cr2020_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2030_rne.py'
--- crs/cr2030_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr2030_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3010.py'
--- crs/cr3010.py	2016-05-21 12:42:32 +0000
+++ crs/cr3010.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3020.py'
--- crs/cr3020.py	2016-05-21 12:42:32 +0000
+++ crs/cr3020.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3030.py'
--- crs/cr3030.py	2016-02-27 13:18:41 +0000
+++ crs/cr3030.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3030_rne.py'
--- crs/cr3030_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3030_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3040.py'
--- crs/cr3040.py	2016-02-27 13:18:41 +0000
+++ crs/cr3040.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3050.py'
--- crs/cr3050.py	2016-05-21 12:42:32 +0000
+++ crs/cr3050.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3060.py'
--- crs/cr3060.py	2016-02-27 13:18:41 +0000
+++ crs/cr3060.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3070.py'
--- crs/cr3070.py	2016-02-27 13:18:41 +0000
+++ crs/cr3070.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3070_rne.py'
--- crs/cr3070_rne.py	2016-05-21 12:42:32 +0000
+++ crs/cr3070_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3080.py'
--- crs/cr3080.py	2016-02-27 13:18:41 +0000
+++ crs/cr3080.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3090.py'
--- crs/cr3090.py	2016-02-27 13:18:41 +0000
+++ crs/cr3090.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3100.py'
--- crs/cr3100.py	2016-02-27 13:18:41 +0000
+++ crs/cr3100.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'crs/cr3110.py'
--- crs/cr3110.py	2016-02-27 13:18:41 +0000
+++ crs/cr3110.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3310_rne.py'
--- crs/cr3310_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3310_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3320_rne.py'
--- crs/cr3320_rne.py	2016-05-21 12:42:32 +0000
+++ crs/cr3320_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'crs/cr3330_rne.py'
--- crs/cr3330_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3330_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3340_rne.py'
--- crs/cr3340_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3340_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3350_rne.py'
--- crs/cr3350_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3350_rne.py	2017-01-28 08:53:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3360_rne.py'
--- crs/cr3360_rne.py	2016-11-07 16:11:53 +0000
+++ crs/cr3360_rne.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3370_rne.py'
--- crs/cr3370_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3370_rne.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3380_rne.py'
--- crs/cr3380_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr3380_rne.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'crs/cr4010.py'
--- crs/cr4010.py	2016-02-27 13:18:41 +0000
+++ crs/cr4010.py	2017-01-28 08:53:11 +0000
@@ -10,12 +10,12 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
-from TartanClasses import ASD, Balances, NotesCreate, RepPrt, SChoice
-from TartanClasses import SelectChoice, Sql, TabPrt, TartanDialog
+from TartanClasses import ASD, Balances, NotesCreate, PrintOrder, RepPrt
+from TartanClasses import SChoice, SelectChoice, Sql, TabPrt, TartanDialog
 from tartanFunctions import getTrn
 from tartanWork import crtrtp, mthnam
 
@@ -33,7 +33,7 @@
             self.opts["mf"].startLoop()
 
     def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["crsmst", "crstrn"],
+        self.sql = Sql(self.opts["mf"].dbm, ["crsmst", "crstrn", "strpom"],
             prog=__name__)
         if self.sql.error:
             return
@@ -60,7 +60,8 @@
             ("Basic-_B", self.doTagSelect, ("T",0,2), ("T",0,1)),
             ("Balances", self.doTagSelect, ("T",0,2), ("T",0,1)),
             ("History", self.doTagSelect, ("T",0,2), ("T",0,1)),
-            ("Trans", self.doTrans1, ("T",0,2), ("T",0,1)))
+            ("Trans", self.doTrans1, ("T",0,2), ("T",0,1)),
+            ("Orders", self.doOrders, ("T",0,2), ("T",0,1)))
         r1s = (("No","N"),("Yes","Y"))
         fld = (
             (("T",0,0,0),"INA",7,"Acc-Num","Account Number",
@@ -255,6 +256,47 @@
             self.df.enableButtonsTags(state=state)
         self.doTrans1()
 
+    def doOrders(self, widget=None):
+        col = self.sql.strpom_col
+        whr = [
+            ("pom_cono", "=", self.opts["conum"]),
+            ("pom_acno", "=", self.acno),
+            ("pom_delno", "=", "")]
+        recs = self.sql.getRec(tables="strpom", where=whr, order="pom_date")
+        if recs:
+            data = []
+            for dat in recs:
+                data.append([
+                    dat[col.index("pom_date")],
+                    dat[col.index("pom_ordno")],
+                    dat[col.index("pom_cusord")],
+                    dat[col.index("pom_jobnum")],
+                    dat[col.index("pom_contact")]])
+            tit = "Orders for Account: %s - %s" % (self.acno, self.name)
+            col = (
+                ("pom_date", "   Date", 10, "D1", "N"),
+                ("pom_ordno", "Doc-Numbr", 9, "UI", "N"),
+                ("pom_cusord", "Cust-Ord-Num", 15, "Na"),
+                ("pom_jobnum", "Job-Num", 7, "Na"),
+                ("pom_contact", "Contact", 30, "NA"))
+            state = self.df.disableButtonsTags()
+            while True:
+                rec = SelectChoice(self.df.nb.Page6, tit, col, data)
+                # Attempt to display the document
+                if rec.selection:
+                    self.df.setWidget(self.df.mstFrame, state="hide")
+                    try:
+                        doc = int(rec.selection[2])
+                        PrintOrder(self.opts["mf"], self.opts["conum"],
+                            self.opts["conam"], doc, repprt=["N", "V",
+                            "view"], copy="y")
+                    except:
+                        pass
+                    self.df.setWidget(self.df.mstFrame, state="show")
+                else:
+                    break
+            self.df.enableButtonsTags(state=state)
+
     def doNotes(self, widget=None):
         state = self.df.disableButtonsTags()
         self.df.setWidget(self.df.mstFrame, state="hide")

=== modified file 'crs/cr4010_rne.py'
--- crs/cr4010_rne.py	2016-11-07 16:11:53 +0000
+++ crs/cr4010_rne.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr6010.py'
--- crs/cr6010.py	2016-02-27 13:18:41 +0000
+++ crs/cr6010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'crs/cr6010_rne.py'
--- crs/cr6010_rne.py	2016-02-27 13:18:41 +0000
+++ crs/cr6010_rne.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'crs/cr6020.py'
--- crs/cr6020.py	2016-02-27 13:18:41 +0000
+++ crs/cr6020.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/crc110.py'
--- crs/crc110.py	2016-02-27 13:18:41 +0000
+++ crs/crc110.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'csh/ca2010.py'
--- csh/ca2010.py	2016-09-03 14:07:52 +0000
+++ csh/ca2010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'csh/ca2020.py'
--- csh/ca2020.py	2016-02-27 13:18:41 +0000
+++ csh/ca2020.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time, xlrd

=== modified file 'csh/ca3010.py'
--- csh/ca3010.py	2016-02-27 13:18:41 +0000
+++ csh/ca3010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'csv/bwlrnd_fld.csv'
--- csv/bwlrnd_fld.csv	2014-03-28 07:32:49 +0000
+++ csv/bwlrnd_fld.csv	2017-01-26 09:36:46 +0000
@@ -2,3 +2,4 @@
 1,"bcr_ccod","UI","3.0","Competiton Code","CCD"
 2,"bcr_rcod","UI","2.0","Round Number","RN"
 3,"bcr_date","D1","10.0","Round Date","Round-Date"
+4,"bcr_time","TM","5.0","Round Time","Round-Time"

=== modified file 'csv/bwlsys.py'
--- csv/bwlsys.py	2015-12-12 09:12:17 +0000
+++ csv/bwlsys.py	2017-02-02 13:32:50 +0000
@@ -2,7 +2,7 @@
     # Bowls
     "bwlclb", "bwlcmp", "bwlctl", "bwldrm", "bwldrt", "bwlent", "bwlflf",
         "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlrnd", "bwltab",
-        "bwltyp", "bwlpts",
+        "bwltms", "bwltyp", "bwlpts",
     # Controls
     "ctllog", "ctlmst", "ctlnot", "ctlpwm", "ctlpwr", "ctlpwu", "ctlsys",
     # Reports

=== modified file 'csv/bwltab_fld.csv'
--- csv/bwltab_fld.csv	2014-12-09 16:32:44 +0000
+++ csv/bwltab_fld.csv	2017-02-03 07:27:19 +0000
@@ -14,6 +14,6 @@
 13,"btb_mail","TX","50.0","Email Address","Email-Address"
 14,"btb_pos1","UI","1.0","Position - Primary","P"
 15,"btb_rate1","UI","2.0","Rating - Primary","RP"
-16,"btb_pos2","UI","1.0","Position - Mixed","P"
+16,"btb_pos2","UI","1.0","Position - Mixed","M"
 17,"btb_rate2","UI","2.0","Rating - Mixed","RM"
 18,"btb_bsano","UI","6.0","Association Number","BA-Num"

=== added file 'csv/bwltms_fld.csv'
--- csv/bwltms_fld.csv	1970-01-01 00:00:00 +0000
+++ csv/bwltms_fld.csv	2017-02-02 13:14:15 +0000
@@ -0,0 +1,5 @@
+0,"btd_cono","UI","3.0","Company Number","Coy"
+1,"btd_ccod","UI","3.0","Competition Code","CC"
+2,"btd_scod","UI","6.0","Skip Code","S-Code"
+3,"btd_mem1","UI","6.0","Mem1 Code","M1-Cod"
+4,"btd_mem2","UI","6.0","Mem2 Code","M2-Cod"

=== added file 'csv/bwltms_idx.csv'
--- csv/bwltms_idx.csv	1970-01-01 00:00:00 +0000
+++ csv/bwltms_idx.csv	2017-02-02 13:14:52 +0000
@@ -0,0 +1,1 @@
+"Drawn Teams",1,"U","btd_cono","btd_ccod","btd_scod"

=== modified file 'csv/frelat.dat'
--- csv/frelat.dat	2016-06-22 08:28:55 +0000
+++ csv/frelat.dat	2017-01-26 12:37:40 +0000
@@ -152,6 +152,9 @@
 bkmunm|bum_cono|ctlvmf|vtm_cono
 bkmunm|bum_vatc|ctlvmf|vtm_code
 # Bowls
+bwldrm|bdm_cono|bwldrt|bdt_cono
+bwldrm|bdm_date|bwldrt|bdt_date
+bwldrm|bdm_time|bwldrt|bdt_time
 bwlent|bce_ccod|bwlgme|bcg_ccod
 bwlent|bce_scod|bwltab|btb_tab
 bwlent|bce_scod|bwlgme|bcg_scod

=== modified file 'csv/stdsys.py'
--- csv/stdsys.py	2015-12-12 09:12:17 +0000
+++ csv/stdsys.py	2017-02-02 13:32:34 +0000
@@ -7,7 +7,7 @@
     # Bowls
     "bwlclb", "bwlcmp", "bwlctl", "bwldrm", "bwldrt", "bwlent", "bwlflf",
     "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlrnd", "bwltab",
-    "bwltyp", "bwlpts",
+    "bwltms", "bwltyp", "bwlpts",
     # Controls
     "ctlbat", "ctlctl", "ctldep", "ctllog", "ctlmes", "ctlmst", "ctlnot",
     "ctlpwm", "ctlpwr", "ctlpwu", "ctlrep", "ctlsys", "ctlvmf", "ctlvrf",

=== modified file 'doc/BKS.rst'
--- doc/BKS.rst	2016-12-30 14:10:51 +0000
+++ doc/BKS.rst	2017-02-25 14:02:44 +0000
@@ -2,11 +2,11 @@
  TARTAN SYSTEMS - Book Clubs
 =============================
 
-:Version:   5.2.7
+:Version:   5.2.8
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za
-:Copyright: Paul Malherbe (C) 2004-2016.
+:Copyright: Paul Malherbe (C) 2004-2017.
 :Licence:   Free use of this software and all it's modules is granted under the terms of the License.
 
 .. contents:: **Table of Contents**

=== added file 'doc/BQS.rst'
--- doc/BQS.rst	1970-01-01 00:00:00 +0000
+++ doc/BQS.rst	2017-02-18 10:28:27 +0000
@@ -0,0 +1,42 @@
+==============================
+ Tartan Systems - Quick Start
+==============================
+
+Once Tartan Systems has been installed, the following procedures have to be performed before any meaningful work can be done.
+
++ Start Tartan by either clicking on the icon on the desktop or from the command line as follows:
+
+    + **Linux** - `program_path/ms0000.py [options]`
+    + **Windows** - `program_path\\ms0000.exe [options]`
+
+  To find out what the available command line options are, use the -h option.
+
++ Login using **admin** as the user name and a password, if prompted.
+
++ The first time Tartan is started you will be taken to `Preferences` where you will have to enter your preferences regarding database, paths, utilities and various other choices. In order to use the defaults press `Enter` to accept the `Configuration File` and then click the `Save Button`. You will then have to create the system record using `System Record Maintenance`. Click on the `Accept Button` to accept the defaults. You will also have to create a club record using `Club Master Record`. For most club installations there will only be one club record.
+
++ **Tabs Draw**
+    * Create a Control record by selecting `Control Record` from the File Maintenance menu.
+    * Create Tab records by selecting `Tabs Maintenance` from the File Maintenance menu.
+    * Do a draw by selecting `Draw` from the Tabs Draw menu.
+    * Reprint a draw by selecting `Reprint Draw` from the Tabs Draw menu.
+    * Print a draw summary by selecting `Draws Summary` from the Tabs Draw menu.
++ **League Selections**
+    * Create a league format record by selecting `League Formats` from the File Maintenance menu.
+    * Create Tab records by selecting `TABS Maintenance` from the File Maintenance menu.
+    * Create side records by selecting `Side's Maintenance` from the File Maintenance menu.
+    * Enter team selections by selecting `Capture Selections` from the League Selections menu.
+    * To print `Assessment Forms` select Assessment Forms from the League Selections menu.
+    * To print flag `Declaration Forms` select Declaration Forms from the League Selections menu.
+    * To capture the completed `Assessment Forms` select `Capture Assessments` from the menu.
+    * To print the `Match Assessment Report` select Match Assessment Report from the League Selections menu.
+    * To print the `Assessment Summary` select `Assessment Summary` from the League Selections menu.
+    * To clear historical selections select `Clear League History` from the Toolbox menu.
++ **Club Competitions**
+    * Create a Competition Type record by selecting `Competition Types` from the File Maintenance menu.
+    * Capture Competition Entries by selecting `Capture Entries` from the Club Competitions menu.
+    * Print Match Draw and Cards by selecting `cCompetition Draw` from the Club Competitions menu.
+    * Print Match Cards Summary by selecting `Draw Summary` from the Club Competitions menu. This report is a running summary of all draws.
+    * To change the Draw select `Change Draw` from the Club Competitions menu. After changing the draw you must reprint them as per above. Please note that to only reprint cards you must select `Cards Only`.
+    * After the games have been played enter the results by selecting `Capture Game Results` from the Club Competitions menu.
+    * Print the game and match results by selecting the `Match Results Report` from the Club Competitions menu.

=== modified file 'doc/BWL.rst'
--- doc/BWL.rst	2016-12-30 14:10:51 +0000
+++ doc/BWL.rst	2017-02-18 08:50:45 +0000
@@ -19,12 +19,12 @@
 + **Rate - Visitor** - The visitor's rate.
 + **Greens** - The available green codes e.g. AB
 + **Draw Format** - The format to print the draw sheets as follows:
-  + **S32L-S32L** - Skip, 3rd, 2nd, Lead - Skip, 3rd, 2nd, Lead
-  + **S32L-L23S** - Skip, 3rd, 2nd, Lead - Lead, 2nd, 3rd, Skip
+    + **S32L-S32L** - Skip, 3rd, 2nd, Lead - Skip, 3rd, 2nd, Lead
+    + **S32L-L23S** - Skip, 3rd, 2nd, Lead - Lead, 2nd, 3rd, Skip
 
 Club's Records
 ++++++++++++++
-Use this routine to add, amend and delete clubs.
+Use this routine to add, amend and delete clubs records. These records are used by the `League Selections` modules.
 
 + **Club Code** - The applicable club's code. A zero code will automatically select the next available code.
 + **Club Name** - The name of the club.
@@ -392,30 +392,24 @@
     + **SA** - Shots scored by the opposing side.
     + **Pnts** - Points scored by the opposing side.
 
-Game Results Report
-+++++++++++++++++++
-Use this routine to print game results, excluding knockout, as follows:
-
-+ **Competition Code** - The relevant competition code.
-+ **Game Number** - The relevant game number.
-
-Results are ranked in the order most points, largest shot difference and then least shots coceded.
-
 Match Results Report
 ++++++++++++++++++++
 Use this routine to print the match results as follows:
 
 + **Competition Code** - The relevant competition code.
 + **Last Game** - The last game to take into account.
-+ **Session Prizes** - Whether session prizes are to be awarded.
-+ **Session Prizes by Group** - Whether session prizes are to be awarded by group.
-
-Prizes by Group or the Match if not Grouped
-
-+ **Number Prizes** - The number of prizes being awarded.
-+ **EFT Forms** - Whether to print EFT Forms in which case you will be required to enter the total value of each prize.
-
-Results are ranked in the order most points, largest shot difference and then least shots coceded.
++ **Game Report** - Print the last game's results.
+
+If the last game of the competition is being printed, enter the following:
+    + **Session Prizes** - Whether session prizes are to be awarded.
+    + **Session Prizes by Group** - Whether session prizes are to be awarded by group.
+
+    Prizes by Group or the Match if not Grouped
+
+    + **Number Prizes** - The number of prizes being awarded.
+    + **EFT Forms** - Whether to print EFT Forms in which case you will be required to enter the total value of each prize.
+
+Results are ranked in the order of most points, largest shot difference and then least shots conceded.
 
 Contact Request Forms
 +++++++++++++++++++++

=== modified file 'doc/BWM.rst'
--- doc/BWM.rst	2016-12-30 14:10:51 +0000
+++ doc/BWM.rst	2017-02-25 14:02:44 +0000
@@ -2,11 +2,11 @@
  TARTAN SYSTEMS - Bowling Clubs
 ================================
 
-:Version:   5.2.7
+:Version:   5.2.8
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za
-:Copyright: Paul Malherbe (C) 2004-2016.
+:Copyright: Paul Malherbe (C) 2004-2017.
 :Licence:   Free use of this software and all it's modules is granted under the terms of the License.
 
 .. contents:: **Table of Contents**

=== modified file 'doc/Downloads.rst'
--- doc/Downloads.rst	2016-12-30 14:10:51 +0000
+++ doc/Downloads.rst	2017-02-25 14:02:44 +0000
@@ -11,23 +11,23 @@
 
 |tartan| Version
 ================
-The latest version of Tartan is 5.2.7 and was released on the 30th December, 2016.
+The latest version of Tartan is 5.2.8 and was released on the 25th February, 2017.
 
 Backup and restore functions must only be done with the  same version of Tartan i.e. the version used to restore a backup must be the same as the one used to make the backup.
 
 .. _Documentation: http://www.tartan.co.za/cgi-bin/simple_web.py/Documentation
-.. _Tartan-5-lnx: ftp://tartan.co.za/Tartan_5.2.7.tgz
+.. _Tartan-5-lnx: ftp://tartan.co.za/Tartan_5.2.8.tgz
 .. _Tartan-4-lnx: ftp://tartan.co.za/Tartan_4.1.14.tgz
 .. _Tartan-3-lnx: ftp://tartan.co.za/Tartan_3.4.51.tgz
 .. _Tartan-2-lnx: ftp://tartan.co.za/Tartan_2.5.29.tgz
-.. _Tartan-5-win: ftp://tartan.co.za/Tartan_5.2.7.exe
+.. _Tartan-5-win: ftp://tartan.co.za/Tartan_5.2.8.exe
 .. _Tartan-4-win: ftp://tartan.co.za/Tartan_4.1.14.exe
 .. _Tartan-3-win: ftp://tartan.co.za/Tartan_3.4.51.exe
 .. _Tartan-2-win: ftp://tartan.co.za/Tartan_2.5.29.exe
-.. _Bwlclb-5-lnx: ftp://tartan.co.za/Bwlclb_5.2.7.tgz
-.. _Bwlclb-5-win: ftp://tartan.co.za/Bwlclb_5.2.7.exe
-.. _Seccmp-5-lnx: ftp://tartan.co.za/Seccmp_5.2.7.tgz
-.. _Seccmp-5-win: ftp://tartan.co.za/Seccmp_5.2.7.exe
+.. _Bwlclb-5-lnx: ftp://tartan.co.za/Bwlclb_5.2.8.tgz
+.. _Bwlclb-5-win: ftp://tartan.co.za/Bwlclb_5.2.8.exe
+.. _Seccmp-5-lnx: ftp://tartan.co.za/Seccmp_5.2.8.tgz
+.. _Seccmp-5-win: ftp://tartan.co.za/Seccmp_5.2.8.exe
 
 |linux| Linux
 =============

=== modified file 'doc/MST.rst'
--- doc/MST.rst	2016-12-30 14:10:51 +0000
+++ doc/MST.rst	2017-02-25 14:02:44 +0000
@@ -2,11 +2,11 @@
  Tartan Systems - User Manual
 ==============================
 
-:Version:   5.2.7
+:Version:   5.2.8
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za
-:Copyright: Paul Malherbe (C) 2004-2016.
+:Copyright: Paul Malherbe (C) 2004-2017.
 :Licence:   Free use of this software and all it's modules is granted under the terms of the Licence.
 
 :Note: This document is not intended as an accounting manual. It is primarily a manual for people with some accounting expertise to learn how to use Tartan as an accounting tool.
@@ -67,10 +67,11 @@
 
 Additionally, the following dependencies should also be installed using pip:
 
++ ghostscript
 + odfpy
 + markdown
 + pysmb
-+ Python-Chart
++ python-chart
 + simpleodspy
 + xlrd
 + xlwt
@@ -95,9 +96,9 @@
 --------------
 Download the following file from ftp://ftp.tartan.co.za or if you are in possession of a CD this is not necessary.
 
-+ Tartan_full_5.x.x.exe
++ Tartan_5.x.x.exe
 
-Install Tartan_full_5.x.x.exe by browsing to it and double clicking and then accept the defaults, except, also agree to creating an icon on your desktop.
+Install Tartan_5.x.x.exe by browsing to it and double clicking and then accept the defaults, except, also agree to creating an icon on your desktop.
 
 Tartan should now be installed on your computer and you can continue with the `Startup Procedure`_.
 
@@ -321,7 +322,7 @@
     + **Backup Path** - This is the path where backups of the database will be stored.
     + **Work Path** - This is the path of the work directory. All temporary files will be created in this directory.
     + **Upgrade Path** - This is the path where any upgrades will be stored.
-    + **PDF Viewer** - This is the full path of the program used to display pdf files.  The default for LINUX is **xpdf** and Windows is **SumatraPDF**. Other recommended programs for windows are **Foxit Reader** and **AcroRd32** version 4.05.
+    + **PDF Viewer** - This is the full path of the program used to display pdf files.  The default for LINUX is **evince** and Windows is **SumatraPDF**. Other recommended programs for windows are **Foxit Reader** and **AcroRd32** version 4.05.
     + **Print Command** - This is the full path of the print program used to print postscript files. The LINUX default is **lpr** and Windows is **SumatraPDF**. Other recommended programs for windows are **Foxit Reader** and **AcroRd32** version 4.05.
     + **PS Converter** - This is the full path of the program needed to convert pdf files to postscript. The LINUX default is **pdftops** and the Windows one is **blank**.  If this field is left blank, no conversion will take place and the print routine will have to be able to print pdf files directly e.g. where one of `SumatraPDF`, `Foxit Reader` or `Acrobat Reader` has been selected as the printer.
     + **CSV Reader** - This is the full path of the program used to read csv and xls file formats.

=== removed file 'doc/Rsync.rst'
--- doc/Rsync.rst	2014-03-28 07:32:49 +0000
+++ doc/Rsync.rst	1970-01-01 00:00:00 +0000
@@ -1,296 +0,0 @@
-Rsync Date Stamped, Snapshot Style, Incremental Backups
--------------------------------------------------------
-:Author:    Andrew J. Nelson 
-:Published: 2 August 2011
-
-Introduction
-............
-The objective is to create a series of daily, snapshot style, incremental backups with the following properties to each backup: it will be date stamped; it will reflect reflect the changes to the file structure since the prior backup; it will appear as a complete file structure. Additionally, the entirety of the backup will occupy only slightly more disk space than a single complete backup, even though each daily backup gives the appearance of a full backup. Finally, the entire backup process will be automated.
-
-Credit
-......
-The incremental snapshot backup method with rsync was first published by Mike Rubel. It was an innovative concept, and he deserves all the credit for it. This document expands and refines the methods originated by Mike Rubel.
-
-Rsync And Backup Concepts
--------------------------
-Terminology
-...........
-When learning rsync myself, one of the more confusing aspects was that many online tutorials used inconsistent terms. We will define keywords now, and use them consistently throughout the document.
-
-Source Directory
-................
-The directory that is being backed up; the original data being copied.
-
-Target Directory
-................
-The directory to which data is backed up; the destination directory.
-
-File Structure
-................
-A directory tree; a group of files and directories with a common root directory.
-
-Rsync
-................
-Rsync is a fast and extraordinarily versatile file copying tool. Rysnc can copy files either locally (files stay on the same computer) or remotely (files are copied from one computer to another computer via a network; the network can be a LAN or the internet). Rsync has a tremendous number of options that allow the user to control every aspect of the copy process.
-
-The beauty of rsync is that it uses an algorithm to compare the source directory against the target directory, and only copies to the target what is different in the source. It doesn't even copy over an entire file if only a part of it has changed; it copies only those bytes which are different. This dramatically reduces your overhead for transferring files.
-
-Incremental Backups
-...................
-Assume a working directory called Alpha. On day one you create a full backup of Alpha called Alpha_Full. On day two you would create an incremental backup called Alpha_2. This backup only contains those files from the working directory Alpha which are different from the full backup, Alpha_Full. Because only what has changed is copied over, it is much faster and uses far less disk space than a full backup.
-
-On day three, another backup is made named Alpha_3. This time, only what has changed in Alpha compared to the prior day's incremental backup (Alpha_2) is copied over, instead of what has changed in Alpha compared to the full backup (Alpha_Full). This is the key concept in incremental backups: only what has changed since the prior day is backed up.
-
-Incremental Vs. Differential Backups
-....................................
-Each day, a differential backup copies over what is different in the source directory as compared against the original full backup. As the amount of time increases since the full backup, the number of changes between the working source directory and the full backup correspondingly increase; therefore, the size of the daily backup increases.
-
-Continuing from our prior example, if we were making differential backups Alpha_10 would consist of all the changes in the source directory in the last 10 days. This tutorial utilizes the incremental approach instead of the differential, but it is best to understand both forms.
-
-Snapshot Backups, or Incremental Backups Appearing As Full File Structures
-..........................................................................
-It is easiest for most people to utilize a backup if it looks like the full file structure, instead of perhaps just a few files which have changed since yesterday sitting alone in a directory. Indeed, if the backup process accounts for deleted files, it is harder to identify that a file has been deleted without the context of the full file structure. It is also harder to differentiate files backed up because they were deleted instead of backed up because they were changed.
-
-The most natural way to use a backup is for a user to see the backup as a snapshot: a picture of the way the file structure looked at a certain point in time.
-
-We accomplish this with rsync by hard linking to all unchanged files from the incremental backup. The hard link creates the appearance of the unchanged file existing in the incremental backup; however it does not. It is just a link to the file. Thus, the appearance of a full daily backup is created without the overhead in time, network resources, or disk space.
-
-The concept of hard links is integral to this process. The next section delves into hard links in detail, so that we may grok it fully before continuing.
-
-Hard Links
-----------
-This section will explain what a hard link is and walk through a couple exercises to reinforce the concept for the user. I know that I intellectually understood it, but didn't really get it, (or grok it, if you will), until I had played around with some commands looking at it.
-
-An inode is an index of a file's attributes, such as file permissions, owner, group, file size, number of hard links and soft links, and times of access, modification, and deletion. (This is not an exhaustive list.) Typically, an inode is associated with exactly one directory entry. However, it is possible to associate an inode with more than one directory entry by creating a hard link.
-
-Indeed, a file name is not the file itself, but a hard link to the file. So, lets play with hard links for a bit. Create a new file:
-
-::
-
-  touch foo.txt
-
-We can now use the stat command to examine the properties of that file. Run:
-
-::
-
-  stat foo.txt
-
-The output will show the inode number and the number of links to the inode. Now, lets create a hard link to foo.txt using the ln command:
-
-::
-
-  ln foo.txt bar.txt
-
-Now run stat on each filename. You will see that the output is exactly the same; they share the same inode number and have an equal number of links. You can also use ls -i to view just the inode number; foo.txt and bar.txt are the same thing.
-
-So what happens if you operate on them? If you make changes to one, the same changes are made to the other. If you modify ownership or any other attribute of one, the same modifications are made to the other. However, if you use rm on one, you do not delete both. The rm command actually removes the hard link to the file; the other link will remain. The file itself will not be deleted until the number of links to it reaches zero.
-
-Go ahead and edit the file, change its permissions, etc. After each change, run stat on each file until you are convinced in your soul that foo.txt and bar.txt are the same thing. Then use rm on one, stat the remainder, then rm it.
-
-We make use of this with rsync to create the illusion of a full copy of a file structure, when in fact all we have done is hard linked. All the data is accessible as if the full structure were there, without the hard disk and network overhead of doing a full copy. But I'm getting ahead of myself, more on that later.
-
-Using Rsync
------------
-The Basics
-..........
-The basic usage of rsync is very simple:
-
-::
-
-  rsync [options] [source directory] [target directory]
-
-This compares the source directory against the target directory, and copies over everything that is different in the source to the target.
-
-There is one point of syntax in this that gets a lot of new rsync users hung up. Given a source directory bravo containing file widget.txt (breaking conventions by not using foo and bar!), and a target directory charlie, then
-
-::
-
-  rsync -a /bravo /charlie
-
-*is not the same thing as*
-
-::
-
-  rsync -a /bravo/ /charlie
-
-The first command copies the directory bravo, and its contents, into charlie, resulting in /charlie/bravo/widget.txt. The second command copies only the contents of bravo into charlie, resulting in /charlie/widget.txt. So remember, a trailing slash on the source directory means that the source directory's contents are copied, not the directory itself.
-
-Rsync Options
-.............
-Obviously, detailing the massive number of options that rsync has available is beyond the scope of this document. We will talk about the specific ones used in our method.
-
-The first option we use is -a, which stands for archive mode. Archive mode is a compilation of other switches, which amount to preserving almost everything.
-
-*Rsync Switches Inherent To Archive Mode*
-
-+ r: operate recursively
-+ l: preserve links
-+ p: preserve permissions
-+ t: preserve times
-+ g: preserve groups
-+ o: preserve owner
-+ D: preserve device files and special files
-
-So you can see that by using archive mode, the files are copied in such a way that they could be restored to the source directory transparently; everything vital to their use is maintained.
-
-The second option we utilize is -v, which as usual requests verbosity in reporting. Its always nice to see what is going on, and export it to a log if you so choose.
-
-The third option is -h, which requests that transfer amounts are expressed in human readable format. Instead of 1256842136 bytes transferred, you will see 1.257 GB, or something like that.
-
-The fourth option is --delete, which deletes files from the target directory that have been deleted in the source directory. So not only are files which are different in the source directory copied to the target directory, files which don't exist in the source but do exist in the target are deleted from the target.
-
-Our last option is --link-dest=[link directory], and this takes a bit of explaining.
-
-Rsync typically evaluates against the target directory. The --link-dest option instructs rsync to use the specified link destination directory as an additional file structure to evaluate against; files that are unchanged in either the target directory or the link destination directory are not sent. Additionally, unchanged files are hard linked from the link destination directory to the target directory.
-
-Lets break that down, continuing our example. Our working directory, Alpha, has a full backup called Alpha_Full created on day one. On day two, we want to create our incremental backup in a new directory called Alpha_2. If we created a new empty directory called Alpha_2 and ran:
-
-::
-
-  rsync -avh --delete /Alpha/ /Alpha_2
-
-A new full backup of Alpha would be made in Alpha_2. That isn't incremental, and doesn't do us any good. By using the --link-dest option like this:
-
-::
-
-  rsync -avh --delete --link-dest=/Alpha_Full /Alpha/ /Alpha_2
-
-We are instructing rsync to backup the contents of Alpha into Alpha_2, evaluating for differences against Alpha_Full. It is as if Alpha_2 was Alpha_Full for the purpose of checking for changes. Then, after it transfers those files that have changed, it hard links everything else from Alpha_Full to Alpha_2. The hard links create the appearance of the files existing twice, once in both Alpha_Full and Alpha_2, but there is actually only one copy of the file. Finally, since the --delete option was used, files that were deleted in Alpha will have their hard links deleted in Alpha_2.
-
-Thus, we have created a snapshot, incremental backup. The next day we would do the same thing, creating Alpha_3, but instead of evaluating against Alpha_Full for changes, we would check against Alpha_2.
-
-Rsync and Hard Links
-....................
-A concern you may have is: what happens to a file that is originally stored in Alpha_Full, then on day 10 is changed? If Alpha_10 only has a hard link to the original file, and that file is changed, does rsync change the original, thus ruining the snapshot effect?
-
-The answer is no. Rsync is "wicked smart", as they say in my neck of the woods. When evaluating for changes against a hard link, if the source file is different, the destination file is unlinked before transfer. A new version of the file is created in the target directory, and the historical version of the file is preserved in earlier backups. You have to give explicit options for rsync to do otherwise, and the man pages hint rather broadly that it might be a bad idea.
-
-Secure Transmission With Rsync
-..............................
-All of our examples thus far have used rsync to copy files locally. Rsync can be used to backup to another computer across a network, whether that network is a LAN or the internet. You can specify which remote shell to use with -e, followed by the shell name. The syntax for the source directory remains the same. The syntax for the target directory works much like scp: username@domain.name:.
-
-Continuing our example, if we were making our backups of alpha to a remote computer at a domain named pluto.org, it would look like this:
-
-::
-
-  rsync -avh -e ssh --delete /Alpha/ username@pluto.org:/Alpha_2
-
-Substitute username with an account that has the appropriate rights. You would then be prompted for the password. You can obviate the need for passwords by using preshared keys, or setting up an rsync daemon server. Both of those options fall outside the scope of this document.
-
-The remainder of the tutorial assumes that the backups are made to a network share or a separate partition on the same computer, not a remote machine. Even so, it is important to understand that rsync has this capability.
-
-Date Stamping With A Shell Script
----------------------------------
-We now understand the methods and theory behind creating a snapshot style, incremental backup with rsync. The next step is implementation. Other methods use a backup naming convention such as backup1, backup2, backup3. The script used to automate the method then deletes backup3, renames backup2 to backup3, and likewise renames backup1 to backup2. It then creates a new backup1, using backup2 as the link destination directory.
-
-That successfully creates a rotating backup structure. However, I found the steps required to do the process somewhat convoluted, and the number of steps increases with the number of backups you want to keep on hand.
-
-I thought it would be simpler if the script could simply recognize yesterday's backup by name. I also thought it would be easier to recognize and find the backup you need by date, rather than by an abstract identifier. We can accomplish both these goals by using date stamps for the backup names.
-
-Lets walk through the steps we would want our automated script to do.
-
-Create a new directory for the daily backup; the directory's name should be today's date.
-
-Backup the source directory to the target directory, using the directory named with yesterday's date as the link destination.
-
-(optional) Delete a directory that is a certain number of days old.
-
-So the first step in making this work is getting a shell script to be able to find today's date, yesterday's date, and a third date from x number of days ago. If you want to keep backups for 28 days, x would equal 29. I'll talk about why step three is optional later.
-
-How To Date Stamp
-.................
-When we talk about date stamping, we mean using a date format such as 2011-07-24 to represent July 24, 2011. This format is unambiguous, universally recognizable, and guarantees that files named in that format will accurately sort by date ascending or descending.
-
-The man page documentation for date is varied, and sadly, often incomplete. I am going to show some of the hard ways of doing things before showing the easier ways. (I am a firm believer that you never learn anything by doing it right.)
-
-If we want the system to output today's date in date stamp format, one way of doing it is to use the date command like this with modifiers to explicitly state the format.
-
-::
-
-  date +%Y-%m-%d
-
-This is also know as an ISO-8601 compliant format. What is not well known about the date command is that it has a switch to output in ISO-8601: -I. So, this accomplishes the same thing with far fewer symbols:
-
-::
-
-  date -I
-
-To use this in our script, we can create a variable and assign it to that by running the date command within backticks.
-
-::
-
-  DAY0=`date -I`
-
-We now have a variable which will always be equal to today's date in date stamp format. Useful to our objective, no? Next, we need a variable equal to yesterday's date in date stamp format.
-
-I went through quite the process on this before I found a simpler method. The hard way was that I converted today's date to epoch time (the number of seconds since midnight, January 1, 1970) and assigned that value to a variable. I then subtracted 1 days worth of seconds from that variable and assigned that value to a new variable. I then converted the new variable back into date stamp format. All of this required some esoteric commands.
-
-Now for the easy way. The date command also has an under-documented function where it will tell you a date in the past or future with simple syntax. For instance, if today's date is 2011-07-27, then the following code will output 2011-07-26 and assign it to a variable:
-
-::
-
-  DAY1=`date -I -d "1 day ago"`
-
-The Backup Script
-.................
-Lets flesh out the rest of the script. Make these assumptions: we are backing up a website to a directory named /backup located on a separate partition. The full initial backup was made manually to the directory with a backup name of 2011-07-01. We will set variables equal to our source directory, our target directory, our link destination directory, and our options. We will then execute the rsync command. Create a script called website_bak.sh. (Make sure you make it executable.)
-
-::
-
-  #!/bin/bash
-
-  #Website Backup Script
-
-  #Todays date in ISO-8601 format:  
-  DAY0=`date -I`
-
-  #Yesterdays date in ISO-8601 format:  
-  DAY1=`date -I -d "1 day ago"`
-
-  #The source directory:  
-  SRC="/var/www/htdocs/"
-
-  #The target directory:  
-  TRG="/backup/website/$DAY0"
-
-  #The link destination directory:  
-  LNK="/backup/website/$DAY1"
-
-  #The rsync options:  
-  OPT="-avh --delete --link-dest=$LNK"
-
-  #Execute the backup  
-  rsync $OPT $SRC $TRG
-
-If the initial full back up is made on 2011-07-01, you can have this script executed as a cron job starting on 2011-07-02. Each day it will make an incremental date stamped backup, using the prior day's backup as the link destination directory. There is no need to rename backups or move them around. You will also note that the rsync command itself creates the target directory. This will work for one directory level; however, if the directory /website did not exist, such that rsync had to create /website and /$DAY0, the backup would fail. Rsync would exit with an error code.
-
-The last optional step is to remove older backups. The reason I say this is optional is because it depends on how much data you are working with and the degree of change it experiences. This method is very efficient at reducing overhead; you could conceivably keep incremental backups for years without running out of space if your data doesn't change drastically.
-
-However, lets say that you want to only keep the last 28 days of data. Add the following lines to the script.
-
-::
-
-  #29 days ago in ISO-8601 format
-  DAY29=`date -I -d "29 days ago"`
-
-  #Delete the backup from 29 days ago, if it exists
-  if [ -d /backup/website/$DAY29 ]
-  then
-    rm /backup/website/$DAY29
-  fi
-
-Voila, a script that does everything we need for a backup. Our final step is to automate its use.
-
-Cron
-....
-Linux has a scheduling utility called cron which will run operations at a fixed time. Going into how cron works and editing its settings is beyond the scope of this document. However, if you just want a script to run daily, it is simply a matter of placing it in the correct directory.
-
-So, copy the backup script to the cron daily directory. In Slackware, this is:
-
-::
-
-  cp -v website_bak.sh /etc/cron.daily/
-
-Conclusion
-----------
-After a long journey, we have reached our goal of having automated, snapshot style incremental backups using rsync. Along the way we learned the difference between incremental and differential backups, what hard links are, how rsync works, and how to pull it all together with a shell script. I hope that this article helps you in your endeavors.

=== modified file 'doc/SEC.rst'
--- doc/SEC.rst	2016-12-30 14:10:51 +0000
+++ doc/SEC.rst	2017-02-25 14:02:44 +0000
@@ -2,11 +2,11 @@
  TARTAN SYSTEMS - Sectional Competitions
 ========================================
 
-:Version:   5.2.7
+:Version:   5.2.8
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za
-:Copyright: Paul Malherbe (C) 2004-2016.
+:Copyright: Paul Malherbe (C) 2004-2017.
 :Licence:   Free use of this software and all it's modules is granted under the terms of the License.
 
 .. contents:: **Table of Contents**

=== removed file 'doc/gnugpl.rst'
--- doc/gnugpl.rst	2014-03-28 07:32:49 +0000
+++ doc/gnugpl.rst	1970-01-01 00:00:00 +0000
@@ -1,274 +0,0 @@
-
-GNU GENERAL PUBLIC LICENSE
-==========================
-
-**Version:** 2 **Date:** June 1991
-
-Copyright:Copyright (C) 1989, 1991 Free Software Foundation, Inc. 59 Temple
-Place, Suite 330, Boston, MA 02111-1307 USA.
-
-Everyone is permitted to copy and distribute verbatim copies of this license
-document, but changing it is not allowed.
-
-
-Preamble
-========
-
-The licenses for most software are designed to take away your freedom to
-share and change it. By contrast, the GNU General Public License is intended
-to guarantee your freedom to share and change free software--to make sure the
-software is free for all its users. This General Public License applies to
-most of the Free Software Foundation's software and to any other program
-whose authors commit to using it. (Some other Free Software Foundation
-software is covered by the GNU Library General Public License instead.) You
-can apply it to your programs, too.
-
-When we speak of free software, we are referring to freedom, not price. Our
-General Public Licenses are designed to make sure that you have the freedom
-to distribute copies of free software (and charge for this service if you
-wish), that you receive source code or can get it if you want it, that you
-can change the software or use pieces of it in new free programs; and that
-you know you can do these things.
-
-To protect your rights, we need to make restrictions that forbid anyone to
-deny you these rights or to ask you to surrender the rights. These
-restrictions translate to certain responsibilities for you if you distribute
-copies of the software, or if you modify it.
-
-For example, if you distribute copies of such a program, whether gratis or
-for a fee, you must give the recipients all the rights that you have. You
-must make sure that they, too, receive or can get the source code. And you
-must show them these terms so they know their rights.
-
-We protect your rights with two steps: (1) copyright the software, and (2)
-offer you this license which gives you legal permission to copy, distribute
-and/or modify the software.
-
-Also, for each author's protection and ours, we want to make certain that
-everyone understands that there is no warranty for this free software. If the
-software is modified by someone else and passed on, we want its recipients to
-know that what they have is not the original, so that any problems introduced
-by others will not reflect on the original authors' reputations.
-
-Finally, any free program is threatened constantly by software patents. We
-wish to avoid the danger that redistributors of a free program will
-individually obtain patent licenses, in effect making the program
-proprietary. To prevent this, we have made it clear that any patent must be
-licensed for everyone's free use or not licensed at all.
-
-The precise terms and conditions for copying, distribution and modification
-follow.
-
-
-TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
-===============================================================
-
-1.  This License applies to any program or other work which contains a
-    notice placed by the copyright holder saying it may be distributed under
-    the terms of this General Public License. The "Program", below, refers to
-    any such program or work, and a "work based on the Program" means either
-    the Program or any derivative work under copyright law: that is to say, a
-    work containing the Program or a portion of it, either verbatim or with
-    modifications and/or translated into another language. (Hereinafter,
-    translation is included without limitation in the term "modification".)
-    Each licensee is addressed as "you".
-
-> Activities other than copying, distribution and modification are not
-covered by this License; they are outside its scope. The act of running the
-Program is not restricted, and the output from the Program is covered only if
-its contents constitute a work based on the Program (independent of having
-been made by running the Program). Whether that is true depends on what the
-Program does.
-
-1.  You may copy and distribute verbatim copies of the Program's source
-    code as you receive it, in any medium, provided that you conspicuously
-    and appropriately publish on each copy an appropriate copyright notice
-    and disclaimer of warranty; keep intact all the notices that refer to
-    this License and to the absence of any warranty; and give any other
-    recipients of the Program a copy of this License along with the Program.
-
-> You may charge a fee for the physical act of transferring a copy, and you
-may at your option offer warranty protection in exchange for a fee.
-
-1.  You may modify your copy or copies of the Program or any portion of
-    it, thus forming a work based on the Program, and copy and distribute
-    such modifications or work under the terms of Section 1 above, provided
-    that you also meet all of these conditions:
-
-    > 1.  You must cause the modified files to carry prominent notices
-    stating that you changed the files and the date of any change.
->     2.  You must cause any work that you distribute or publish, that in
-whole or in part contains or is derived from the Program or any part thereof,
-to be licensed as a whole at no charge to all third parties under the terms
-of this License.
->     3.  If the modified program normally reads commands interactively when
-run, you must cause it, when started running for such interactive use in the
-most ordinary way, to print or display an announcement including an
-appropriate copyright notice and a notice that there is no warranty (or else,
-saying that you provide a warranty) and that users may redistribute the
-program under these conditions, and telling the user how to view a copy of
-this License. (Exception: if the Program itself is interactive but does not
-normally print such an announcement, your work based on the Program is not
-required to print an announcement.)
-
-> These requirements apply to the modified work as a whole. If identifiable
-sections of that work are not derived from the Program, and can be reasonably
-considered independent and separate works in themselves, then this License,
-and its terms, do not apply to those sections when you distribute them as
-separate works. But when you distribute the same sections as part of a whole
-which is a work based on the Program, the distribution of the whole must be
-on the terms of this License, whose permissions for other licensees extend to
-the entire whole, and thus to each and every part regardless of who wrote it.
->
-> Thus, it is not the intent of this section to claim rights or contest your
-rights to work written entirely by you; rather, the intent is to exercise the
-right to control the distribution of derivative or collective works based on
-the Program.
->
-> In addition, mere aggregation of another work not based on the Program with
-the Program (or with a work based on the Program) on a volume of a storage or
-distribution medium does not bring the other work under the scope of this
-License.
-
-1.  You may copy and distribute the Program (or a work based on it, under
-    Section 2) in object code or executable form under the terms of Sections
-    1 and 2 above provided that you also do one of the following:
-
-    > 1.  Accompany it with the complete corresponding machine-readable
-    source code, which must be distributed under the terms of Sections 1 and
-    2 above on a medium customarily used for software interchange; or,
->     2.  Accompany it with a written offer, valid for at least three years,
-to give any third party, for a charge no more than your cost of physically
-performing source distribution, a complete machine-readable copy of the
-corresponding source code, to be distributed under the terms of Sections 1
-and 2 above on a medium customarily used for software interchange; or,
->     3.  Accompany it with the information you received as to the offer to
-distribute corresponding source code. (This alternative is allowed only for
-noncommercial distribution and only if you received the program in object
-code or executable form with such an offer, in accord with Subsection b
-above.)
-
-> The source code for a work means the preferred form of the work for making
-modifications to it. For an executable work, complete source code means all
-the source code for all modules it contains, plus any associated interface
-definition files, plus the scripts used to control compilation and
-installation of the executable. However, as a special exception, the source
-code distributed need not include anything that is normally distributed (in
-either source or binary form) with the major components (compiler, kernel,
-and so on) of the operating system on which the executable runs, unless that
-component itself accompanies the executable.
->
-> If distribution of executable or object code is made by offering access to
-copy from a designated place, then offering equivalent access to copy the
-source code from the same place counts as distribution of the source code,
-even though third parties are not compelled to copy the source along with the
-object code.
-
-1.  You may not copy, modify, sublicense, or distribute the Program
-    except as expressly provided under this License. Any attempt otherwise to
-    copy, modify, sublicense or distribute the Program is void, and will
-    automatically terminate your rights under this License. However, parties
-    who have received copies, or rights, from you under this License will not
-    have their licenses terminated so long as such parties remain in full
-    compliance.
-2.  You are not required to accept this License, since you have not
-    signed it. However, nothing else grants you permission to modify or
-    distribute the Program or its derivative works. These actions are
-    prohibited by law if you do not accept this License. Therefore, by
-    modifying or distributing the Program (or any work based on the Program),
-    you indicate your acceptance of this License to do so, and all its terms
-    and conditions for copying, distributing or modifying the Program or
-    works based on it.
-3.  Each time you redistribute the Program (or any work based on the
-    Program), the recipient automatically receives a license from the
-    original licensor to copy, distribute or modify the Program subject to
-    these terms and conditions. You may not impose any further restrictions
-    on the recipients' exercise of the rights granted herein. You are not
-    responsible for enforcing compliance by third parties to this License.
-4.  If, as a consequence of a court judgment or allegation of patent
-    infringement or for any other reason (not limited to patent issues),
-    conditions are imposed on you (whether by court order, agreement or
-    otherwise) that contradict the conditions of this License, they do not
-    excuse you from the conditions of this License. If you cannot distribute
-    so as to satisfy simultaneously your obligations under this License and
-    any other pertinent obligations, then as a consequence you may not
-    distribute the Program at all. For example, if a patent license would not
-    permit royalty-free redistribution of the Program by all those who
-    receive copies directly or indirectly through you, then the only way you
-    could satisfy both it and this License would be to refrain entirely from
-    distribution of the Program.
-
-> If any portion of this section is held invalid or unenforceable under any
-particular circumstance, the balance of the section is intended to apply and
-the section as a whole is intended to apply in other circumstances.
->
-> It is not the purpose of this section to induce you to infringe any patents
-or other property right claims or to contest validity of any such claims;
-this section has the sole purpose of protecting the integrity of the free
-software distribution system, which is implemented by public license
-practices. Many people have made generous contributions to the wide range of
-software distributed through that system in reliance on consistent
-application of that system; it is up to the author/donor to decide if he or
-she is willing to distribute software through any other system and a licensee
-cannot impose that choice.
->
-> This section is intended to make thoroughly clear what is believed to be a
-consequence of the rest of this License.
-
-1.  If the distribution and/or use of the Program is restricted in
-    certain countries either by patents or by copyrighted interfaces, the
-    original copyright holder who places the Program under this License may
-    add an explicit geographical distribution limitation excluding those
-    countries, so that distribution is permitted only in or among countries
-    not thus excluded. In such case, this License incorporates the limitation
-    as if written in the body of this License.
-2.  The Free Software Foundation may publish revised and/or new versions
-    of the General Public License from time to time. Such new versions will
-    be similar in spirit to the present version, but may differ in detail to
-    address new problems or concerns.
-
-> Each version is given a distinguishing version number. If the Program
-specifies a version number of this License which applies to it and "any later
-version", you have the option of following the terms and conditions either of
-that version or of any later version published by the Free Software
-Foundation. If the Program does not specify a version number of this License,
-you may choose any version ever published by the Free Software Foundation.
-
-1.  If you wish to incorporate parts of the Program into other free
-    programs whose distribution conditions are different, write to the author
-    to ask for permission. For software which is copyrighted by the Free
-    Software Foundation, write to the Free Software Foundation; we sometimes
-    make exceptions for this. Our decision will be guided by the two goals of
-    preserving the free status of all derivatives of our free software and of
-    promoting the sharing and reuse of software generally.
-
-NO WARRANTY
-
-1.  BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
-    FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN
-    OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
-    PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER
-    EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
-    WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE
-    ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.
-    SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY
-    SERVICING, REPAIR OR CORRECTION.
-2.  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
-    WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
-    REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR
-    DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL
-    DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING
-    BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
-    LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO
-    OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS
-    BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
-
-END OF TERMS AND CONDITIONS
-
---------
-
-Generated on: 2004-05-29 08:15 UTC. Generated by `Docutils`_ from
-`reStructuredText`_ source.
-
-.. _Docutils: http://docutils.sourceforge.net/
-.. _reStructuredText: http://docutils.sourceforge.net/rst.html

=== removed file 'doc/gnugpl.txt'
--- doc/gnugpl.txt	2014-04-07 20:41:10 +0000
+++ doc/gnugpl.txt	1970-01-01 00:00:00 +0000
@@ -1,339 +0,0 @@
-                    GNU GENERAL PUBLIC LICENSE
-                       Version 2, June 1991
-
- Copyright (C) 1989, 1991 Free Software Foundation, Inc.,
- 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA
- Everyone is permitted to copy and distribute verbatim copies
- of this license document, but changing it is not allowed.
-
-                            Preamble
-
-  The licenses for most software are designed to take away your
-freedom to share and change it.  By contrast, the GNU General Public
-License is intended to guarantee your freedom to share and change free
-software--to make sure the software is free for all its users.  This
-General Public License applies to most of the Free Software
-Foundation's software and to any other program whose authors commit to
-using it.  (Some other Free Software Foundation software is covered by
-the GNU Lesser General Public License instead.)  You can apply it to
-your programs, too.
-
-  When we speak of free software, we are referring to freedom, not
-price.  Our General Public Licenses are designed to make sure that you
-have the freedom to distribute copies of free software (and charge for
-this service if you wish), that you receive source code or can get it
-if you want it, that you can change the software or use pieces of it
-in new free programs; and that you know you can do these things.
-
-  To protect your rights, we need to make restrictions that forbid
-anyone to deny you these rights or to ask you to surrender the rights.
-These restrictions translate to certain responsibilities for you if you
-distribute copies of the software, or if you modify it.
-
-  For example, if you distribute copies of such a program, whether
-gratis or for a fee, you must give the recipients all the rights that
-you have.  You must make sure that they, too, receive or can get the
-source code.  And you must show them these terms so they know their
-rights.
-
-  We protect your rights with two steps: (1) copyright the software, and
-(2) offer you this license which gives you legal permission to copy,
-distribute and/or modify the software.
-
-  Also, for each author's protection and ours, we want to make certain
-that everyone understands that there is no warranty for this free
-software.  If the software is modified by someone else and passed on, we
-want its recipients to know that what they have is not the original, so
-that any problems introduced by others will not reflect on the original
-authors' reputations.
-
-  Finally, any free program is threatened constantly by software
-patents.  We wish to avoid the danger that redistributors of a free
-program will individually obtain patent licenses, in effect making the
-program proprietary.  To prevent this, we have made it clear that any
-patent must be licensed for everyone's free use or not licensed at all.
-
-  The precise terms and conditions for copying, distribution and
-modification follow.
-
-                    GNU GENERAL PUBLIC LICENSE
-   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION
-
-  0. This License applies to any program or other work which contains
-a notice placed by the copyright holder saying it may be distributed
-under the terms of this General Public License.  The "Program", below,
-refers to any such program or work, and a "work based on the Program"
-means either the Program or any derivative work under copyright law:
-that is to say, a work containing the Program or a portion of it,
-either verbatim or with modifications and/or translated into another
-language.  (Hereinafter, translation is included without limitation in
-the term "modification".)  Each licensee is addressed as "you".
-
-Activities other than copying, distribution and modification are not
-covered by this License; they are outside its scope.  The act of
-running the Program is not restricted, and the output from the Program
-is covered only if its contents constitute a work based on the
-Program (independent of having been made by running the Program).
-Whether that is true depends on what the Program does.
-
-  1. You may copy and distribute verbatim copies of the Program's
-source code as you receive it, in any medium, provided that you
-conspicuously and appropriately publish on each copy an appropriate
-copyright notice and disclaimer of warranty; keep intact all the
-notices that refer to this License and to the absence of any warranty;
-and give any other recipients of the Program a copy of this License
-along with the Program.
-
-You may charge a fee for the physical act of transferring a copy, and
-you may at your option offer warranty protection in exchange for a fee.
-
-  2. You may modify your copy or copies of the Program or any portion
-of it, thus forming a work based on the Program, and copy and
-distribute such modifications or work under the terms of Section 1
-above, provided that you also meet all of these conditions:
-
-    a) You must cause the modified files to carry prominent notices
-    stating that you changed the files and the date of any change.
-
-    b) You must cause any work that you distribute or publish, that in
-    whole or in part contains or is derived from the Program or any
-    part thereof, to be licensed as a whole at no charge to all third
-    parties under the terms of this License.
-
-    c) If the modified program normally reads commands interactively
-    when run, you must cause it, when started running for such
-    interactive use in the most ordinary way, to print or display an
-    announcement including an appropriate copyright notice and a
-    notice that there is no warranty (or else, saying that you provide
-    a warranty) and that users may redistribute the program under
-    these conditions, and telling the user how to view a copy of this
-    License.  (Exception: if the Program itself is interactive but
-    does not normally print such an announcement, your work based on
-    the Program is not required to print an announcement.)
-
-These requirements apply to the modified work as a whole.  If
-identifiable sections of that work are not derived from the Program,
-and can be reasonably considered independent and separate works in
-themselves, then this License, and its terms, do not apply to those
-sections when you distribute them as separate works.  But when you
-distribute the same sections as part of a whole which is a work based
-on the Program, the distribution of the whole must be on the terms of
-this License, whose permissions for other licensees extend to the
-entire whole, and thus to each and every part regardless of who wrote it.
-
-Thus, it is not the intent of this section to claim rights or contest
-your rights to work written entirely by you; rather, the intent is to
-exercise the right to control the distribution of derivative or
-collective works based on the Program.
-
-In addition, mere aggregation of another work not based on the Program
-with the Program (or with a work based on the Program) on a volume of
-a storage or distribution medium does not bring the other work under
-the scope of this License.
-
-  3. You may copy and distribute the Program (or a work based on it,
-under Section 2) in object code or executable form under the terms of
-Sections 1 and 2 above provided that you also do one of the following:
-
-    a) Accompany it with the complete corresponding machine-readable
-    source code, which must be distributed under the terms of Sections
-    1 and 2 above on a medium customarily used for software interchange; or,
-
-    b) Accompany it with a written offer, valid for at least three
-    years, to give any third party, for a charge no more than your
-    cost of physically performing source distribution, a complete
-    machine-readable copy of the corresponding source code, to be
-    distributed under the terms of Sections 1 and 2 above on a medium
-    customarily used for software interchange; or,
-
-    c) Accompany it with the information you received as to the offer
-    to distribute corresponding source code.  (This alternative is
-    allowed only for noncommercial distribution and only if you
-    received the program in object code or executable form with such
-    an offer, in accord with Subsection b above.)
-
-The source code for a work means the preferred form of the work for
-making modifications to it.  For an executable work, complete source
-code means all the source code for all modules it contains, plus any
-associated interface definition files, plus the scripts used to
-control compilation and installation of the executable.  However, as a
-special exception, the source code distributed need not include
-anything that is normally distributed (in either source or binary
-form) with the major components (compiler, kernel, and so on) of the
-operating system on which the executable runs, unless that component
-itself accompanies the executable.
-
-If distribution of executable or object code is made by offering
-access to copy from a designated place, then offering equivalent
-access to copy the source code from the same place counts as
-distribution of the source code, even though third parties are not
-compelled to copy the source along with the object code.
-
-  4. You may not copy, modify, sublicense, or distribute the Program
-except as expressly provided under this License.  Any attempt
-otherwise to copy, modify, sublicense or distribute the Program is
-void, and will automatically terminate your rights under this License.
-However, parties who have received copies, or rights, from you under
-this License will not have their licenses terminated so long as such
-parties remain in full compliance.
-
-  5. You are not required to accept this License, since you have not
-signed it.  However, nothing else grants you permission to modify or
-distribute the Program or its derivative works.  These actions are
-prohibited by law if you do not accept this License.  Therefore, by
-modifying or distributing the Program (or any work based on the
-Program), you indicate your acceptance of this License to do so, and
-all its terms and conditions for copying, distributing or modifying
-the Program or works based on it.
-
-  6. Each time you redistribute the Program (or any work based on the
-Program), the recipient automatically receives a license from the
-original licensor to copy, distribute or modify the Program subject to
-these terms and conditions.  You may not impose any further
-restrictions on the recipients' exercise of the rights granted herein.
-You are not responsible for enforcing compliance by third parties to
-this License.
-
-  7. If, as a consequence of a court judgment or allegation of patent
-infringement or for any other reason (not limited to patent issues),
-conditions are imposed on you (whether by court order, agreement or
-otherwise) that contradict the conditions of this License, they do not
-excuse you from the conditions of this License.  If you cannot
-distribute so as to satisfy simultaneously your obligations under this
-License and any other pertinent obligations, then as a consequence you
-may not distribute the Program at all.  For example, if a patent
-license would not permit royalty-free redistribution of the Program by
-all those who receive copies directly or indirectly through you, then
-the only way you could satisfy both it and this License would be to
-refrain entirely from distribution of the Program.
-
-If any portion of this section is held invalid or unenforceable under
-any particular circumstance, the balance of the section is intended to
-apply and the section as a whole is intended to apply in other
-circumstances.
-
-It is not the purpose of this section to induce you to infringe any
-patents or other property right claims or to contest validity of any
-such claims; this section has the sole purpose of protecting the
-integrity of the free software distribution system, which is
-implemented by public license practices.  Many people have made
-generous contributions to the wide range of software distributed
-through that system in reliance on consistent application of that
-system; it is up to the author/donor to decide if he or she is willing
-to distribute software through any other system and a licensee cannot
-impose that choice.
-
-This section is intended to make thoroughly clear what is believed to
-be a consequence of the rest of this License.
-
-  8. If the distribution and/or use of the Program is restricted in
-certain countries either by patents or by copyrighted interfaces, the
-original copyright holder who places the Program under this License
-may add an explicit geographical distribution limitation excluding
-those countries, so that distribution is permitted only in or among
-countries not thus excluded.  In such case, this License incorporates
-the limitation as if written in the body of this License.
-
-  9. The Free Software Foundation may publish revised and/or new versions
-of the General Public License from time to time.  Such new versions will
-be similar in spirit to the present version, but may differ in detail to
-address new problems or concerns.
-
-Each version is given a distinguishing version number.  If the Program
-specifies a version number of this License which applies to it and "any
-later version", you have the option of following the terms and conditions
-either of that version or of any later version published by the Free
-Software Foundation.  If the Program does not specify a version number of
-this License, you may choose any version ever published by the Free Software
-Foundation.
-
-  10. If you wish to incorporate parts of the Program into other free
-programs whose distribution conditions are different, write to the author
-to ask for permission.  For software which is copyrighted by the Free
-Software Foundation, write to the Free Software Foundation; we sometimes
-make exceptions for this.  Our decision will be guided by the two goals
-of preserving the free status of all derivatives of our free software and
-of promoting the sharing and reuse of software generally.
-
-                            NO WARRANTY
-
-  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY
-FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN
-OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES
-PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
-OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
-MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS
-TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE
-PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,
-REPAIR OR CORRECTION.
-
-  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
-WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR
-REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
-INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING
-OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED
-TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY
-YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER
-PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE
-POSSIBILITY OF SUCH DAMAGES.
-
-                     END OF TERMS AND CONDITIONS
-
-            How to Apply These Terms to Your New Programs
-
-  If you develop a new program, and you want it to be of the greatest
-possible use to the public, the best way to achieve this is to make it
-free software which everyone can redistribute and change under these terms.
-
-  To do so, attach the following notices to the program.  It is safest
-to attach them to the start of each source file to most effectively
-convey the exclusion of warranty; and each file should have at least
-the "copyright" line and a pointer to where the full notice is found.
-
-    <one line to give the program's name and a brief idea of what it does.>
-    Copyright (C) <year>  <name of author>
-
-    This program is free software; you can redistribute it and/or modify
-    it under the terms of the GNU General Public License as published by
-    the Free Software Foundation; either version 2 of the License, or
-    (at your option) any later version.
-
-    This program is distributed in the hope that it will be useful,
-    but WITHOUT ANY WARRANTY; without even the implied warranty of
-    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-    GNU General Public License for more details.
-
-    You should have received a copy of the GNU General Public License along
-    with this program; if not, write to the Free Software Foundation, Inc.,
-    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
-
-Also add information on how to contact you by electronic and paper mail.
-
-If the program is interactive, make it output a short notice like this
-when it starts in an interactive mode:
-
-    Gnomovision version 69, Copyright (C) year name of author
-    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.
-    This is free software, and you are welcome to redistribute it
-    under certain conditions; type `show c' for details.
-
-The hypothetical commands `show w' and `show c' should show the appropriate
-parts of the General Public License.  Of course, the commands you use may
-be called something other than `show w' and `show c'; they could even be
-mouse-clicks or menu items--whatever suits your program.
-
-You should also get your employer (if you work as a programmer) or your
-school, if any, to sign a "copyright disclaimer" for the program, if
-necessary.  Here is a sample; alter the names:
-
-  Yoyodyne, Inc., hereby disclaims all copyright interest in the program
-  `Gnomovision' (which makes passes at compilers) written by James Hacker.
-
-  <signature of Ty Coon>, 1 April 1989
-  Ty Coon, President of Vice
-
-This General Public License does not permit incorporating your program into
-proprietary programs.  If your program is a subroutine library, you may
-consider it more useful to permit linking proprietary applications with the
-library.  If this is what you want to do, use the GNU Lesser General
-Public License instead of this License.

=== added file 'doc/mystylesheet'
--- doc/mystylesheet	1970-01-01 00:00:00 +0000
+++ doc/mystylesheet	2015-01-31 08:07:19 +0000
@@ -0,0 +1,585 @@
+
+  # List any fonts you would like to embed in the PDF here
+  embeddedFonts: []
+
+  # Default page setup.  Can be overridden by including other
+  # stylesheets with -s
+
+  pageSetup:
+    size: A4
+    width: null
+    height: null
+    margin-top: 1cm
+    margin-bottom: 1cm
+    margin-left: 1cm
+    margin-right: 1cm
+    margin-gutter: 0cm
+    spacing-header: 5mm
+    spacing-footer: 5mm
+
+    # The first template is one of the 'pageTemplates"
+    # (See next section)
+
+    firstTemplate: oneColumn
+
+  # pageTemplates can be accessed with the .. raw:: pdf PageBreak command
+
+  pageTemplates:
+    coverPage:
+        frames: []
+            [0cm, 0cm, 100%, 100%]
+        showHeader : false
+        showFooter : false
+
+    emptyPage:
+        frames: []
+            [0cm, 0cm, 100%, 100%]
+        showHeader : false
+        showFooter : false
+
+    oneColumn:
+        frames: []
+            [0cm, 0cm, 100%, 100%]
+        showHeader : true
+        showFooter : true
+
+    twoColumn:
+        frames: []
+            [0cm, 0cm, 49%, 100%]
+            [51%, 0cm, 49%, 100%]
+        showHeader : true
+        showFooter : true
+
+    threeColumn:
+        frames: []
+            [2%, 0cm, 29.333%, 100%]
+            [35.333%, 0cm, 29.333%, 100%]
+            [68.666%, 0cm, 29.333%, 100%]
+        showHeader : true
+        showFooter : true
+
+    cutePage:
+        frames: []
+            [0%, 0%, 100%, 100%]
+        showHeader : true
+        showFooter : true
+        defaultFooter : ###Page###
+        defaultHeader : ###Section###
+
+  fontsAlias:
+    stdFont: Helvetica
+    stdBold: Helvetica-Bold
+    stdItalic: Helvetica-Oblique
+    stdBoldItalic: Helvetica-BoldOblique
+    stdSans: Helvetica
+    stdSansBold: Helvetica-Bold
+    stdSansItalic: Helvetica-Oblique
+    stdSansBoldItalic: Helvetica-BoldOblique
+    stdMono: Courier
+    stdMonoItalic: Courier-Oblique
+    stdMonoBold: Courier-Bold
+    stdMonoBoldItalic: Courier-BoldOblique
+    stdSerif: Times-Roman
+
+  linkColor: navy
+
+  styles:
+    base:
+      parent: null
+      fontName: stdFont
+      fontSize: 10
+      leading: 12
+      leftIndent: 0
+      rightIndent: 0
+      firstLineIndent: 0
+      alignment: TA_LEFT
+      spaceBefore: 0
+      spaceAfter: 0
+      bulletFontName: stdFont
+      bulletFontSize: 10
+      bulletIndent: 0
+      textColor: black
+      backColor: null
+      wordWrap: null
+      borderWidth: 0
+      borderPadding: 0
+      borderColor: null
+      borderRadius: null
+      allowWidows: false
+      allowOrphans: false
+      hyphenation: false
+      kerning: false
+      underline: false
+      strike: false
+      commands: []
+
+    normal:
+      parent: base
+
+    title-reference:
+      parent: normal
+      fontName: stdItalic
+
+    bodytext:
+      parent: normal
+      spaceBefore: 6
+      alignment: TA_JUSTIFY
+      hyphenation: true
+
+    toc:
+      parent: normal
+
+    blockquote:
+      parent: bodytext
+      leftIndent: 20
+
+    lineblock:
+      parent: bodytext
+
+    line:
+      parent: lineblock
+      spaceBefore: 0
+
+    toc1:
+      parent: toc
+      fontName: stdBold
+
+    toc2:
+      parent: toc
+      leftIndent: 20
+
+    toc3:
+      parent: toc
+      leftIndent: 40
+
+    toc4:
+      parent: toc
+      leftIndent: 60
+
+    toc5:
+      parent: toc
+      leftIndent: 80
+
+    toc6:
+      parent: toc
+      leftIndent: 100
+
+    toc7:
+      parent: toc
+      leftIndent: 100
+
+    toc8:
+      parent: toc
+      leftIndent: 100
+
+    toc9:
+      parent: toc
+      leftIndent: 100
+
+    toc10:
+      parent: toc
+      leftIndent: 100
+
+    toc11:
+      parent: toc
+      leftIndent: 100
+
+    toc12:
+      parent: toc
+      leftIndent: 100
+
+    toc13:
+      parent: toc
+      leftIndent: 100
+
+    toc14:
+      parent: toc
+      leftIndent: 100
+
+    toc15:
+      parent: toc
+      leftIndent: 100
+
+    footer:
+      parent: normal
+      alignment: TA_CENTER
+
+    header:
+      parent: normal
+      alignment: TA_CENTER
+
+    attribution:
+      parent: bodytext
+      alignment: TA_RIGHT
+
+    image:
+      parent: bodytext
+      alignment: TA_CENTER
+
+    figure:
+      parent: bodytext
+      alignment: TA_CENTER
+      commands: []
+             [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+             [ALIGN, [ 0, 0 ], [ -1, -1 ], CENTER ]
+      colWidths: [100%]
+
+    figure-caption:
+      parent: bodytext
+      fontName: stdItalic
+      alignment: TA_CENTER
+
+    figure-legend:
+      parent: bodytext
+
+    bullet-list:
+      parent: bodytext
+      commands: []
+             [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+             [RIGHTPADDING, [ 0, 0 ], [ 1, -1 ], 0 ]
+      colWidths: ["20", null]
+
+    bullet-list-item:
+      parent: bodytext
+
+    item-list:
+      parent: bodytext
+      commands: []
+             [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+             [RIGHTPADDING, [ 0, 0 ], [ 1, -1 ], 0 ]
+      colWidths: [20pt,null]
+
+    item-list-item:
+      parent: bodytext
+
+    definition-list-term:
+      parent: normal
+      fontName: stdBold
+      spaceBefore: 4
+      spaceAfter: 0
+      keepWithNext: false
+
+    definition-list-classifier:
+      parent: normal
+      fontName: stdItalic
+
+    definition:
+      parent: bodytext
+      firstLineIndent: 0
+      bulletIndent: 0
+      spaceBefore: 0
+      colWidths: [20pt,null]
+      commands: []
+                    [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+                    [LEFTPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+                    [BOTTOMPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+                    [RIGHTPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+                    
+    fieldname:
+      parent: bodytext
+      alignment: TA_RIGHT
+      fontName: stdBold
+
+    fieldvalue:
+      parent: bodytext
+
+    rubric:
+      parent: bodytext
+      textColor: darkred
+      alignment: TA_CENTER
+
+    italic:
+      parent: bodytext
+      fontName: stdItalic
+
+    heading:
+      parent: normal
+      keepWithNext: true
+      spaceBefore: 12
+      spaceAfter: 6
+
+    title:
+      parent: heading
+      fontName: stdBold
+      fontSize: 200%
+      alignment: TA_CENTER
+      keepWithNext: false
+      spaceAfter: 10
+
+    subtitle:
+      parent: title
+      spaceBefore: 12
+      fontSize: 75%
+
+    heading1:
+      parent: heading
+      fontName: stdBold
+      fontSize: 175%
+
+    heading2:
+      parent: heading
+      fontName: stdBold
+      fontSize: 150%
+
+    heading3:
+      parent: heading
+      fontName: stdBoldItalic
+      fontSize: 125%
+
+    heading4:
+      parent: heading
+      fontName: stdBoldItalic
+
+    heading5:
+      parent: heading
+      fontName: stdBoldItalic
+
+    heading6:
+      parent: heading
+      fontName: stdBoldItalic
+
+    topic-title:
+      parent: heading3
+
+    sidebar-title:
+      parent: heading3
+
+    sidebar-subtitle:
+      parent: heading4
+
+    sidebar:
+      float: none
+      width: 100%
+      parent: normal
+      backColor: beige
+      borderColor: darkgray
+      borderPadding: 8
+      borderWidth: 0.5
+
+    admonition:
+      parent: normal
+      spaceBefore: 12
+      spaceAfter: 6
+      borderPadding: [16,16,16,16]
+      backColor: beige
+      borderColor: darkgray
+      borderWidth: 0.5
+      commands:[]
+             [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+
+    attention:
+      parent: admonition
+
+    caution:
+      parent: admonition
+
+    danger:
+      parent: admonition
+
+    error:
+      parent: admonition
+
+    hint:
+      parent: admonition
+
+    important:
+      parent: admonition
+
+    note:
+      parent: admonition
+
+    tip:
+      parent: admonition
+
+    warning:
+      parent: admonition
+
+    admonition-title:
+      parent: heading3
+
+    admonition-heading:
+      parent: heading3
+
+    attention-heading:
+      parent: admonition-heading
+
+    caution-heading:
+      parent: admonition-heading
+
+    danger-heading:
+      parent: admonition-heading
+
+    error-heading:
+      parent: admonition-heading
+
+    hint-heading:
+      parent: admonition-heading
+
+    important-heading:
+      parent: admonition-heading
+
+    note-heading:
+      parent: admonition-heading
+
+    tip-heading:
+      parent: admonition-heading
+
+    warning-heading:
+      parent: admonition-heading
+
+    literal:
+      parent: normal
+      fontName: stdMono
+      firstLineIndent: 0
+      hyphenation: false
+      wordWrap: null
+
+    aafigure:
+      parent: literal
+
+    table:
+      spaceBefore:6
+      spaceAfter:0
+      alignment: TA_CENTER
+      commands: []
+             [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+             [INNERGRID, [ 0, 0 ], [ -1, -1 ], 0.25, black ]
+             [ROWBACKGROUNDS, [0, 0], [-1, -1], [white,#E0E0E0]]
+             [BOX, [ 0, 0 ], [ -1, -1 ], 0.25, black ]
+
+    table-title:
+      parent : heading4
+      keepWithNext: false
+      alignment : TA_CENTER
+
+    table-heading:
+      parent : heading
+      backColor : beige
+      alignment : TA_CENTER
+      valign : BOTTOM
+      borderPadding : 0
+
+    table-body:
+      parent : normal
+
+    dedication:
+      parent : normal
+
+    abstract:
+      parent : normal
+
+    contents:
+      parent : normal
+
+    tableofcontents:
+      parent : normal
+
+    code:
+      parent: literal
+      leftIndent: 0
+      spaceBefore: 8
+      spaceAfter: 8
+      backColor: beige
+      borderColor: darkgray
+      borderWidth: 0.5
+      borderPadding: 6
+
+    linenumber:
+      parent: code
+
+    right:
+      parent: bodytext
+      alignment: right
+
+    center:
+      parent: bodytext
+      alignment: center
+
+    pygments-n: parent: code
+    pygments-nx: parent: code
+    pygments-p: parent: code
+    pygments-hll: {parent: code, backColor: #ffffcc}
+    pygments-c: {textColor: #008800, parent: code}
+    pygments-err: {parent: code}
+    pygments-k: {textColor: #AA22FF, parent: code}
+    pygments-o: {textColor: #666666, parent: code}
+    pygments-cm: {textColor: #008800, parent: code}
+    pygments-cp: {textColor: #008800, parent: code}
+    pygments-c1: {textColor: #008800, parent: code}
+    pygments-cs: {textColor: #008800, parent: code}
+    pygments-gd: {textColor: #A00000, parent: code}
+    pygments-ge: {parent: code}
+    pygments-gr: {textColor: #FF0000, parent: code}
+    pygments-gh: {textColor: #000080, parent: code}
+    pygments-gi: {textColor: #00A000, parent: code}
+    pygments-go: {textColor: #808080, parent: code}
+    pygments-gp: {textColor: #000080, parent: code}
+    pygments-gs: {parent: code}
+    pygments-gu: {textColor: #800080, parent: code}
+    pygments-gt: {textColor: #0040D0, parent: code}
+    pygments-kc: {textColor: #AA22FF, parent: code}
+    pygments-kd: {textColor: #AA22FF, parent: code}
+    pygments-kn: {textColor: #AA22FF, parent: code}
+    pygments-kp: {textColor: #AA22FF, parent: code}
+    pygments-kr: {textColor: #AA22FF, parent: code}
+    pygments-kt: {textColor: #00BB00, parent: code}
+    pygments-m: {textColor: #666666, parent: code}
+    pygments-s: {textColor: #BB4444, parent: code}
+    pygments-na: {textColor: #BB4444, parent: code}
+    pygments-nb: {textColor: #AA22FF, parent: code}
+    pygments-nc: {textColor: #0000FF, parent: code}
+    pygments-no: {textColor: #880000, parent: code}
+    pygments-nd: {textColor: #AA22FF, parent: code}
+    pygments-ni: {textColor: #999999, parent: code}
+    pygments-ne: {textColor: #D2413A, parent: code}
+    pygments-nf: {textColor: #00A000, parent: code}
+    pygments-nl: {textColor: #A0A000, parent: code}
+    pygments-nn: {textColor: #0000FF, parent: code}
+    pygments-nt: {textColor: #008000, parent: code}
+    pygments-nv: {textColor: #B8860B, parent: code}
+    pygments-ow: {textColor: #AA22FF, parent: code}
+    pygments-w: {textColor: #bbbbbb, parent: code}
+    pygments-mf: {textColor: #666666, parent: code}
+    pygments-mh: {textColor: #666666, parent: code}
+    pygments-mi: {textColor: #666666, parent: code}
+    pygments-mo: {textColor: #666666, parent: code}
+    pygments-sb: {textColor: #BB4444, parent: code}
+    pygments-sc: {textColor: #BB4444, parent: code}
+    pygments-sd: {textColor: #BB4444, parent: code}
+    pygments-s2: {textColor: #BB4444, parent: code}
+    pygments-se: {textColor: #BB6622, parent: code}
+    pygments-sh: {textColor: #BB4444, parent: code}
+    pygments-si: {textColor: #BB6688, parent: code}
+    pygments-sx: {textColor: #008000, parent: code}
+    pygments-sr: {textColor: #BB6688, parent: code}
+    pygments-s1: {textColor: #BB4444, parent: code}
+    pygments-ss: {textColor: #B8860B, parent: code}
+    pygments-bp: {textColor: #AA22FF, parent: code}
+    pygments-vc: {textColor: #B8860B, parent: code}
+    pygments-vg: {textColor: #B8860B, parent: code}
+    pygments-vi: {textColor: #B8860B, parent: code}
+    pygments-il: {textColor: #666666, parent: code}
+
+    endnote:
+        parent: bodytext
+        commands: []
+            [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+            [TOPPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+            [BOTTOMPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+            [RIGHTPADDING, [ 0, 0 ], [ 1, -1 ], 0 ]
+        colWidths: [3cm, null]
+
+    field-list:
+        parent: bodytext
+        commands: []
+            [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+            [TOPPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+        colWidths: [3cm, null]
+        spaceBefore: 6
+
+    option-list:
+        commands: []
+            [VALIGN, [ 0, 0 ], [ -1, -1 ], TOP ]
+            [TOPPADDING, [ 0, 0 ], [ -1, -1 ], 0 ]
+        colWidths: [null,null]
+

=== modified file 'drs/dr1010.py'
--- drs/dr1010.py	2016-02-27 13:18:41 +0000
+++ drs/dr1010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr1020.py'
--- drs/dr1020.py	2016-02-27 13:18:41 +0000
+++ drs/dr1020.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'drs/dr2010.py'
--- drs/dr2010.py	2016-05-21 12:42:32 +0000
+++ drs/dr2010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr2020.py'
--- drs/dr2020.py	2016-05-26 08:05:22 +0000
+++ drs/dr2020.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr2030.py'
--- drs/dr2030.py	2016-05-21 12:42:32 +0000
+++ drs/dr2030.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'drs/dr3010.py'
--- drs/dr3010.py	2016-05-21 12:42:32 +0000
+++ drs/dr3010.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3020.py'
--- drs/dr3020.py	2016-05-21 12:42:32 +0000
+++ drs/dr3020.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3030.py'
--- drs/dr3030.py	2016-02-27 13:18:41 +0000
+++ drs/dr3030.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3040.py'
--- drs/dr3040.py	2016-02-27 13:18:41 +0000
+++ drs/dr3040.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3050.py'
--- drs/dr3050.py	2016-09-03 14:07:52 +0000
+++ drs/dr3050.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3060.py'
--- drs/dr3060.py	2016-02-27 13:18:41 +0000
+++ drs/dr3060.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -132,7 +132,7 @@
 
     def printReport(self, recs):
         p = ProgressBar(self.opts["mf"].body, mxs=len(recs), esc=True)
-        self.head = ("%03u %-30s %145s %6s" % \
+        self.head = ("%03u %-30s %141s %6s" % \
             (self.opts["conum"], self.opts["conam"], self.sysdttm, __name__))
         self.fpdf = MyFpdf(name=__name__, head=self.head)
         self.pgnum = 0
@@ -162,7 +162,6 @@
                 email = dat[col.index("drm_sls_email")].split(",")
             nameml = CCD("%s <%s>" % (contact, email[0]), "NA", 40)
             delv = CCD(dat[col.index("drm_delivery")], "Na", 7)
-            area = CCD(dat[col.index("drm_area")], "NA", 3)
             rep = CCD(dat[col.index("drm_rep")], "Na", 3)
             bact = CCD(dat[col.index("drm_bus_activity")], "UA", 3)
             btyp = CCD(dat[col.index("drm_bus_type")], "UA", 3)
@@ -172,12 +171,11 @@
             limit = CCD(dat[col.index("drm_limit")], "UI", 7)
             if self.pglin > self.fpdf.lpp:
                 self.pageHeading()
-            self.fpdf.drawText("%s %s %s %s %s %s %s %s %s %s %s %s %s "\
+            self.fpdf.drawText("%s %s %s %s %s %s %s %s %s %s %s %s "\
                 "%s %s %s %s" % (chn.disp, acno.disp, name.disp,
                 add1.disp, pcod.disp, tel.disp, fax.disp, nameml.disp,
-                delv.disp, area.disp, rep.disp, bact.disp,
-                btyp.disp, prices.disp, rfterm.disp, rjterm.disp,
-                limit.disp))
+                delv.disp, rep.disp, bact.disp, btyp.disp, prices.disp,
+                rfterm.disp, rjterm.disp, limit.disp))
             if self.address == "Y" and add2.work:
                 self.fpdf.drawText("%42s %-30s" % ("", add2.disp))
                 self.pglin += 1
@@ -190,8 +188,8 @@
             pdfnam = getModName(self.opts["mf"].rcdic["wrkdir"], __name__,
                 self.opts["conum"], ext="pdf")
             self.fpdf.output(pdfnam, "F")
-            doPrinter(mf=self.opts["mf"], conum=self.opts["conum"], pdfnam=pdfnam,
-                head=self.tit, repprt=self.df.repprt,
+            doPrinter(mf=self.opts["mf"], conum=self.opts["conum"],
+                pdfnam=pdfnam, head=self.tit, repprt=self.df.repprt,
                 repeml=self.df.repeml)
 
     def pageHeading(self):
@@ -200,7 +198,7 @@
         self.pgnum += 1
         self.fpdf.drawText(self.head)
         self.fpdf.drawText()
-        self.fpdf.drawText("%-32s %-10s %137s %5s" % \
+        self.fpdf.drawText("%-32s %-10s %133s %5s" % \
             ("Debtors Ledger Master List as at", self.sysdtd,
                 "Page", self.pgnum))
         self.fpdf.drawText()
@@ -214,9 +212,9 @@
         else:
             det = "Orders Contact Details"
         self.fpdf.drawText("%-3s %-7s %-30s %-30s %-4s %-12s %-12s %-40s "\
-            "%-7s %-3s %-3s %-3s %-3s %1s %-3s %-3s %-7s" % ("Chn", "Acc-Num",
+            "%-7s %-3s %-3s %-3s %1s %-3s %-3s %-7s" % ("Chn", "Acc-Num",
             "Name", "Address", "Code", "Tel-Number", "Fax-Number", "%s" % det,
-            "Deliver", "Are", "Rep", "Act", "Typ", "P", "Rft","Rjt","C-Limit"))
+            "Deliver", "Rep", "Act", "Typ", "P", "Rft","Rjt","C-Limit"))
         self.fpdf.underLine(txt=self.head)
         self.fpdf.setFont()
         self.pglin = 8

=== modified file 'drs/dr3080.py'
--- drs/dr3080.py	2016-02-27 13:18:41 +0000
+++ drs/dr3080.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3090.py'
--- drs/dr3090.py	2016-02-27 13:18:41 +0000
+++ drs/dr3090.py	2017-01-28 08:53:11 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3100.py'
--- drs/dr3100.py	2016-02-27 13:18:41 +0000
+++ drs/dr3100.py	2017-02-21 12:51:42 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'drs/dr3110.py'
--- drs/dr3110.py	2016-11-07 16:11:53 +0000
+++ drs/dr3110.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3120.py'
--- drs/dr3120.py	2016-02-27 13:18:41 +0000
+++ drs/dr3120.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr4010.py'
--- drs/dr4010.py	2016-06-22 08:28:55 +0000
+++ drs/dr4010.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr6010.py'
--- drs/dr6010.py	2016-02-27 13:18:41 +0000
+++ drs/dr6010.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'drs/dr6020.py'
--- drs/dr6020.py	2016-02-27 13:18:41 +0000
+++ drs/dr6020.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr6030.py'
--- drs/dr6030.py	2016-02-27 13:18:41 +0000
+++ drs/dr6030.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc110.py'
--- drs/drc110.py	2016-02-27 13:18:41 +0000
+++ drs/drc110.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc210.py'
--- drs/drc210.py	2016-02-27 13:18:41 +0000
+++ drs/drc210.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'drs/drc220.py'
--- drs/drc220.py	2016-02-27 13:18:41 +0000
+++ drs/drc220.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc310.py'
--- drs/drc310.py	2016-02-27 13:18:41 +0000
+++ drs/drc310.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc320.py'
--- drs/drc320.py	2016-02-27 13:18:41 +0000
+++ drs/drc320.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc410.py'
--- drs/drc410.py	2016-02-27 13:18:41 +0000
+++ drs/drc410.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc420.py'
--- drs/drc420.py	2016-02-27 13:18:41 +0000
+++ drs/drc420.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, Sql, TartanDialog

=== modified file 'drs/drc510.py'
--- drs/drc510.py	2016-02-27 13:18:41 +0000
+++ drs/drc510.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc520.py'
--- drs/drc520.py	2016-02-27 13:18:41 +0000
+++ drs/drc520.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc610.py'
--- drs/drc610.py	2016-02-27 13:18:41 +0000
+++ drs/drc610.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc710.py'
--- drs/drc710.py	2016-02-27 13:18:41 +0000
+++ drs/drc710.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl1010.py'
--- gen/gl1010.py	2016-07-10 11:57:24 +0000
+++ gen/gl1010.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import csv, os, time

=== modified file 'gen/gl1020.py'
--- gen/gl1020.py	2016-02-27 13:18:41 +0000
+++ gen/gl1020.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, Sql, TartanDialog

=== modified file 'gen/gl1030.py'
--- gen/gl1030.py	2016-11-07 16:11:53 +0000
+++ gen/gl1030.py	2017-01-28 08:53:12 +0000
@@ -13,7 +13,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'gen/gl1040.py'
--- gen/gl1040.py	2016-02-27 13:18:41 +0000
+++ gen/gl1040.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl1050.py'
--- gen/gl1050.py	2016-07-10 11:57:24 +0000
+++ gen/gl1050.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'gen/gl1060.py'
--- gen/gl1060.py	2016-02-27 13:18:41 +0000
+++ gen/gl1060.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'gen/gl2010.py'
--- gen/gl2010.py	2016-02-27 13:18:41 +0000
+++ gen/gl2010.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, FileImport, Sql, TartanDialog

=== modified file 'gen/gl2020.py'
--- gen/gl2020.py	2016-09-03 14:07:52 +0000
+++ gen/gl2020.py	2017-01-28 08:53:12 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, CCD, FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl2030.py'
--- gen/gl2030.py	2016-05-21 12:42:32 +0000
+++ gen/gl2030.py	2017-01-28 08:53:12 +0000
@@ -24,7 +24,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl2040.py'
--- gen/gl2040.py	2016-06-22 08:28:55 +0000
+++ gen/gl2040.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -1225,7 +1225,7 @@
             # Loans Ledger Masterfile
             self.sql.insRec("lonmf2", data=[self.allcoy, self.lonacc,
                 self.lonnum, self.londes, self.trndat, self.lonmth,
-                self.lonpay])
+                self.lonpay, 0])
         # Loans Ledger Transaction
         data = [self.allcoy, self.lonacc, self.lonnum, self.bh.batno,
             self.othrtn, self.trndat, self.trnref, self.othamt, self.curdt,
@@ -1401,8 +1401,12 @@
             self.df.clearFrame("C", self.crspag)
         elif self.others == "drs":
             self.df.clearFrame("C", self.drspag)
-        else:
+        elif self.others == "lon":
+            self.df.clearFrame("C", self.lonpag)
+        elif self.others == "mem":
             self.df.clearFrame("C", self.mempag)
+        elif self.others == "sln":
+            self.df.clearFrame("C", self.slnpag)
         self.df.selPage("Transaction")
         self.df.advanceLine(1)
 

=== modified file 'gen/gl2050.py'
--- gen/gl2050.py	2016-05-21 12:42:32 +0000
+++ gen/gl2050.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3010.py'
--- gen/gl3010.py	2016-02-27 13:18:41 +0000
+++ gen/gl3010.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3020.py'
--- gen/gl3020.py	2016-05-21 12:42:32 +0000
+++ gen/gl3020.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -381,8 +381,8 @@
             self.typeTotal()
             self.grandTotal()
             self.fpdf.output(pdfnam, "F")
-            doPrinter(mf=self.opts["mf"], conum=self.opts["conum"], pdfnam=pdfnam,
-                head=self.tit, repprt=self.df.repprt,
+            doPrinter(mf=self.opts["mf"], conum=self.opts["conum"],
+                pdfnam=pdfnam, head=self.tit, repprt=self.df.repprt,
                 repeml=self.df.repeml)
 
     def getValues(self, data):

=== modified file 'gen/gl3030.py'
--- gen/gl3030.py	2016-02-27 13:18:41 +0000
+++ gen/gl3030.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 import time
 from TartanClasses import ASD, CCD, MyFpdf, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl3040.py'
--- gen/gl3040.py	2016-02-27 13:18:41 +0000
+++ gen/gl3040.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3050.py'
--- gen/gl3050.py	2016-12-30 14:10:51 +0000
+++ gen/gl3050.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'gen/gl3060.py'
--- gen/gl3060.py	2016-02-27 13:18:41 +0000
+++ gen/gl3060.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, TartanDialog

=== modified file 'gen/gl3070.py'
--- gen/gl3070.py	2016-02-27 13:18:41 +0000
+++ gen/gl3070.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'gen/gl3080.py'
--- gen/gl3080.py	2016-02-27 13:18:41 +0000
+++ gen/gl3080.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3090.py'
--- gen/gl3090.py	2016-02-27 13:18:41 +0000
+++ gen/gl3090.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, Sql, TartanDialog

=== modified file 'gen/gl3100_rne.py'
--- gen/gl3100_rne.py	2016-02-27 13:18:41 +0000
+++ gen/gl3100_rne.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy

=== modified file 'gen/gl3110_rne.py'
--- gen/gl3110_rne.py	2016-02-27 13:18:41 +0000
+++ gen/gl3110_rne.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, MyFpdf, Sql, TartanDialog

=== modified file 'gen/gl3130_rne.py'
--- gen/gl3130_rne.py	2016-12-30 14:10:51 +0000
+++ gen/gl3130_rne.py	2017-02-21 09:49:19 +0000
@@ -4,6 +4,15 @@
 
     This file is part of Tartan Financial Systems (TARTAN).
 
+    rtyp: A - Sales Report
+          B - Sales Summary
+          C - Stock Report
+          D - Gross Profit
+          E - Gross Profit %tages
+          F - Gross Profit Charts
+          G - Net Profit
+          H - Net Profit %tages
+
 AUTHOR
     Written by Paul Malherbe, <paul@tartan.co.za>
 
@@ -448,7 +457,7 @@
         # Branches
         txt = "Generating Sales Reports"
         exc = [("gqb_bcod", "<>", 999)]
-        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_bcod")
+        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_name")
         pb = ProgressBar(self.opts["mf"].body, mxs=len(bchs), typ=txt)
         datas = {}
         for num, bch in enumerate(bchs):
@@ -646,7 +655,7 @@
         while len(self.deps) < 14:
             self.deps.insert(len(self.deps) - 1, "")
         exc = [("gqb_bcod", "<>", 999)]
-        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_bcod")
+        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_name")
         # Fpdf
         size = 12 + (22 * 7)
         self.fpdf.def_orientation = "L"
@@ -680,7 +689,7 @@
                 self.head = False
                 self.doHead()
             for bch in bchs:
-                self.fpdf.drawText(bch[1], w=12*self.fpdf.cwth,
+                self.fpdf.drawText(bch[1], w=13*self.fpdf.cwth,
                     h=4, font="B", border="TLRNB", ln=0)
                 self.fpdf.setFont("")
                 for num, dep in enumerate(self.deps[seq:end]):
@@ -722,7 +731,7 @@
                         self.fpdf.drawText(per, w=9*self.fpdf.cwth, h=4,
                             align="C", border="TLRB", ln=l)
             self.fpdf.drawText("")
-            self.fpdf.drawText("Totals", w=12*self.fpdf.cwth,
+            self.fpdf.drawText("Totals", w=13*self.fpdf.cwth,
                 h=4, font="B", border="TLRNB", ln=0)
             self.fpdf.setFont("")
             for num, dep in enumerate(deps):
@@ -752,15 +761,16 @@
                         align="C", border="TLRB", ln=ln)
 
     def doStockVal(self):
-        self.dat1 = []
-        self.dat2 = {}
-        self.dat3 = {}
+        self.dat1 = []  # Stock report: [bcd, bnm, coy, nam, ost, pur, sls,
+                        # slc, inc, adv, stk, cst, stt, alw, dif, wag, per])
+        self.dat2 = {}  # GP report: {bcd: [bnm, {dep: [prf, sls] ...}] ...}
+        self.dat3 = {}  # NP report: {bcd: [bnm, {dep: [prf, sls] ...}] ...}
         txt = "Generating Stock Values"
         exc = [("gqb_bcod", "<>", 999)]
         sdt = (self.sper * 100) + 1
         edt = mthendDate((self.rper * 100) + 1)
         mths = dateDiff(sdt, edt, "months") + 1
-        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_bcod")
+        bchs = self.sql.getRec(tables="genqrb", where=exc, order="gqb_name")
         recs = self.sql.getRec(tables="genqrc", where=[("gqc_gprp", "=", "Y")])
         deps = []
         for rec in recs:
@@ -770,8 +780,8 @@
             pb.displayProgress(num)
             bcd = bch[0]
             bnm = bch[1]
-            self.dat2[bcd] = [bnm, {}]
-            self.dat3[bcd] = [bnm, {}]
+            self.dat2[bnm] = [bcd, {}]
+            self.dat3[bnm] = [bcd, {}]
             qrd = self.sql.getRec(tables="genqrd", where=[("gqd_bcod",
                 "=", bcd)], order="gqd_dcod")
             for q in qrd:
@@ -803,19 +813,19 @@
                 if sls and cst and dep in deps:
                     prf = sls + cst + inc + adv - ost - pur
                     if prf <= sls:
-                        if not dep in self.dat2[bcd][1]:
-                            self.dat2[bcd][1][dep] = [prf, sls]
+                        if not dep in self.dat2[bnm][1]:
+                            self.dat2[bnm][1][dep] = [prf, sls]
                         else:
-                            self.dat2[bcd][1][dep][0] += prf
-                            self.dat2[bcd][1][dep][1] += sls
+                            self.dat2[bnm][1][dep][0] += prf
+                            self.dat2[bnm][1][dep][1] += sls
                 # Net Profit
                 if not cst:
                     npr = float(ASD(npr) + ASD(stk))
-                if not dep in self.dat3[bcd][1]:
-                    self.dat3[bcd][1][dep] = [npr, sls]
+                if not dep in self.dat3[bnm][1]:
+                    self.dat3[bnm][1][dep] = [npr, sls]
                 else:
-                    self.dat3[bcd][1][dep][0] += npr
-                    self.dat3[bcd][1][dep][1] += sls
+                    self.dat3[bnm][1][dep][0] += npr
+                    self.dat3[bnm][1][dep][1] += sls
         pb.closeProgress()
 
     def getVals(self, coy, per):
@@ -931,7 +941,7 @@
 
     def doGProfits(self):
         bchs = self.dat2.keys()
-        bchs.sort()
+        bchs.sort(key=str.lower)
         dpss = []
         for bch in bchs:
             for dep in self.dat2[bch][1].keys():
@@ -947,19 +957,21 @@
             ("gqp_dcod", "in", dpss),
             ("gqp_rate", "<>", 0),
             ("gqc_dcod=gqp_dcod",)]
-        odr = "gqp_dcod"
+        odr = "gqc_name"
         deps = self.sql.getRec(tables=tab, cols=col, where=whr, order=odr)
-        self.col4 = {"D": [], "E": []}
-        self.col4["D"] = [["NA", 12, "Branch"]]
-        self.col4["E"] = [["NA", 12, "Branch\nTarget%"]]
+        self.col4 = {
+            "D": [["NA", 13, "Branch"]],
+            "E": [["NA", 13, "Branch\nTarget%"]]}
         self.dat4 = {}
         size = 12
         for dep in deps:
-            self.col4["D"].append(["SD",12.2,"%s" % dep[1]])
+            self.col4["D"].append(["NA",12,"%s" % dep[1]])
             dsc = CCD(dep[2], "SD", 6.2).disp
-            self.col4["E"].append(["SD",12.2,"%s\n%s%s" % (dep[1], dsc, "%")])
+            self.col4["E"].append(["NA",12,"%s\n%s%s" % (dep[1], dsc, "%")])
             self.dat4[dep[0]] = [dep[1], dep[2], {}]
             size += 12
+        self.col4["D"].append(["NA",12,"%s" % "Totals"])
+        size += 12
         for self.rtyp in ("D", "E"):
             self.fpdf.def_orientation = "L"
             self.fpdf.setValues("gl3130", size, font="courier")
@@ -978,12 +990,14 @@
                         prt = True
                 if not prt:
                     continue
-                b = CCD(self.dat2[bch][0], "NA", 12).disp
-                w = 12 * self.fpdf.cwth
+                b = CCD(bch, "NA", 12).disp
+                w = 13 * self.fpdf.cwth
                 self.fpdf.drawText(b, w=w, h=4, border="TLRB", ln=0)
+                if self.rtyp == "D":
+                    btot = 0
                 for dep in deps:
                     w = 12 * self.fpdf.cwth
-                    if dep == deps[-1]:
+                    if self.rtyp == "E" and dep == deps[-1]:
                         l = 1
                     else:
                         l = 0
@@ -991,6 +1005,7 @@
                         val = self.dat2[bch][1][dep[0]]
                         if self.rtyp == "D":
                             t = CCD(val[0], "SI", 12).disp
+                            btot = float(ASD(btot) + ASD(val[0]))
                         else:
                             if val[1]:
                                 gp = round(val[0] * 100.0 / val[1], 2)
@@ -1002,14 +1017,18 @@
                             else:
                                 t = t.disp + "%"
                             self.dat4[dep[0]][2][b.strip()] = gp
-                        if not dep[0] in tots:
-                            tots[dep[0]] = [0, 0]
-                        tots[dep[0]][0] += val[0]
-                        tots[dep[0]][1] += val[1]
+                        if not dep[1] in tots:
+                            tots[dep[1]] = [0, 0]
+                        tots[dep[1]][0] += val[0]
+                        tots[dep[1]][1] += val[1]
                     else:
                         t = ""
                     self.fpdf.drawText(t, w=w, h=4, align="C",
                         border="TLRB", ln=l)
+                if self.rtyp == "D":
+                    t = CCD(btot, "SI", 12).disp
+                    self.fpdf.drawText(t, w=w, h=4, align="C",
+                        border="TLRB", ln=1)
             pb.closeProgress()
             self.doTotal(tots)
         self.doGPCht()
@@ -1036,7 +1055,7 @@
 
     def doNProfits(self):
         bchs = self.dat3.keys()
-        bchs.sort()
+        bchs.sort(key=str.lower)
         dpss = []
         for bch in bchs:
             for dep in self.dat3[bch][1].keys():
@@ -1045,15 +1064,20 @@
         tab = ["genqrc"]
         col = ["gqc_dcod", "gqc_name"]
         whr = [("gqc_dcod", "in", dpss)]
-        odr = "gqc_dcod"
+        odr = "gqc_name"
         deps = self.sql.getRec(tables=tab, cols=col, where=whr, order=odr)
-        self.col5 = [["NA", 12, "Branch"]]
+        self.col5 = {
+            "G": [["NA", 13, "Branch"]],
+            "H": [["NA", 13, "Branch"]]}
         self.dat5 = {}
         size = 12
         for dep in deps:
-            self.col5.append(["SD",12.2,dep[1]])
+            self.col5["G"].append(["NA",12,"%s" % dep[1]])
+            self.col5["H"].append(["NA",12,"%s" % dep[1]])
             self.dat5[dep[0]] = [dep[1], {}]
             size += 12
+        self.col5["G"].append(["NA",12,"%s" % "Totals"])
+        size += 12
         for self.rtyp in ("G", "H"):
             self.fpdf.def_orientation = "L"
             self.fpdf.setValues("gl3130", size, font="courier")
@@ -1072,12 +1096,14 @@
                         prt = True
                 if not prt:
                     continue
-                b = CCD(self.dat3[bch][0], "NA", 12).disp
-                w = 12 * self.fpdf.cwth
+                b = CCD(bch, "NA", 12).disp
+                w = 13 * self.fpdf.cwth
                 self.fpdf.drawText(b, w=w, h=4, border="TLRB", ln=0)
+                if self.rtyp == "G":
+                    btot = 0
                 for dep in deps:
                     w = 12 * self.fpdf.cwth
-                    if dep == deps[-1]:
+                    if self.rtyp == "H" and dep == deps[-1]:
                         l = 1
                     else:
                         l = 0
@@ -1085,6 +1111,7 @@
                         val = self.dat3[bch][1][dep[0]]
                         if self.rtyp == "G":
                             t = CCD(val[0], "SI", 12).disp
+                            btot = float(ASD(btot) + ASD(val[0]))
                         else:
                             if val[1]:
                                 gp = round(val[0] * 100.0 / val[1], 2)
@@ -1096,14 +1123,18 @@
                             else:
                                 t = t.disp + "%"
                             self.dat5[dep[0]][1][b.strip()] = gp
-                        if not dep[0] in tots:
-                            tots[dep[0]] = [0, 0]
-                        tots[dep[0]][0] += val[0]
-                        tots[dep[0]][1] += val[1]
+                        if not dep[1] in tots:
+                            tots[dep[1]] = [0, 0]
+                        tots[dep[1]][0] += val[0]
+                        tots[dep[1]][1] += val[1]
                     else:
                         t = ""
                     self.fpdf.drawText(t, w=w, h=4, align="C",
                         border="TLRB", ln=l)
+                if self.rtyp == "G":
+                    t = CCD(btot, "SI", 12).disp
+                    self.fpdf.drawText(t, w=w, h=4, align="C",
+                        border="TLRB", ln=1)
             pb.closeProgress()
             self.doTotal(tots)
 
@@ -1133,7 +1164,7 @@
         elif self.rtyp == "B":
             if self.head:
                 seq = 1
-                head = "Group Sales Summary as at %s (Thousands)" % self.rperd
+                head = "Group Sales Summary for %s (Thousands)" % self.rperd
                 self.fpdf.drawText(head, align="C", font=("B", 14))
                 self.fpdf.drawText()
             else:
@@ -1142,7 +1173,7 @@
                 self.fpdf.drawText()
                 self.fpdf.drawText()
             self.fpdf.setFont(font[0], "B", font[1])
-            self.fpdf.drawText("Branch", w=12*self.fpdf.cwth, h=5,
+            self.fpdf.drawText("Branch", w=13*self.fpdf.cwth, h=5,
                 border="TLRB", fill=True, ln=0)
             for x in range(7):
                 if x == 6:
@@ -1213,9 +1244,9 @@
             x = self.fpdf.get_x()
             y = self.fpdf.get_y()
             self.fpdf.setFont(font[0], "B", font[1])
-            for num, col in enumerate(self.col5):
+            for num, col in enumerate(self.col5[self.rtyp]):
                 w = int(col[1]) * self.fpdf.cwth
-                if col == self.col5[-1]:
+                if col == self.col5[self.rtyp][-1]:
                     l = 1
                 else:
                     l = 0
@@ -1252,45 +1283,69 @@
             w = (self.col2[14][1] + 1) * self.fpdf.cwth
             self.fpdf.drawText(t, w=w)
         elif self.rtyp in ("D", "E"):
-            w = 12 * self.fpdf.cwth
+            w = 13 * self.fpdf.cwth
             b = "TLRB"
             f = True
             self.fpdf.setFont(font[0], "B", font[1])
             if self.rtyp == "D":
-                txt = "Average GP "
+                gtot = 0
+                txt = "Total GP "
             else:
                 txt = "Average GP%"
             self.fpdf.drawText(txt, w=w, h=5, border=b, fill=f, ln=0)
-            for dep in data:
+            keys = data.keys()
+            keys.sort()
+            for dep in keys:
                 w = 12 * self.fpdf.cwth
                 if self.rtyp == "D":
+                    l = 0
                     txt = CCD(data[dep][0], "SI", 12).disp
+                    gtot = float(ASD(gtot) + ASD(data[dep][0]))
                 else:
+                    if dep == keys[-1]:
+                        l = 1
+                    else:
+                        l = 0
                     gp = CCD(round(data[dep][0] * 100.0 / data[dep][1], 2),
                         "SD", 6.2).disp
                     txt = "%s%s" % (gp, "%")
-                self.fpdf.drawText(txt, w=w, h=5, align="C", border=b, fill=f,
-                    ln=0)
+                self.fpdf.drawText(txt, w=w, h=5, align="C", border=b,
+                    fill=f, ln=l)
+            if self.rtyp == "D":
+                txt = CCD(gtot, "SI", 12).disp
+                self.fpdf.drawText(txt, w=w, h=5, align="C", border=b, fill=f)
         elif self.rtyp in ("G", "H"):
-            w = 12 * self.fpdf.cwth
+            w = 13 * self.fpdf.cwth
             b = "TLRB"
             f = True
             self.fpdf.setFont(font[0], "B", font[1])
             if self.rtyp == "G":
-                txt = "Average NP"
+                gtot = 0
+                txt = "Total NP"
             else:
                 txt = "Average NP%"
             self.fpdf.drawText(txt, w=w, h=5, border=b, fill=f, ln=0)
-            for dep in data:
+            keys = data.keys()
+            keys.sort()
+            for dep in keys:
                 w = 12 * self.fpdf.cwth
                 if self.rtyp == "G":
+                    l = 0
                     txt = CCD(data[dep][0], "SI", 12).disp
+                    gtot = float(ASD(gtot) + ASD(data[dep][0]))
                 else:
+                    if dep == keys[-1]:
+                        l = 1
+                    else:
+                        l = 0
                     gp = CCD(round(data[dep][0] * 100.0 / data[dep][1], 2),
                         "SD", 6.2).disp
                     txt = "%s%s" % (gp, "%")
                 self.fpdf.drawText(txt, w=w, h=5, align="C", border=b, fill=f,
-                    ln=0)
+                    ln=l)
+            if self.rtyp == "G":
+                txt = CCD(gtot, "SI", 12).disp
+                self.fpdf.drawText(txt, w=w, h=5, align="C", border=b, fill=f)
         self.fpdf.setFont(font[0], "", font[1])
 
     def doButtons(self, state, frame=None):

=== modified file 'gen/gl4010.py'
--- gen/gl4010.py	2016-02-27 13:18:41 +0000
+++ gen/gl4010.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl4020.py'
--- gen/gl4020.py	2016-02-27 13:18:41 +0000
+++ gen/gl4020.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl6010.py'
--- gen/gl6010.py	2016-05-21 12:42:32 +0000
+++ gen/gl6010.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl6020.py'
--- gen/gl6020.py	2016-02-27 13:18:41 +0000
+++ gen/gl6020.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl6030.py'
--- gen/gl6030.py	2016-11-07 16:11:53 +0000
+++ gen/gl6030.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl6040.py'
--- gen/gl6040.py	2016-02-27 13:18:41 +0000
+++ gen/gl6040.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl6050.py'
--- gen/gl6050.py	2016-02-27 13:18:41 +0000
+++ gen/gl6050.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl6060.py'
--- gen/gl6060.py	2016-12-30 14:10:51 +0000
+++ gen/gl6060.py	2017-01-28 08:53:13 +0000
@@ -10,10 +10,10 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
-from TartanClasses import RepPrt, Sql, TartanDialog
+from TartanClasses import Sql, TartanDialog
 
 class gl6060:
     def __init__(self, **opts):

=== modified file 'gen/gl6070.py'
--- gen/gl6070.py	2016-12-30 14:10:51 +0000
+++ gen/gl6070.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, Sql, TartanDialog

=== modified file 'gen/glc110.py'
--- gen/glc110.py	2016-02-27 13:18:41 +0000
+++ gen/glc110.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'gen/glc210.py'
--- gen/glc210.py	2016-02-27 13:18:41 +0000
+++ gen/glc210.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc310_rne.py'
--- gen/glc310_rne.py	2016-11-07 16:11:53 +0000
+++ gen/glc310_rne.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc410_rne.py'
--- gen/glc410_rne.py	2016-12-30 14:10:51 +0000
+++ gen/glc410_rne.py	2017-01-28 08:53:13 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc510_rne.py'
--- gen/glc510_rne.py	2016-11-07 16:11:53 +0000
+++ gen/glc510_rne.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'ibt/ib2010.py'
--- ibt/ib2010.py	2016-05-21 12:42:32 +0000
+++ ibt/ib2010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib2020.py'
--- ibt/ib2020.py	2016-05-21 12:42:32 +0000
+++ ibt/ib2020.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib3010.py'
--- ibt/ib3010.py	2016-06-22 08:28:55 +0000
+++ ibt/ib3010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, PrintTransfer, Sql, TartanDialog

=== modified file 'ibt/ib3020.py'
--- ibt/ib3020.py	2016-05-21 12:42:32 +0000
+++ ibt/ib3020.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib3030.py'
--- ibt/ib3030.py	2016-05-21 12:42:32 +0000
+++ ibt/ib3030.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, RepPrt, Sql, TartanDialog

=== modified file 'ibt/ib3040.py'
--- ibt/ib3040.py	2016-05-21 12:42:32 +0000
+++ ibt/ib3040.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ibc110.py'
--- ibt/ibc110.py	2016-02-27 13:18:41 +0000
+++ ibt/ibc110.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== removed file 'img/ptrust.jpg'
Binary files img/ptrust.jpg	2014-03-28 07:32:49 +0000 and img/ptrust.jpg	1970-01-01 00:00:00 +0000 differ
=== modified file 'lon/ln1010.py'
--- lon/ln1010.py	2016-02-27 13:18:41 +0000
+++ lon/ln1010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2010.py'
--- lon/ln2010.py	2016-05-21 12:42:32 +0000
+++ lon/ln2010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2020.py'
--- lon/ln2020.py	2016-02-27 13:18:41 +0000
+++ lon/ln2020.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2020_rne.py'
--- lon/ln2020_rne.py	2016-05-21 12:42:32 +0000
+++ lon/ln2020_rne.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2030.py'
--- lon/ln2030.py	2016-12-30 14:10:51 +0000
+++ lon/ln2030.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3010.py'
--- lon/ln3010.py	2016-02-27 13:18:41 +0000
+++ lon/ln3010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3020.py'
--- lon/ln3020.py	2016-05-21 12:42:32 +0000
+++ lon/ln3020.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3030.py'
--- lon/ln3030.py	2016-05-26 08:05:22 +0000
+++ lon/ln3030.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3040.py'
--- lon/ln3040.py	2016-06-22 08:28:55 +0000
+++ lon/ln3040.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3050.py'
--- lon/ln3050.py	2016-02-27 13:18:41 +0000
+++ lon/ln3050.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'lon/ln4010.py'
--- lon/ln4010.py	2016-05-21 12:42:32 +0000
+++ lon/ln4010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln6010.py'
--- lon/ln6010.py	2016-02-27 13:18:41 +0000
+++ lon/ln6010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'lon/lnc110.py'
--- lon/lnc110.py	2016-02-27 13:18:41 +0000
+++ lon/lnc110.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml1010.py'
--- mem/ml1010.py	2016-09-03 14:07:52 +0000
+++ mem/ml1010.py	2017-01-28 08:53:14 +0000
@@ -20,7 +20,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/ml2010.py'
--- mem/ml2010.py	2016-02-27 13:18:41 +0000
+++ mem/ml2010.py	2017-01-28 08:53:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml2020.py'
--- mem/ml2020.py	2016-02-27 13:18:41 +0000
+++ mem/ml2020.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3010.py'
--- mem/ml3010.py	2016-02-27 13:18:41 +0000
+++ mem/ml3010.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3020.py'
--- mem/ml3020.py	2016-05-21 12:42:32 +0000
+++ mem/ml3020.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3030.py'
--- mem/ml3030.py	2016-05-21 12:42:32 +0000
+++ mem/ml3030.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3040.py'
--- mem/ml3040.py	2016-02-27 13:18:41 +0000
+++ mem/ml3040.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'mem/ml3050.py'
--- mem/ml3050.py	2016-02-27 13:18:41 +0000
+++ mem/ml3050.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'mem/ml3060.py'
--- mem/ml3060.py	2016-02-27 13:18:41 +0000
+++ mem/ml3060.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3070.py'
--- mem/ml3070.py	2016-02-27 13:18:41 +0000
+++ mem/ml3070.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3080.py'
--- mem/ml3080.py	2016-02-27 13:18:41 +0000
+++ mem/ml3080.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3090.py'
--- mem/ml3090.py	2016-05-21 12:42:32 +0000
+++ mem/ml3090.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3100.py'
--- mem/ml3100.py	2016-02-27 13:18:41 +0000
+++ mem/ml3100.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3110.py'
--- mem/ml3110.py	2016-02-27 13:18:41 +0000
+++ mem/ml3110.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3120.py'
--- mem/ml3120.py	2016-02-27 13:18:41 +0000
+++ mem/ml3120.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CreateChart, TartanDialog, Sql

=== modified file 'mem/ml6010.py'
--- mem/ml6010.py	2016-02-27 13:18:41 +0000
+++ mem/ml6010.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml6020.py'
--- mem/ml6020.py	2016-02-27 13:18:41 +0000
+++ mem/ml6020.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/ml6030.py'
--- mem/ml6030.py	2016-02-27 13:18:41 +0000
+++ mem/ml6030.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import csv, os, time

=== modified file 'mem/mlc110.py'
--- mem/mlc110.py	2016-02-27 13:18:41 +0000
+++ mem/mlc110.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/mlc210.py'
--- mem/mlc210.py	2016-02-27 13:18:41 +0000
+++ mem/mlc210.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/mlc310.py'
--- mem/mlc310.py	2016-02-27 13:18:41 +0000
+++ mem/mlc310.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'mem/mlc410.py'
--- mem/mlc410.py	2016-02-27 13:18:41 +0000
+++ mem/mlc410.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'mem/mlm010.py'
--- mem/mlm010.py	2016-02-27 13:18:41 +0000
+++ mem/mlm010.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'men/bwlmen.py'
--- men/bwlmen.py	2016-09-03 14:07:52 +0000
+++ men/bwlmen.py	2017-01-31 06:52:58 +0000
@@ -57,7 +57,8 @@
     ["PNNY","mm_uy","rp1010",2,"Report Generator"],
     ["PNNN","mm_uy","tp1010",5,"Template Manager"],
     ["F","mm_hp","doAbout",0,"About"],
-    ["F","mm_hp","doManual",0,"Manual"]]
+    ["F","mm_hp","doManual",0,"Manual"],
+    ["F","mm_hp","doQuick",0,"Quick Start Guide"]]
 
 # Bowling Clubs
 bcmen = [
@@ -83,15 +84,14 @@
     ["PYNN","bc_ls","bc3050",0,"Match Assessment Report"],
     ["PYNN","bc_ls","bc3060",0,"Assessment Summary"],
     ["PYNN","bc_cc","bc2040",0,"Capture Entries"],
-    ["PYNN","bc_cc","bc3070",0,"Entries Listing"],
+    ["PYNN","bc_cc","bc3070",0,"List Entries"],
     ["PYNN","bc_cc","bc3080",0,"Competition Format"],
     ["PYNN","bc_cc","bc2050",0,"Competiton Draw"],
     ["PYNN","bc_cc","bc3090",0,"Draw Summary"],
     ["PYNN","bc_cc","bc2060",0,"Change Draw"],
     ["PYNN","bc_cc","bc2070",0,"Capture Game Results"],
-    ["PYNN","bc_cc","bc3100",0,"Game Results Report"],
-    ["PYNN","bc_cc","bc3110",0,"Match Results Report"],
-    ["PYNN","bc_cc","bc3120",0,"Contact Request Forms"],
+    ["PYNN","bc_cc","bc3100",0,"Match Results Report"],
+    ["PYNN","bc_cc","bc3110",0,"Contact Request Forms"],
     ["PYNN","bc_tb","bc6010",3,"Change Tab Numbers"],
     ["PYNN","bc_tb","bc6020",0,"Merge Duplicate Visitors"],
     ["PYNN","bc_tb","bc6030",0,"Clear History"]]

=== removed file 'men/posmen.py'
--- men/posmen.py	2016-09-03 14:07:52 +0000
+++ men/posmen.py	1970-01-01 00:00:00 +0000
@@ -1,462 +0,0 @@
-"""
-Module Types
-------------
-F     = Function
-P123  = Program where:
-        1 = Company Number (Y/N)
-        2 = Period Selection (Y/N/L) (L = Last Period)
-        3 = Pass User Name to Module
-CY  = System Command requiring a terminal session
-CN  = System Command not requiring a terminal session
-S   = A standard callable python class
-U   = A Program without normal arguments only username.
-
-Security Levels
----------------
-0 - Enquiries Only
-1 - + Reporting
-2 - + Data Capture
-3 - + File Maintenance
-4 - + Month and Year End Routines
-5 - + Control Routines
-6 - + Financial Year End Routine
-7 - + User and Module Pasword Maintenance
-8 - + Database tables update
-9 -   Everything
-"""
-
-# Systems
-systems = [
-    ["ms", "Control Routines"],
-    ["gl", "General Ledger"],
-    ["cr", "Creditor's Ledger"],
-    ["dr", "Debtor's Ledger"],
-    ["st", "Store's Ledger"],
-    ["si", "Sales Invoicing"],
-    ["ar", "Asset's Register"],
-    ["ml", "Member's Ledger"],
-    ["rt", "Rental's Ledger (Basic)"],
-    ["rc", "Rental's Ledger (Extended)"],
-    ["wg", "Salaries & Wages"],
-    ["sl", "Staff Loans"],
-    ["bc", "Bowling Clubs"],
-    ["rp", "Reporting Tools"]]
-
-# Control Routines
-msmen = [
-    ["MM","mm_sy","System"],
-    ["MM","mm_ms","Control"],
-    ["MM","mm_gl","General Ledger"],
-    ["MM","mm_cr","Creditor's Ledger"],
-    ["MM","mm_dr","Debtor's Ledger"],
-    ["MM","mm_st","Store's Ledger"],
-    ["MM","mm_si","Sales Invoicing"],
-    ["MM","mm_ar","Asset's Register"],
-    ["MM","mm_rt","Rental's Ledger"],
-    ["MM","mm_rc","Rental's Ledger"],
-    ["MM","mm_wg","Salaries & Wages"],
-    ["MM","mm_sl","Staff Loans"],
-    ["MM","mm_ml","Member's Ledger"],
-    ["MM","mm_bc","Bowling Clubs"],
-    ["MM","mm_sc","Sectional Comps"],
-    ["MM","mm_uy","Utilities"],
-    ["MM","mm_hp","Help"]]
-msmod = [
-    ["F","mm_sy","chgUsr",0,"Change User"],
-    ["F","mm_sy","chgPwd",0,"Change Password"],
-    ["F","mm_sy","tarUsr",7,"User's Maintenance"],
-    ["F","mm_sy","sysUpd",0,"Upgrade System"],
-    ["F","mm_sy","tarUpd",8,"Update File Formats"],
-    ["PNNN","mm_sy","tb1040",9,"Copy Tables"],
-    ["F","mm_sy","tarBck",0,"Backup Database"],
-    ["F","mm_sy","tarRes",5,"Restore Database"],
-    ["F","mm_sy","tarCfg",0,"Preferences"],
-    ["F","mm_sy","sysEnd",0,"Quit"],
-    ["PNNY","mm_ms","msc110",7,"System Record Maintenance"],
-    ["PNNY","mm_ms","ms1010",5,"Company Records Maintenance"],
-    ["PYNN","mm_ms","ms1020",5,"Department Records Maintenance"],
-    ["PNNN","mm_ms","ms1030",7,"Module Passwords Maintenance"],
-    ["PNNN","mm_ms","ms3020",7,"Module Passwords Listing"],
-    ["PYNY","mm_ms","ms1040",3,"V.A.T. Records Maintenance"],
-    ["PYNN","mm_ms","ms3010",3,"V.A.T. Statement"],
-    ["PNNN","mm_ms","ms3030",3,"Email Log Report"],
-    ["PYYY","mm_ms","msy010",6,"Financial Year End Routine"],
-    ["PYYY","mm_ms","msy020",6,"Change Year End Date"],
-    ["PYNN","mm_uy","bm1010",0,"Bulk Mail/SMS Utility"],
-    ["PNNN","mm_uy","fc1010",0,"Loan/Lease Calculator"],
-    ["PNNY","mm_uy","pm1010",0,"Personal Password Manager"],
-    ["PNNY","mm_uy","rp1010",2,"Report Generator"],
-    ["PNNN","mm_uy","pw1010",0,"Server User Maintenance"],
-    ["PNNY","mm_uy","td1010",0,"Telephone Directory"],
-    ["PNNN","mm_uy","tp1010",5,"Template Manager"],
-    ["F","mm_hp","doAbout",0,"About"],
-    ["F","mm_hp","doManual",0,"Manual"]]
-
-# General Ledger Routines
-glmen = [
-    ["CM","mm_gl","gl_fm","File Maintenance"],
-    ["CM","mm_gl","gl_dc","Data Capture"],
-    ["CM","mm_gl","gl_rp","Reporting"],
-    ["CM","mm_gl","gl_tb","Toolbox"],
-    ["CM","mm_gl","gl_qy","Interrogation"]]
-glmod = [
-    ["PYNY","gl_fm","gl1010",3,"Masterfile Records"],
-    ["PYNN","gl_fm","glc110",5,"Control Accounts"],
-    ["PYNN","gl_fm","glc210",5,"Inter Company Records"],
-    ["PYYN","gl_fm","gl1020",3,"Standard Journals"],
-    ["PYNN","gl_fm","gl1030",3,"Report Generator"],
-    ["PYYN","gl_fm","gl1040",3,"Detail Records"],
-    ["PYNN","gl_fm","gl1050",3,"Stream Records"],
-    ["PYNN","gl_fm","gl1060",3,"Bank Import Control"],
-    ["PYNN","gl_dc","gl2010",2,"Opening Balances",0],
-    ["PYYN","gl_dc","gl2020",2,"Budgets",0],
-    ["PYYY","gl_dc","gl2030",2,"Sales",1],
-    ["PYYY","gl_dc","gl2030",2,"Payments",2],
-    ["PYYY","gl_dc","gl2030",2,"Petty Cash",3],
-    ["PYYY","gl_dc","gl2040",2,"Manual Journals",4],
-    ["PYYY","gl_dc","gl2050",2,"Standard Journals",4],
-    ["PYYY","gl_dc","gl2030",2,"Purchases",5],
-    ["PYYY","gl_dc","gl2030",2,"Receipts",6],
-    ["PYYY","gl_dc","gl2030",2,"Bank Statements",7],
-    ["PYNN","gl_rp","gl3010",1,"Batch Error Listing"],
-    ["PYYN","gl_rp","gl3020",1,"Transaction Audit Trail"],
-    ["PYYN","gl_rp","gl3030",1,"Account Statements"],
-    ["PYYN","gl_rp","gl3040",1,"Trial Balance"],
-    ["PYYN","gl_rp","gl3050",1,"Financial Statements"],
-    ["PYNN","gl_rp","gl3060",1,"Chart of Accounts"],
-    ["PYNN","gl_rp","gl3070",1,"Notes Listing"],
-    ["PYYN","gl_rp","gl3080",1,"Bank Reconciliation"],
-    ["PYNN","gl_rp","gl3090",1,"Imported Bank Statements"],
-    ["PYNN","gl_tb","gl6010",5,"Change Account Numbers"],
-    ["PYNN","gl_tb","gl6020",5,"Copy Masterfile Records"],
-    ["PYYN","gl_tb","gl6030",1,"Integrated Controls Report"],
-    ["PYYN","gl_tb","gl6040",1,"Intercompany Accounts Report"],
-    ["PYNN","gl_tb","gl6050",2,"Initialise Bank Reconciliation"],
-    ["PYYY","gl_qy","gl4010",0,"Interrogation (Normal)"],
-    ["PYYN","gl_qy","gl4020",1,"Interrogation (Financials)"]]
-
-# Creditor's Ledger Routines
-crmen = [
-    ["CM","mm_cr","cr_fm","File Maintenance"],
-    ["CM","mm_cr","cr_dc","Data Capture"],
-    ["CM","mm_cr","cr_rp","Reporting"],
-    ["CM","mm_cr","cr_tb","Toolbox"]]
-crmod = [
-    ["PYNY","cr_fm","crc110",5,"Control Record"],
-    ["PYNY","cr_fm","cr1010",3,"Masterfile Records"],
-    ["PYYY","cr_dc","cr2010",2,"Purchases",1],
-    ["PYYY","cr_dc","cr2010",2,"Receipts",2],
-    ["PYYY","cr_dc","cr2010",2,"Journals",3],
-    ["PYYY","cr_dc","cr2010",2,"Credit Notes",4],
-    ["PYYY","cr_dc","cr2010",2,"Payments",5],
-    ["PYNN","cr_rp","cr3010",1,"Batch Error Listing"],
-    ["PYYN","cr_rp","cr3020",1,"Transaction Audit Trail"],
-    ["PYNN","cr_rp","cr3030",1,"Due for Payment Listing"],
-    ["PYNN","cr_rp","cr3040",1,"Outstanding Transactions"],
-    ["PYNN","cr_rp","cr3050",1,"Age Analysis"],
-    ["PYNN","cr_rp","cr3060",1,"Master Listing"],
-    ["PYNN","cr_rp","cr3070",1,"Reconciliation Statements"],
-    ["PYNY","cr_rp","cr3080",1,"Remittance Advices"],
-    ["PYNN","cr_rp","cr3090",1,"Name and Address Labels"],
-    ["PYNN","cr_rp","cr3100",1,"Notes Listing"],
-    ["PYNN","cr_rp","cr3110",1,"Purchases History"],
-    ["PYNN","cr_tb","cr6010",5,"Change Account Numbers"],
-    ["PYNN","cr_tb","cr6020",3,"Transaction Reallocations"],
-    ["PYNY","mm_cr","cr4010",0,"Interrogation"]]
-
-# Debtor"s Ledger Routines
-drmen = [
-    ["CM","mm_dr","dr_fm","File Maintenance"],
-    ["CM","mm_dr","dr_dc","Data Capture"],
-    ["CM","mm_dr","dr_rp","Reporting"],
-    ["CM","mm_dr","dr_tb","Toolbox"]]
-drmod = [
-    ["PYNY","dr_fm","drc110",5,"Control Record"],
-    ["PYNN","dr_fm","drc210",3,"Chain Stores"],
-    ["PNNN","dr_fm","drc610",3,"Business Activities"],
-    ["PNNN","dr_fm","drc710",3,"Business Types"],
-    ["PYNN","dr_fm","drc310",3,"Salesmen"],
-    ["PYNN","dr_fm","drc410",3,"Delivery Addresses"],
-    ["PNNN","dr_fm","drc510",3,"Messages"],
-    ["PYNY","dr_fm","dr1010",3,"Masterfile Records"],
-    ["PYYN","dr_fm","dr1020",3,"Recurring Charges Records"],
-    ["PYYY","dr_dc","dr2010",2,"Sales",1],
-    ["PYYY","dr_dc","dr2020",2,"Receipts",2],
-    ["PYYY","dr_dc","dr2010",2,"Journals",3],
-    ["PYYY","dr_dc","dr2010",2,"Credit Notes",4],
-    ["PYYY","dr_dc","dr2010",2,"Payments",5],
-    ["PYYY","dr_dc","dr2030",2,"Recurring Charges",1],
-    ["PYNN","dr_rp","drc220",1,"Chain Stores Listing"],
-    ["PYNN","dr_rp","drc320",1,"Salesmen Listing"],
-    ["PYNN","dr_rp","drc420",1,"Delivery Addresses Listing"],
-    ["PNNN","dr_rp","drc520",1,"Messages Listing"],
-    ["PYNN","dr_rp","dr3010",1,"Batch Error Listing"],
-    ["PYYN","dr_rp","dr3020",1,"Transaction Audit Trail"],
-    ["PYNN","dr_rp","dr3030",1,"Due for Payment Listing"],
-    ["PYNN","dr_rp","dr3040",1,"Outstanding Transactions"],
-    ["PYNN","dr_rp","dr3050",1,"Age Analysis"],
-    ["PYNN","dr_rp","dr3060",1,"Master Listing"],
-    ["PYNN","dr_rp","dr3080",1,"Statements"],
-    ["PYNN","dr_rp","dr3090",1,"Name and Address Labels"],
-    ["PYNN","dr_rp","dr3100",1,"Notes Listing"],
-    ["PYNN","dr_rp","dr3110",1,"Sales History"],
-    ["PYNN","dr_rp","dr3120",1,"Interest Chargeable"],
-    ["PYNN","dr_tb","dr6010",5,"Change Account Numbers"],
-    ["PYNN","dr_tb","dr6020",3,"Transaction Reallocations"],
-    ["PYNN","dr_tb","dr6030",3,"Populate Credit Ratings"],
-    ["PYNY","mm_dr","dr4010",0,"Interrogation"]]
-
-# Stores Ledger Routines
-stmen = [
-    ["CM","mm_st","st_fm","File Maintenance"],
-    ["CM","mm_st","st_dc","Data Capture"],
-    ["CM","mm_st","st_st","Stock Take"],
-    ["CM","mm_st","st_rp","Reporting"],
-    ["CM","mm_st","st_tb","Toolbox"]]
-stmod = [
-    ["PYNY","st_fm","stc110",5,"Control Record"],
-    ["PYNN","st_fm","stc210",3,"Units Of Issue"],
-    ["PYNN","st_fm","stc310",3,"Product Groups"],
-    ["PYNN","st_fm","stc410",3,"Locations"],
-    ["PYNY","st_fm","st1010",3,"Masterfile Records"],
-    ["PYNN","st_fm","st1020",3,"Selling Prices"],
-    ["PYYY","st_dc","st2010",2,"Purchase Orders",0],
-    ["PYYY","st_dc","st2020",2,"Goods Received Notes",0],
-    ["PYYY","st_dc","st2030",2,"Goods Issued Notes",0],
-    ["PYYY","st_dc","st2040",2,"Location Transfers",0],
-    ["PYYN","st_st","st5010",1,"Stock Take Report"],
-    ["PYNN","st_st","st5020",2,"Stock Take Returns",0],
-    ["PYYN","st_st","st5030",2,"Stock Take Variance Report"],
-    ["PYYY","st_st","st5040",2,"Stock Take Merge",0],
-    ["PYNN","st_rp","stc220",1,"Units Of Issue Listing"],
-    ["PYNN","st_rp","stc320",1,"Product Groups Listing"],
-    ["PYNN","st_rp","stc420",1,"Locations Listing"],
-    ["PYNN","st_rp","st3010",1,"Batch Error Listing"],
-    ["PYNN","st_rp","st3020",1,"Transaction Audit Trail"],
-    ["PYNN","st_rp","st3030",1,"Price Lists"],
-    ["PYNN","st_rp","st3040",1,"Master Code Listing"],
-    ["PYNN","st_rp","st3050",1,"Recipe Listing"],
-    ["PYNN","st_rp","st3060",1,"Stock Movements"],
-    ["PYNN","st_rp","st3070",1,"Purchase Orders"],
-    ["PYNN","st_rp","st3080",1,"Stock On Hand"],
-    ["PYYN","st_rp","st3090",1,"Stock Accounts"],
-    ["PYNN","st_rp","st3100",1,"Notes Listing"],
-    ["PYNN","st_rp","st3110",1,"Item Labels"],
-    ["PYNN","st_rp","st3120",1,"Stock to Order"],
-    ["PYNN","st_tb","st6010",5,"Change Product Codes"],
-    ["PYYY","st_tb","st6020",5,"Revalue Stock Records",0],
-    ["PYYY","mm_st","st4010",0,"Interrogation"]]
-
-# Sales Invoicing Routines
-simen = [
-    ["CM","mm_si","si_fm","File Maintenance"],
-    ["CM","mm_si","si_dc","Data Capture"],
-    ["CM","mm_si","si_rp","Reporting"]]
-simod = [
-    ["PYNY","si_fm","sic110",5,"Control Record"],
-    ["PYLY","si_dc","si2010",2,"Invoicing",0],
-    ["PYLY","si_dc","si2020",2,"Cash Register",0],
-    ["PYNN","si_rp","si3010",1,"Oustanding Orders"],
-    ["PYYN","si_rp","si3020",1,"Sales By Product"],
-    ["PYYN","si_rp","si3030",1,"Period Sales By Product"],
-    ["PYNN","si_rp","si3040",1,"Product Sales History"],
-    ["PYNN","si_rp","si3050",1,"Sales By Customer By Product"],
-    ["PYNN","si_rp","si3060",1,"Sales By Salesman"],
-    ["PYNN","si_rp","si3070",1,"Salesman's Sales History"],
-    ["PYNN","si_rp","si3080",1,"Reprint Documents"]]
-
-# Assets Register
-armen = [
-    ["CM","mm_ar","ar_fm","File Maintenance"],
-    ["CM","mm_ar","ar_dc","Data Capture"],
-    ["CM","mm_ar","ar_rp","Reporting"],
-    ["CM","mm_ar","ar_tb","Toolbox"]]
-armod = [
-    ["PYNY","ar_fm","arc110",5,"Control Record"],
-    ["PYNN","ar_fm","arc210",3,"Depreciation Codes"],
-    ["PYNN","ar_fm","arc310",3,"Group Records"],
-    ["PYNY","ar_fm","ar1010",3,"Masterfile Records"],
-    ["PYYY","ar_dc","ar2010",2,"Opening Balances",0],
-    ["PYYY","ar_dc","ar2020",2,"Payments",1],
-    ["PYYY","ar_dc","ar2020",2,"Receipts",2],
-    ["PYYY","ar_dc","ar2020",2,"Journals",3],
-    ["PYYY","ar_dc","ar2030",2,"Depreciation",0],
-    ["PYNN","ar_rp","arc320",1,"Groups Listing"],
-    ["PYNN","ar_rp","ar3010",1,"Batch Error Listing"],
-    ["PYYN","ar_rp","ar3020",1,"Transaction Audit Trail"],
-    ["PYYN","ar_rp","ar3030",1,"Asset Statements"],
-    ["PYYN","ar_rp","ar3040",1,"Asset Register"],
-    ["PYNN","ar_rp","ar3050",1,"Notes Listing"],
-    ["PYNN","ar_tb","ar6010",5,"Change Asset Codes"],
-    ["PYYY","mm_ar","ar4010",0,"Interrogation"]]
-
-# Rental's Ledger (Basic)
-rtmen = [
-    ["CM","mm_rt","rt_fm","File Maintenance"],
-    ["CM","mm_rt","rt_dc","Data Capture"],
-    ["CM","mm_rt","rt_rp","Reporting"],
-    ["CM","mm_rt","rt_tb","Toolbox"]]
-rtmod = [
-    ["PYNY","rt_fm","rtc110",5,"Control Record"],
-    ["PYNY","rt_fm","rtc210",3,"Premises Records"],
-    ["PYNY","rt_fm","rt1010",3,"Masterfile Records"],
-    ["PYYY","rt_dc","rt2010",2,"Receipts",2],
-    ["PYYY","rt_dc","rt2010",2,"Payments",3],
-    ["PYYY","rt_dc","rt2010",2,"Journals",4],
-    ["PYNN","rt_rp","rt3010",1,"Batch Error Listing"],
-    ["PYYN","rt_rp","rt3020",1,"Transaction Audit Trail"],
-    ["PYNN","rt_rp","rt3030",1,"Master Listing"],
-    ["PYNN","rt_rp","rt3040",1,"Statements"],
-    ["PYNN","rt_rp","rt3050",1,"Notes Listing"],
-    ["PYNN","rt_tb","rt6010",5,"Change Account Numbers"],
-    ["PYNY","mm_rt","rt4010",1,"Interrogation"],
-    ["PYNY","mm_rt","rtm010",4,"Month End Routine",0]]
-
-# Rental's Ledger (Extended)
-rcmen = [
-    ["CM","mm_rc","rc_fm","File Maintenance"],
-    ["CM","mm_rc","rc_rp","Reporting"],
-    ["CM","mm_rc","rc_qy","Interrogation"],
-    ["CM","mm_rc","rc_tb","Toolbox"]]
-rcmod = [
-    ["PYNY","rc_fm","rcc110",5,"Control Record"],
-    ["PYNY","rc_fm","rc1010",3,"Owners Records"],
-    ["PYNY","rc_fm","rc1020",3,"Premises Records"],
-    ["PYNY","rc_fm","rc1030",3,"Tenants Records"],
-    ["PNNN","rc_fm","rcc210",1,"Statement Messages"],
-    ["PYNY","rc_fm","rcc310",1,"Interest Rates"],
-    ["PYNN","rc_rp","rc3010",1,"Owners Audit Trail"],
-    ["PYNN","rc_rp","rc3030",1,"Owners Master Listing"],
-    ["PYNN","rc_rp","rc3050",1,"Owners Statements"],
-    ["PYNN","rc_rp","rc3070",1,"Owners Notes Listing"],
-    ["PYNN","rc_rp","rc3020",1,"Tenants Audit Trail"],
-    ["PYNN","rc_rp","rc3040",1,"Tenants Master Listing"],
-    ["PYNN","rc_rp","rc3060",1,"Tenants Statements"],
-    ["PYNN","rc_rp","rc3080",1,"Tenants Notes Listing"],
-    ["PYNN","rc_rp","rc3090",1,"Tenants Deposit Listing"],
-    ["PNNN","rc_rp","rcc220",1,"Statement Messages"],
-    ["PYNY","rc_qy","rc4010",0,"Owners Interrogation"],
-    ["PYNY","rc_qy","rc4020",0,"Tenants Interrogation"],
-    ["PNNN","rc_tb","rc6010",1,"CSV Masterfile Importing"],
-    ["PNNN","rc_tb","rc6020",1,"CSV Transaction Importing"],
-    ["PNNN","rc_tb","rc6030",1,"Check for Missing Records"],
-    ["PYNY","mm_rc","rc2010",2,"Data Capture",0],
-    ["PYNY","mm_rc","rcm010",4,"Month End Routine",0]]
-
-# Salaries and Wages Routines
-wgmen = [
-    ["CM","mm_wg","wg_fm","File Maintenance"],
-    ["CM","mm_wg","wg_dc","Data Capture"],
-    ["CM","mm_wg","wg_rp","Reporting"]]
-wgmod = [
-    ["PYNY","wg_fm","wgc110",5,"Control Record"],
-    ["PNNN","wg_fm","wgc210",3,"Receiver Codes"],
-    ["PYNN","wg_fm","wgc310",3,"Earning and Deduction Codes"],
-    ["PYNN","wg_fm","wgc410",3,"Union Records"],
-    ["PNNN","wg_fm","wgc510",3,"Payslip Messages"],
-    ["PNNN","wg_fm","wgc610",3,"PAYE Tables"],
-    ["PYNY","wg_fm","wg1010",3,"Employee Masterfile"],
-    ["PYNY","wg_dc","wg2010",2,"Clock Cards",0],
-    ["PYYY","wg_dc","wg2020",2,"Payslips",0],
-    ["PYNN","wg_dc","wg2030",2,"Terminations",0],
-    ["PNNN","wg_rp","wgc220",1,"Receiver Codes Listing"],
-    ["PYNN","wg_rp","wgc320",1,"Earning and Deduction Codes"],
-    ["PYNN","wg_rp","wgc420",1,"Union Records Listing"],
-    ["PNNN","wg_rp","wgc520",1,"Payslip Messages Listing"],
-    ["PYNN","wg_rp","wg3010",1,"Employee Master Listing"],
-    ["PYNN","wg_rp","wg3020",1,"Data Capture Listing"],
-    ["PYNN","wg_rp","wg3030",1,"SARS EMP201 Report"],
-    ["PYNN","wg_rp","wg3040",1,"Earning and Deduction Values"],
-    ["PYNN","wg_rp","wg3050",1,"IRP5 Statements"],
-    ["PYNN","wg_rp","wg3060",1,"Notes Listing"],
-    ["PYNN","wg_rp","wg3070",1,"Payslips Reprint"],
-    ["PYNY","mm_wg","wg4010",0,"Interrogation"]]
-
-# Staff Loans Routines
-slmen = [
-    ["CM","mm_sl","sl_fm","File Maintenance"],
-    ["CM","mm_sl","sl_dc","Data Capture"],
-    ["CM","mm_sl","sl_rp","Reporting"]]
-slmod = [
-    ["PYNY","sl_fm","sl1010",3,"Loans Masterfile"],
-    ["PYYY","sl_dc","sl2010",2,"New Loans",0],
-    ["PYYY","sl_dc","sl2020",2,"Movements",0],
-    ["PYYY","sl_dc","sl2030",2,"Raise Interest",0],
-    ["PYNN","sl_rp","sl3010",1,"Batch Error Listing"],
-    ["PYNN","sl_rp","sl3020",1,"Transaction Audit Trail"],
-    ["PYNN","sl_rp","sl3030",1,"Master Listing"],
-    ["PYNN","sl_rp","sl3040",1,"Statements"],
-    ["PYNY","mm_sl","sl4010",0,"Interrogation"]]
-
-# Member's Ledger
-mlmen = [
-    ["CM","mm_ml","ml_fm","File Maintenance"],
-    ["CM","mm_ml","ml_dc","Data Capture"],
-    ["CM","mm_ml","ml_rp","Reporting"],
-    ["CM","mm_ml","ml_tb","Toolbox"]]
-mlmod = [
-    ["PYNY","ml_fm","mlc110",5,"Control Record"],
-    ["PYNY","ml_fm","mlc210",3,"Category Records"],
-    ["PNNN","ml_fm","mlc310",3,"Message Records"],
-    ["PNNN","ml_fm","mlc410",3,"Contact Records"],
-    ["PYYY","ml_dc","ml2010",2,"Invoices",1],
-    ["PYYY","ml_dc","ml2010",2,"Payments",2],
-    ["PYYY","ml_dc","ml2010",2,"Journals",3],
-    ["PYYY","ml_dc","ml2010",2,"Credit Notes",4],
-    ["PYYY","ml_dc","ml2020",2,"Receipts",5],
-    ["PYNN","ml_rp","ml3010",1,"Batch Error Listing"],
-    ["PYYN","ml_rp","ml3020",1,"Transaction Audit Trail"],
-    ["PYNN","ml_rp","ml3030",1,"Age Analysis"],
-    ["PYNN","ml_rp","ml3040",1,"Statements"],
-    ["PYNN","ml_rp","ml3050",1,"Notes Listing"],
-    ["PYNN","ml_rp","ml3060",1,"Category Changes"],
-    ["PYLY","ml_rp","ml3070",1,"Master Report"],
-    ["PYNY","ml_rp","ml3080",2,"Suspension Report"],
-    ["PYNN","ml_rp","ml3090",2,"Detail Update Request"],
-    ["PYNN","ml_rp","ml3100",2,"Member's Birthday Report"],
-    ["PYNN","ml_rp","ml3110",2,"Name and Address Labels"],
-    ["PYNN","ml_rp","ml3120",2,"Status Summary"],
-    ["PYNN","ml_tb","ml6010",3,"Transaction Reallocations"],
-    ["PYNN","ml_tb","ml6020",3,"Synchronise Access Control"],
-    ["PYNN","ml_tb","ml6030",3,"Export Access Control"],
-    ["PYLY","mm_ml","ml1010",1,"Member Records"],
-    ["PYYY","mm_ml","mlm010",4,"Month End Routine",0]]
-
-# Bowling Clubs
-bcmen = [
-    ["CM","mm_bc","bc_fm","File Maintenance"],
-    ["CM","mm_bc","bc_ti","Tabs Draw"],
-    ["CM","mm_bc","bc_ls","League Selections"],
-    ["CM","mm_bc","bc_cc","Club Competitions"],
-    ["CM","mm_bc","bc_tb","Toolbox"]]
-bcmod = [
-    ["PYNY","bc_fm","bcc110",0,"Control Record"],
-    ["PYNN","bc_fm","bcc210",0,"Club's Records"],
-    ["PYNY","bc_fm","bc1010",0,"Tabs Maintenance"],
-    ["PYNN","bc_fm","bc1020",0,"League Formats"],
-    ["PYNN","bc_fm","bc1030",0,"Side's Maintenance"],
-    ["PYNN","bc_fm","bc1040",0,"Player's Maintenance"],
-    ["PYNN","bc_fm","bc1050",0,"Competition Types"],
-    ["PYNN","bc_ti","bc2010",0,"Draw"],
-    ["PYNN","bc_ti","bc3010",0,"Reprint Draw"],
-    ["PYNN","bc_ti","bc3020",0,"Draws Summary"],
-    ["PYNN","bc_ls","bc2020",0,"Capture Selections"],
-    ["PYNN","bc_ls","bc3030",0,"Assessment Forms"],
-    ["PYNN","bc_ls","bc3040",0,"Declaration Forms"],
-    ["PYNN","bc_ls","bc2030",0,"Capture Assessments"],
-    ["PYNN","bc_ls","bc3050",0,"Match Assessment Report"],
-    ["PYNN","bc_ls","bc3060",0,"Assessment Summary"],
-    ["PYNN","bc_cc","bc2040",0,"Capture Entries"],
-    ["PYNN","bc_cc","bc3070",0,"Entries Listing"],
-    ["PYNN","bc_cc","bc3080",0,"Competition Format"],
-    ["PYNN","bc_cc","bc2050",0,"Competiton Draw"],
-    ["PYNN","bc_cc","bc3090",0,"Draw Summary"],
-    ["PYNN","bc_cc","bc2060",0,"Change Draw"],
-    ["PYNN","bc_cc","bc2070",0,"Capture Results"],
-    ["PYNN","bc_cc","bc3100",0,"Game Results Report"],
-    ["PYNN","bc_cc","bc3110",0,"Match Results Report"],
-    ["PYNN","bc_cc","bc3120",0,"Contact Request Forms"],
-    ["PYNN","bc_tb","bc6010",3,"Change Tab Numbers"],
-    ["PYNN","bc_tb","bc6020",3,"Change Player's Codes"],
-    ["PYNN","bc_tb","bc6030",0,"Clear League History"]]
-# End

=== modified file 'men/stdmen.py'
--- men/stdmen.py	2016-12-30 14:10:51 +0000
+++ men/stdmen.py	2017-01-31 06:52:21 +0000
@@ -498,15 +498,14 @@
     ["PYNN","bc_ls","bc3050",0,"Match Assessment Report"],
     ["PYNN","bc_ls","bc3060",0,"Assessment Summary"],
     ["PYNN","bc_cc","bc2040",0,"Capture Entries"],
-    ["PYNN","bc_cc","bc3070",0,"Entries Listing"],
+    ["PYNN","bc_cc","bc3070",0,"List Entries"],
     ["PYNN","bc_cc","bc3080",0,"Competition Format"],
     ["PYNN","bc_cc","bc2050",0,"Competiton Draw"],
     ["PYNN","bc_cc","bc3090",0,"Draw Summary"],
     ["PYNN","bc_cc","bc2060",0,"Change Draw"],
     ["PYNN","bc_cc","bc2070",0,"Capture Game Results"],
-    ["PYNN","bc_cc","bc3100",0,"Game Results Report"],
-    ["PYNN","bc_cc","bc3110",0,"Match Results Report"],
-    ["PYNN","bc_cc","bc3120",0,"Contact Request Forms"],
+    ["PYNN","bc_cc","bc3100",0,"Match Results Report"],
+    ["PYNN","bc_cc","bc3110",0,"Contact Request Forms"],
     ["PYNN","bc_tb","bc6010",3,"Change Tab Numbers"],
     ["PYNN","bc_tb","bc6020",0,"Merge Duplicate Visitors"],
     ["PYNN","bc_tb","bc6030",0,"Clear History"]]

=== modified file 'mst/ms0000.py'
--- mst/ms0000.py	2016-12-30 14:10:51 +0000
+++ mst/ms0000.py	2017-02-25 14:02:44 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import getopt, os, sys
@@ -38,7 +38,7 @@
     temp = tuple(os.environ["TARVER"].split("."))
     VERSION = (int(temp[0]), int(temp[1]), int(temp[2]))
 else:
-    VERSION = (5, 2, 7)
+    VERSION = (5, 2, 8)
 if __name__ == "__main__":
     # Run Tartan
     try:

=== modified file 'mst/ms1010.py'
--- mst/ms1010.py	2016-02-27 13:18:41 +0000
+++ mst/ms1010.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mst/ms1010_oth.py'
--- mst/ms1010_oth.py	2016-06-22 08:28:55 +0000
+++ mst/ms1010_oth.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms1010_rne.py'
--- mst/ms1010_rne.py	2016-02-27 13:18:41 +0000
+++ mst/ms1010_rne.py	2017-02-24 18:36:25 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time
@@ -337,11 +337,19 @@
 
     def doFinPeriod(self):
         tit = ("Initial Financial Period",)
+        self.bye = self.sql.getRec(tables="ctlynd", cols=["cye_start",
+            "cye_end"], where=[("cye_cono", "=", 1),
+            ("cye_period", "=", 1)], limit=1)
+        if self.bye:
+            self.doStartPer("T", 0, 0, 1, 0, 0, self.bye[0])
+            self.doEndPer("T", 0, 0, 2, 1, 1, self.bye[1])
+            self.doPerEnd()
+            return
         fld = (
             (("T",0,0,0),"ID1",10,"Period Start Date","",
-                "","N",self.doStartPer,None,None,("efld",)),
+                0,"N",self.doStartPer,None,None,("efld",)),
             (("T",0,1,0),"ID1",10,"Period End Date","",
-                "","N",self.doEndPer,None,None,("efld",)))
+                0,"N",self.doEndPer,None,None,("efld",)))
         tnd = ((self.doPerEnd,"y"), )
         txt = (self.doPerExit,)
         state = self.df.disableButtonsTags()
@@ -370,7 +378,8 @@
         if not m:
             m = 12
             y -= 1
-        self.pf.t_work[0][0][1] = mthendDate((y*10000) + (m*100) + 1)
+        if not self.bye:
+            self.pf.t_work[0][0][1] = mthendDate((y*10000) + (m*100) + 1)
 
     def doEndPer(self, frt, pag, r, c, p, i, w):
         if w <= self.s1:
@@ -393,7 +402,8 @@
         self.sql.insRec("ctlynd",data=[self.opts["conum"], 1, self.s1, self.e1,
             0, "N"])
         self.xits = "n"
-        self.closeProcess()
+        if not self.bye:
+            self.closeProcess()
 
     def doPerExit(self):
         self.xits = "y"

=== modified file 'mst/ms1020.py'
--- mst/ms1020.py	2016-02-27 13:18:41 +0000
+++ mst/ms1020.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'mst/ms1030.py'
--- mst/ms1030.py	2016-02-27 13:18:41 +0000
+++ mst/ms1030.py	2017-01-28 08:53:15 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'mst/ms1040.py'
--- mst/ms1040.py	2016-02-27 13:18:41 +0000
+++ mst/ms1040.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms3010.py'
--- mst/ms3010.py	2016-05-21 12:42:32 +0000
+++ mst/ms3010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms3020.py'
--- mst/ms3020.py	2016-02-27 13:18:41 +0000
+++ mst/ms3020.py	2017-02-22 07:29:46 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -49,7 +49,7 @@
         tnd = ((self.doEnd,"y"), )
         txt = (self.doExit, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"))
+            txit=txt, view=("Y","V"))
 
     def doSys(self, frt, pag, r, c, p, i, w):
         self.sys = w

=== modified file 'mst/ms3030.py'
--- mst/ms3030.py	2016-02-27 13:18:41 +0000
+++ mst/ms3030.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/msc000.py'
--- mst/msc000.py	2016-12-30 14:10:51 +0000
+++ mst/msc000.py	2017-01-28 08:53:16 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import cStringIO, fpdf, getpass, gc, glob, os, sys, time, urllib2
@@ -267,7 +267,7 @@
                 self.doExit(dbm=False)
         self.mf = None
         self.rcdic = None
-        main = "Tartan Systems - Copyright %s 2004-2016 P Malherbe" % u"\u00A9"
+        main = "Tartan Systems - Copyright %s 2004-2017 P Malherbe" % u"\u00A9"
         while not self.rcdic:
             self.rcdic = loadRcFile(self.rcfile, default=True)
             if self.rcdic == "error":
@@ -1748,7 +1748,7 @@
                                 mess = r
                             else:
                                 mess = mess + "\n" + r
-                        if self.xdisplay:
+                        if self.xdisplay and self.output:
                             self.mf.window.deiconify()
                             self.mf.head.configure(text="SQL Query")
                             ScrollText(scrn=self.mf.body, mess=mess)

=== modified file 'mst/msc110.py'
--- mst/msc110.py	2016-05-21 12:42:32 +0000
+++ mst/msc110.py	2017-02-18 10:19:23 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -37,7 +37,7 @@
         self.acc = self.sql.getRec(tables="ctlsys", limit=1)
         if not self.acc:
             self.new = True
-            self.acc = [0,"N",0,0,0,"",0,0,25,"","","N","","","N",0]
+            self.acc = [0,"N",0,0,0,"",0,0,0,"","","N","","","N",0,""]
         else:
             self.new = False
         return True
@@ -67,7 +67,7 @@
             (("T",0,7,0),("IRB",r3s),0,"SMTP Authentication","",
                 "0","N",self.doAuth,None,None,None),
             (("T",0,8,0),"IUI",4,"SMTP Port","",
-                "","N",None,None,None,("notzero",)),
+                "","N",None,None,None,None),
             (("T",0,9,0),"ITX",20,"SMTP Username","",
                 "","N",self.doUsr,None,None,None),
             (("T",0,10,0),"IHA",20,"SMTP Password","",
@@ -91,10 +91,10 @@
         tnd = ((self.doEnd,"Y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=self.fld,
-            butt=but, tend=tnd, txit=txt)
-        if not self.new:
-            for n, f in enumerate(self.acc):
-                self.df.loadEntry("T", 0, n, data=f)
+            butt=but, tend=tnd, txit=txt, focus=False)
+        for n, f in enumerate(self.acc):
+            self.df.loadEntry("T", 0, n, data=f)
+        self.df.focusField("T", 0, 1, clr=False)
 
     def doHist(self, frt, pag, r, c, p, i, w):
         if w and w < 5:

=== modified file 'mst/msy010.py'
--- mst/msy010.py	2016-09-03 14:07:52 +0000
+++ mst/msy010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/msy020.py'
--- mst/msy020.py	2016-02-27 13:18:41 +0000
+++ mst/msy020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import SplashScreen, Sql, TartanDialog

=== modified file 'mst/msy030.py'
--- mst/msy030.py	2016-02-27 13:18:41 +0000
+++ mst/msy030.py	2017-01-28 08:53:16 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, PwdConfirm, Sql, TartanDialog

=== modified file 'rca/rc1010.py'
--- rca/rc1010.py	2016-02-27 13:18:41 +0000
+++ rca/rc1010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc1020.py'
--- rca/rc1020.py	2016-02-27 13:18:41 +0000
+++ rca/rc1020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc1030.py'
--- rca/rc1030.py	2016-02-27 13:18:41 +0000
+++ rca/rc1030.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc2010.py'
--- rca/rc2010.py	2016-02-27 13:18:41 +0000
+++ rca/rc2010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3010.py'
--- rca/rc3010.py	2016-02-27 13:18:41 +0000
+++ rca/rc3010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3020.py'
--- rca/rc3020.py	2016-02-27 13:18:41 +0000
+++ rca/rc3020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3030.py'
--- rca/rc3030.py	2016-02-27 13:18:41 +0000
+++ rca/rc3030.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3040.py'
--- rca/rc3040.py	2016-02-27 13:18:41 +0000
+++ rca/rc3040.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'rca/rc3050.py'
--- rca/rc3050.py	2016-02-27 13:18:41 +0000
+++ rca/rc3050.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3060.py'
--- rca/rc3060.py	2016-02-27 13:18:41 +0000
+++ rca/rc3060.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3070.py'
--- rca/rc3070.py	2016-02-27 13:18:41 +0000
+++ rca/rc3070.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rca/rc3080.py'
--- rca/rc3080.py	2016-02-27 13:18:41 +0000
+++ rca/rc3080.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rca/rc3090.py'
--- rca/rc3090.py	2016-02-27 13:18:41 +0000
+++ rca/rc3090.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc4010.py'
--- rca/rc4010.py	2016-02-27 13:18:41 +0000
+++ rca/rc4010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc4020.py'
--- rca/rc4020.py	2016-02-27 13:18:41 +0000
+++ rca/rc4020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc6010.py'
--- rca/rc6010.py	2016-02-27 13:18:41 +0000
+++ rca/rc6010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'rca/rc6020.py'
--- rca/rc6020.py	2016-02-27 13:18:41 +0000
+++ rca/rc6020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc6030.py'
--- rca/rc6030.py	2016-02-27 13:18:41 +0000
+++ rca/rc6030.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ScrollText, Sql

=== modified file 'rca/rcc110.py'
--- rca/rcc110.py	2016-02-27 13:18:41 +0000
+++ rca/rcc110.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcc210.py'
--- rca/rcc210.py	2016-02-27 13:18:41 +0000
+++ rca/rcc210.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'rca/rcc220.py'
--- rca/rcc220.py	2016-02-27 13:18:41 +0000
+++ rca/rcc220.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcc310.py'
--- rca/rcc310.py	2016-02-27 13:18:41 +0000
+++ rca/rcc310.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcm010.py'
--- rca/rcm010.py	2016-02-27 13:18:41 +0000
+++ rca/rcm010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'rtl/rt1010.py'
--- rtl/rt1010.py	2016-02-27 13:18:41 +0000
+++ rtl/rt1010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt2010.py'
--- rtl/rt2010.py	2016-02-27 13:18:41 +0000
+++ rtl/rt2010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3010.py'
--- rtl/rt3010.py	2016-02-27 13:18:41 +0000
+++ rtl/rt3010.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3020.py'
--- rtl/rt3020.py	2016-05-21 12:42:32 +0000
+++ rtl/rt3020.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3030.py'
--- rtl/rt3030.py	2016-02-27 13:18:41 +0000
+++ rtl/rt3030.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3040.py'
--- rtl/rt3040.py	2016-02-27 13:18:41 +0000
+++ rtl/rt3040.py	2017-01-28 08:53:16 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3050.py'
--- rtl/rt3050.py	2016-02-27 13:18:41 +0000
+++ rtl/rt3050.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rtl/rt4010.py'
--- rtl/rt4010.py	2016-02-27 13:18:41 +0000
+++ rtl/rt4010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt6010.py'
--- rtl/rt6010.py	2016-02-27 13:18:41 +0000
+++ rtl/rt6010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'rtl/rtc110.py'
--- rtl/rtc110.py	2016-02-27 13:18:41 +0000
+++ rtl/rtc110.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rtc210.py'
--- rtl/rtc210.py	2016-02-27 13:18:41 +0000
+++ rtl/rtc210.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rtm010.py'
--- rtl/rtm010.py	2016-02-27 13:18:41 +0000
+++ rtl/rtm010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'scp/sc1010.py'
--- scp/sc1010.py	2016-02-27 13:18:41 +0000
+++ scp/sc1010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'scp/sc2010.py'
--- scp/sc2010.py	2016-11-07 16:11:53 +0000
+++ scp/sc2010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os

=== modified file 'scp/sc2020.py'
--- scp/sc2020.py	2016-11-07 16:11:53 +0000
+++ scp/sc2020.py	2017-01-28 08:53:17 +0000
@@ -21,7 +21,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time, random

=== modified file 'scp/sc2030.py'
--- scp/sc2030.py	2016-05-21 12:42:32 +0000
+++ scp/sc2030.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, SelectChoice, Sql

=== modified file 'scp/sc3010.py'
--- scp/sc3010.py	2016-05-21 12:42:32 +0000
+++ scp/sc3010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'scp/scc210.py'
--- scp/scc210.py	2016-02-27 13:18:41 +0000
+++ scp/scc210.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, TartanDialog, Sql

=== modified file 'sls/si2010.py'
--- sls/si2010.py	2016-09-03 14:07:52 +0000
+++ sls/si2010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si2020.py'
--- sls/si2020.py	2016-05-21 12:42:32 +0000
+++ sls/si2020.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import copy, socket, sys, time, functools

=== modified file 'sls/si3010.py'
--- sls/si3010.py	2016-05-21 12:42:32 +0000
+++ sls/si3010.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3020.py'
--- sls/si3020.py	2016-02-27 13:18:41 +0000
+++ sls/si3020.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3030.py'
--- sls/si3030.py	2016-02-27 13:18:41 +0000
+++ sls/si3030.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3040.py'
--- sls/si3040.py	2016-02-27 13:18:41 +0000
+++ sls/si3040.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3050.py'
--- sls/si3050.py	2016-02-27 13:18:41 +0000
+++ sls/si3050.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3060.py'
--- sls/si3060.py	2016-02-27 13:18:41 +0000
+++ sls/si3060.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3070.py'
--- sls/si3070.py	2016-02-27 13:18:41 +0000
+++ sls/si3070.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3080.py'
--- sls/si3080.py	2016-05-21 12:42:32 +0000
+++ sls/si3080.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import PrintInvoice, Sql, TartanDialog

=== modified file 'sls/sic110.py'
--- sls/sic110.py	2016-02-27 13:18:41 +0000
+++ sls/sic110.py	2017-01-28 08:53:17 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'std/TartanClasses.py'
--- std/TartanClasses.py	2016-12-30 14:10:51 +0000
+++ std/TartanClasses.py	2017-02-22 07:51:56 +0000
@@ -8,14 +8,13 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 #========================================================
 # Standard Python modules
 #========================================================
 import calendar, csv, functools, glob, gzip, os, re, shutil, sys
 import tarfile, textwrap, threading, time, urllib2, webbrowser
-from pkgutil import iter_modules
 #========================================================
 # TARTAN Standard Functions and Variables e.g. showError
 #========================================================
@@ -27,6 +26,10 @@
 from tartanFunctions import projectDate, removeFunctions, sendMail, showError
 from tartanFunctions import showException, showPrinters, showWarning
 import tartanWork
+try:
+    from tarchg import changes
+except:
+    changes = None
 #========================================================
 # PyFPDF
 #========================================================
@@ -46,7 +49,11 @@
     XLRD = True
 except:
     XLRD = False
-XLWT = "xlwt" in (name for loader, name, ispkg in iter_modules())
+try:
+    import xlwt
+    XLWT = True
+except:
+    XLWT = False
 #========================================================
 # Openoffice import module
 #========================================================
@@ -2102,7 +2109,7 @@
     A class to manipulate databases.
 
     rcdic  - A dictionary having at least:
-                dbase:    The database API e.g. PgSQL
+                dbase:    The database interface e.g. PgSQL
                 dbname:   The database name
                 dbhost:   The database host (Not SQLite)
                 dbdir:    The directory containing the database (FBird/SQLite)
@@ -3492,12 +3499,13 @@
             self.err = "Invalid Date (DT)"
 
     def chkTM_Time(self):
-        tim = self.data.replace(":", "")
+        tim = self.data.replace(":", "").replace(".", "")
         if tim in ("", "0", "0000") and (self.types == "tM"):
             self.work = 0
             self.disp = "00:00"
             return
         if len(tim) > 4:
+            # Seconds
             tim = tim[:-2]
         try:
             if len(tim) < 1:
@@ -3915,7 +3923,7 @@
             sql.insRec(table, data=["admin", "System Administrator",
                 "", 0, "", 9])
 
-class TartanDialog:
+class TartanDialog(object):
     """
     Dialog for TARTAN Financial Systems
 
@@ -4159,7 +4167,11 @@
 
     view   =  An entry field asking whether you would like to view the report
               It is a tuple (csv, "D") where:
-                csv is whether to have an export facility
+                csv is whether to have an export facility:
+                    Y - Yes
+                    C - CSV only
+                    X - XLS only
+                    N - No
                 "D" is the default e.g. ("(V)iew", "(P)rint" or "(X)port")
               A list self.repprt is created having 3 fields as follows:
                 1) Y or N output widget created
@@ -4238,9 +4250,14 @@
                     self.butt.append(list(but))
             else:
                 setattr(self, arg, args[arg])
+        # Save window bindings
+        self.window = self.mf.window
+        self.svebind = []
+        for bind in self.window.bind():
+            if "<Key-Alt_L>" in bind:
+                self.svebind.append((bind, self.window.bind(bind)))
+                self.window.unbind(bind)
         # Set master frame
-        self.window = self.mf.window
-        self.svebind = self.window.bind()
         if self.screen:
             self.master = self.screen
         else:
@@ -4338,9 +4355,10 @@
          pdf viewer.
 
 Print  - The report will be printed on the selected printer."""
-                if self.view[0].lower() == "y":
-                    rvs.append(("Export CSV","C"))
-                    if XLWT:
+                if self.view[0].lower() in ("y", "c", "x"):
+                    if self.view[0].lower() in ("y", "c"):
+                        rvs.append(("Export CSV","C"))
+                    if XLWT and self.view[0].lower() in ("y", "x"):
                         rvs.append(("Export XLS","X"))
                     mes = """%s
 
@@ -6375,6 +6393,8 @@
                 return ("no", "Invalid %s, Not Found" % w)
         elif val[0] == "cmd":
             if not wrk:
+                return ("ok", )
+            if not getFileName(wrk, check=True):
                 return ("no", "Invalid %s" % des)
             return ("ex", wrk)
         elif val[0] == "file":
@@ -6765,6 +6785,9 @@
         except:
             pass
         self.mstFrame.destroy()
+        # Restore saved bindings
+        for bind in self.svebind:
+            self.window.bind(bind[0], bind[1])
         self.mf.rcdic["dfs"] = self.dfs
         self.mf.setThemeFont()
         self.mf.updateStatus("")
@@ -8119,9 +8142,9 @@
                 self.rcdic["prn"],"N",None,fle,None,("cmd",),None,
                 "The Path of the program to use for printing reports."),
             (("T",2,6,0),"IFF",50,"PS Converter","",
-                self.rcdic["cnv"],"N",None,fle,None,None,None,
+                self.rcdic["cnv"],"N",None,fle,None,("cmd",),None,
                 "The Path of the program to use for converting PDF to PS."),
-            (("T",2,7,0),"IFF",50,"CSV Reader","",
+            (("T",2,7,0),"IFF",50,"Spreadsheet Reader","",
                 self.rcdic["cnv"],"N",self.doExport,fle,None,None,None,
                 "The Path of the program to use for reading CSV and XLS "\
                 "files e.g. c:\Program Files\Microsoft Office\Office10"\
@@ -8474,9 +8497,15 @@
             ["prgdir", os.path.normpath(self.prgdir)],
             ["bupdir", os.path.normpath(self.bupdir)],
             ["wrkdir", os.path.normpath(self.wrkdir)],
-            ["upgdir", os.path.normpath(self.upgdir)],
-            ["vwr", os.path.normpath(self.df.t_work[2][0][4])],
-            ["prn", os.path.normpath(self.df.t_work[2][0][5])]])
+            ["upgdir", os.path.normpath(self.upgdir)]])
+        if self.df.t_work[2][0][4]:
+            cc.append(["vwr", os.path.normpath(self.df.t_work[2][0][4])])
+        else:
+            cc.append(["vwr", ""])
+        if self.df.t_work[2][0][4]:
+            cc.append(["prn", os.path.normpath(self.df.t_work[2][0][5])])
+        else:
+            cc.append(["prn", ""])
         if self.df.t_work[2][0][6]:
             cc.append(["cnv", os.path.normpath(self.df.t_work[2][0][6])])
         else:
@@ -15769,24 +15798,26 @@
             "comnd": self.selectNote}
         r1s = (("Normal", "N"), ("Urgent", "U"))
         fld = (
-            (("T",0,0,0),("IRB",r1s),0,"Action Flag","",
+            (("T",0,0,0),"ITV",(50,10),"Details","",
+                "","N",self.doNote,None,None,("notblank",)),
+            (("T",0,1,0),("IRB",r1s),0,"Action Flag","",
                 "N","N",self.doActFlag,None,None,None),
-            (("T",0,1,0),"I@not_adate",0,"","",
+            (("T",0,2,0),"I@not_adate",0,"","",
                 self.sysdtw,"N",self.doActDate,cal,None,("efld",)),
-            (("T",0,2,0),"I@not_auser",0,"","",
-                self.user,"N",self.doActUser,None,None,("efld",)),
-            (("T",0,3,0),"ITV",(50,10),"Details","",
-                "","N",self.doNote,None,None,("notblank",)))
+            (("T",0,3,0),"I@not_auser",0,"","",
+                self.user,"N",self.doActUser,None,None,("efld",)))
         tnd = ((self.doEnd,"y"), )
         txt = (self.doExit, )
         but = (
-            ("Save",None,self.doSave,0,("T",0, 3),("T",0,0)),
             ("Show",None,self.doShow,0,("T",0, 1),("T",0,2)),
-            ("Quit",None,self.doExit,1,None,None),
-            ("Cancel",None,self.doExit,0,("T",0, 2),None))
+            ("Cancel",None,self.doCancel,0,("T",0, 2),None),
+            ("Quit",None,self.doExit,1,None,None))
         self.df = TartanDialog(self.mf, title=tit, eflds=fld, tend=tnd,
             txit=txt, butt=but)
 
+    def doNote(self, frt, pag, r, c, p, i, w):
+        self.note = w
+
     def doActFlag(self, frt, pag, r, c, p, i, w):
         self.actflag = w
 
@@ -15879,13 +15910,6 @@
         self.nf.closeProcess()
         self.mf.closeLoop()
 
-    def doSave(self, widget=None):
-        wid, self.note = self.df.getEntry("T", 0, 3)
-        self.doEnd()
-
-    def doNote(self, frt, pag, r, c, p, i, w):
-        self.note = w
-
     def doEnd(self, widget=None):
         self.df.closeProcess()
         self.sql.insRec("ctlnot", data=[self.conum, self.sys, self.key,
@@ -15896,6 +15920,10 @@
         self.dbm.closeDbase()
         self.mf.closeLoop()
 
+    def doCancel(self, widget=None):
+        self.df.clearFrame("T", 0)
+        self.df.focusField("T", 0, 1)
+
     def doExit(self, widget=None):
         self.df.closeProcess()
         self.mf.closeLoop()
@@ -15920,6 +15948,7 @@
         tit = ("%03i %s" % (self.conum, self.conam),
             "%s Masterfile Notes" % tartanWork.finsys[self.sys][0])
         r1s = (("All", "A"), ("Normal", "N"), ("Urgent", "U"))
+        r2s = (("Account", "A"), ("Capture", "B"), ("Action", "C"))
         fld = (
             (("T",0,0,0),("IRB",r1s),0,"Action Flag","",
                 "A","N",self.doFlag,None,None,None),
@@ -15930,7 +15959,9 @@
             (("T",0,3,0),"I@not_adate",0,"From Action Date","",
                 "","N",self.doFADate,None,None,("efld",)),
             (("T",0,4,0),"I@not_adate",0,"To   Action Date","",
-                "","N",self.doTADate,None,None,("efld",)))
+                "","N",self.doTADate,None,None,("efld",)),
+            (("T",0,5,0),("IRB",r2s),0,"Order By","",
+                "A","N",self.doOrder,None,None,None))
         tnd = ((self.doEnd,"y"), )
         txt = (self.doExit, )
         self.df = TartanDialog(self.mf, title=tit, eflds=fld, tend=tnd,
@@ -15958,6 +15989,9 @@
             return "Invalid Date, Earlier than From Date"
         self.tadate = w
 
+    def doOrder(self, frt, pag, r, c, p, i, w):
+        self.order = w
+
     def doEnd(self, widget=None):
         self.df.closeProcess()
         tab = ["ctlnot"]
@@ -15972,7 +16006,12 @@
         whr.append(("not_adate", ">=", self.fadate))
         if self.tadate:
             whr.append(("not_adate", "<=", self.tadate))
-        odr = "not_key, not_date, not_seq"
+        if self.order == "A":
+            odr = "not_key, not_date desc, not_seq"
+        elif self.order == "B":
+            odr = "not_date desc, not_key, not_seq"
+        else:
+            odr = "not_adate desc, not_key, not_seq"
         self.data = self.sql.getRec(tables=tab, where=whr, order=odr)
         if not self.data:
             showError(self.mf.body, "Error", "No Notes Selected")
@@ -17066,7 +17105,10 @@
         label.configure(state="disabled")
         bbox = MyButtonBox(self.about, row=1)
         self.b0 = bbox.addButton("Licence", self.licenceAbout)
-        self.b1 = bbox.addButton("Changes", self.changesAbout)
+        if changes:
+            self.b1 = bbox.addButton("Changes", self.changesAbout)
+        else:
+            self.b1 = None
         self.b2 = bbox.addButton("Exit", self.exitAbout)
         self.mf.startLoop()
 
@@ -17085,11 +17127,7 @@
         self.b1.configure(state="disabled")
         self.b2.configure(state="disabled")
         self.about.place_forget()
-        try:
-            from tarchg import changes
-            ScrollText(scrn=self.mf.window, mess=changes)
-        except:
-            pass
+        ScrollText(scrn=self.mf.window, mess=changes)
         self.about.place(anchor="center", relx=0.5, rely=0.5)
         self.b0.configure(state="normal")
         self.b1.configure(state="normal")
@@ -17097,7 +17135,8 @@
 
     def licenceAbout(self, *args):
         self.b0.configure(state="disabled")
-        self.b1.configure(state="disabled")
+        if self.b1:
+            self.b1.configure(state="disabled")
         self.b2.configure(state="disabled")
         self.about.place_forget()
         docfle = os.path.join(self.mf.rcdic["prgdir"], "doc", "tarlic.rst")
@@ -17109,7 +17148,8 @@
             ScrollText(scrn=self.mf.window, mess=mess, wrap=True)
             self.about.place(anchor="center", relx=0.5, rely=0.5)
         self.b0.configure(state="normal")
-        self.b1.configure(state="normal")
+        if self.b1:
+            self.b1.configure(state="normal")
         self.b2.configure(state="normal")
 
     def exitAbout(self, *args):

=== modified file 'std/tartanFunctions.py'
--- std/tartanFunctions.py	2016-12-30 14:10:51 +0000
+++ std/tartanFunctions.py	2017-02-25 09:25:42 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from __future__ import generators
@@ -108,10 +108,7 @@
     except:
         user = ""
     prgdir = getPrgPath()
-    if sys.platform == "win32":
-        homedir = os.path.normpath("C:/Tartan")
-    else:
-        homedir = os.path.join(os.path.expanduser("~"), "Tartan")
+    homedir = os.path.dirname(prgdir)
     opts = {
         "dbase": ["SQLite"],
         "dbname": ["tartan"],
@@ -271,18 +268,27 @@
     xits = A command to be executed on exiting the exception frame
     dbm  = The database class
     """
-    import getpass, os, sys, time, traceback
+    import getpass, os, platform, sys, time, traceback
     from TartanClasses import ScrollText
 
     def doSaveExc():
         t = time.localtime()
         t = time.strftime("Date: %Y-%m-%d Time: %H:%M:%S", t)
+        if sys.platform == "win32":
+            import win32api
+            host = win32api.GetComputerName()
+            user = win32api.GetUserName()
+        else:
+            host = os.uname()[1]
+            user = getpass.getuser()
+        onam = platform.platform()
         fnam = os.path.join(path, "errors.txt")
         if os.path.isfile(fnam):
             flenam = open(fnam, "a")
         else:
             flenam = open(fnam, "w")
-        flenam.write(t + "\n\n" + getpass.getuser() + "\n\n")
+        flenam.write(t + "\n\n" + onam + "\n\n")
+        flenam.write("Host: %s User: %s" % (host, user) + "\n\n")
         flenam.write(mess + "\n")
         flenam.write("*******************************" + "\n")
         flenam.close()
@@ -294,13 +300,6 @@
             else:
                 opened = True
             try:
-                if sys.platform == "win32":
-                    import win32api
-                    host = win32api.GetComputerName()
-                    user = win32api.GetUserName()
-                else:
-                    host = os.uname()[1]
-                    user = getpass.getuser()
                 tab = ["ctlmst", "ctlsys", "verupd"]
                 sql = Sql(dbm, tables=tab, prog=__name__)
                 if sql.error:
@@ -577,14 +576,17 @@
             pass
         if repeml[4].lower() == "n":
             return
-    # Print Document
+    # Print/View Document
     try:
         if repprt and (repprt[1].lower() == "x" or repprt[2] == "export"):
             return
         if repprt and (repprt[1].lower() == "v" or repprt[2] == "view"):
             # Execute viewer command
-            exe, cmd = parsePrg(mf.rcdic["vwr"])
-            if not os.path.exists(cmd[0]):
+            vwr = mf.rcdic["vwr"]
+            if sys.platform == "win32" and not os.path.exists(vwr):
+                vwr = os.path.join(getPrgPath(), "uty", "SumatraPDF.exe")
+            exe, cmd = parsePrg(vwr)
+            if not os.path.isfile(cmd[0]):
                 raise Exception
             cmd.append(pdfnam)
             os.spawnv(os.P_WAIT, exe, tuple(cmd))
@@ -592,16 +594,23 @@
             if splash:
                 sp = SplashScreen(mf.body,
                     "Printing the Report\n\n           Please Wait....")
-            if not mf.rcdic["cnv"]:
-                pfl = pdfnam
-            else:
+            cnv = mf.rcdic["cnv"]
+            prn = mf.rcdic["prn"]
+            if sys.platform == "win32" and not os.path.exists(prn):
+                cnv = ""
+                prn = os.path.join(getPrgPath(), "uty", "SumatraPDF.exe")
+            if cnv:
                 # Convert pdf to ps
                 exe, cmd = parsePrg(mf.rcdic["cnv"])
                 cmd.append(pdfnam)
                 pfl = pdfnam.replace(".pdf", ".ps")
                 cmd.append(pfl)
                 os.spawnv(os.P_WAIT, exe, tuple(cmd))
-            exe, cmd = parsePrg(mf.rcdic["prn"])
+            else:
+                pfl = pdfnam
+            exe, cmd = parsePrg(prn)
+            if not os.path.isfile(cmd[0]):
+                raise Exception
             if sys.platform == "win32":
                 # Windows
                 if repprt[2] == "Default":
@@ -715,6 +724,16 @@
         from email.mime.multipart import MIMEMultipart
         from email.utils import COMMASPACE, formatdate
 
+    def mysubj(subj):
+        words = subj.split()
+        subj = ""
+        for word in words:
+            if not subj:
+                subj = word[0].upper() + word[1:].lower()
+            else:
+                subj = "%s %s" % (subj, word[0].upper() + word[1:].lower())
+        return subj
+
     host, port, secu, auth, unam, upwd = server
     if not local:
         local = socket.getfqdn()
@@ -748,13 +767,13 @@
         subj = subj[4:]
     except:
         subj = subj
-    subj = subj.replace("'", "").replace("(", " ").replace(")", " ").title()
+    subj = subj.replace("'", "").replace("(", " ").replace(")", " ")
     if not mess:
         if attach:
             mess = "Attached please find:\n\n%s" % subj
         else:
             mess = subj
-    msgRoot["Subject"] = subj.replace("'", "").title()
+    msgRoot["Subject"] = mysubj(subj)
     msgRelated = MIMEMultipart("related")
     msgRoot.attach(msgRelated)
     msgAlternative = MIMEMultipart("alternative")
@@ -1000,7 +1019,7 @@
 
 def getUnderline(widget=None, blist=None, text=None):
     """
-    used  = dictionary name to use
+    blist = dictionary name to use
     text  = text to find underline for
     """
     if not text:
@@ -1016,7 +1035,7 @@
                 c = bind.split("<Key-Alt_L>")[1].upper()
                 if not c in used:
                     used.append(c)
-    else:
+    elif blist:
         # Menu bindings
         used = blist
     if "_" in text:
@@ -1280,7 +1299,7 @@
             return "Missing Control Record - assctl"
         if ctl["cta_glint"] == "Y":
             if not "ass_sls" in ctlctl:
-                return "Missing Control - ass_ctl"
+                return "Missing Control - ass_sls"
             ctlacc.append(ctlctl["ass_sls"])
             sql = Sql(mf.dbm, "assgrp", prog=__name__)
             ass = sql.getRec(tables="assgrp", cols=["asg_assacc",
@@ -2444,7 +2463,7 @@
     if fpdf.cur_orientation == "P":
         mx = .80
     else:
-        mx = .75
+        mx = .70
     sy = int(fpdf.get_y()) + 1              # Initial y value
     ch = (fpdf.h * mx) - sy                 # Chart height
     vb = (maxs - mins) / vi                 # Vertical blocks
@@ -2478,18 +2497,23 @@
     hw = int(cw / len(xcol))
     hh = ch / (maxs - mins)
     for num, tab in enumerate(xcol):
+        pad = lt / 2
         txt = "%12s" % tab
         if vals[num] < 0:
-            y1 = zy + (lt / 2)
             y2 = 0 - vals[num]
-            y2 = y1 + (hh * y2) - (lt / 2)
+            y2 = zy + (hh * y2) - pad
+            y1 = zy + pad
+            if y2 < y1:
+                y2 = y1
         else:
             y1 = vals[num]
-            y1 = zy - (hh * y1) + (lt / 2)
-            y2 = zy - (lt / 2)
+            y1 = zy - (hh * y1) + pad
+            y2 = zy - pad
+            if y1 > y2:
+                y1 = y2
         fpdf.line(lm+10+(num*hw), y1, lm+10+(num*hw), y2)
-        fpdf.rotate(50, x=lm+(num*hw)-5, y=ly+fpdf.get_string_width(txt))
-        fpdf.drawText(txt=txt, x=lm+(num*hw)-5, y=ly+fpdf.get_string_width(txt))
+        fpdf.rotate(55, x=lm+(num*hw)-7, y=ly+fpdf.get_string_width(txt))
+        fpdf.drawText(txt=txt, x=lm+(num*hw)-7, y=ly+fpdf.get_string_width(txt))
         fpdf.rotate(0)
     # Target Line
     if tgt:

=== modified file 'std/tartanWork.py'
--- std/tartanWork.py	2016-05-21 12:42:32 +0000
+++ std/tartanWork.py	2017-02-23 10:21:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 #--------
@@ -541,7 +541,17 @@
             [293600, 61296, 31],
             [188000, 33840, 26],
             [0, 0, 18]],
-        "allow": [13500, 7407, 2466, 0]}}
+        "allow": [13500, 7407, 2466, 0]},
+    "2018": {
+        "rates": [
+            [1500000, 533625, 45],
+            [708310, 209032, 41],
+            [555600, 149475, 39],
+            [410460, 97225, 36],
+            [296540, 61910, 31],
+            [189880, 34178, 26],
+            [0, 0, 18]],
+        "allow": [13635, 7479, 2493, 0]}}
 siteRates = {
     "2004": 60000,
     "2005": 60000,
@@ -556,7 +566,8 @@
     "2014": 0,
     "2015": 0,
     "2016": 0,
-    "2017": 0}
+    "2017": 0,
+    "2018": 0}
 uifRates = {
     "2004": [1.00, 1.00],
     "2005": [1.00, 1.00],
@@ -571,7 +582,8 @@
     "2014": [1.00, 1.00],
     "2015": [1.00, 1.00],
     "2016": [1.00, 1.00],
-    "2017": [1.00, 1.00]}
+    "2017": [1.00, 1.00],
+    "2018": [1.00, 1.00]}
 sdlRates = {
     "2004": [0.00, 1.00],
     "2005": [0.00, 1.00],
@@ -586,7 +598,8 @@
     "2014": [0.00, 1.00],
     "2015": [0.00, 1.00],
     "2016": [0.00, 1.00],
-    "2017": [0.00, 1.00]}
+    "2017": [0.00, 1.00],
+    "2018": [0.00, 1.00]}
 # Labels
 labels = {
     "L7159": {

=== modified file 'std/tartanWork_rne.py'
--- std/tartanWork_rne.py	2016-05-21 12:42:32 +0000
+++ std/tartanWork_rne.py	2017-01-28 08:53:18 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 #--------

=== removed file 'stddia.py'
--- stddia.py	2016-02-27 13:18:41 +0000
+++ stddia.py	1970-01-01 00:00:00 +0000
@@ -1,87 +0,0 @@
-"""
-SYNOPSIS
-    Standard Dialog.
-
-    This file is part of Tartan Financial Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2015 Paul Malherbe.
-"""
-
-from TartanClasses import Sql, TartanDialog
-
-class stddia:
-    def __init__(self, **opts):
-        self.opts = opts
-        if self.setVariables():
-            self.mainProcess()
-            self.opts["mf"].startLoop()
-
-    def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["ctldep"], prog=__name__)
-        if self.sql.error:
-            return
-        return True
-
-    def mainProcess(self):
-        tit = ("%03i %s" % (self.opts["conum"], self.opts["conam"]),
-            "Department Records Maintenance")
-        dep = {
-            "stype": "R",
-            "tables": ("ctldep",),
-            "cols": (
-                ("dep_code", "", 0, "Cod"),
-                ("dep_name", "", 0, "Name")),
-            "where": [("dep_cono", "=", self.opts["conum"])]}
-        fld = (
-            (("T",0,0,0),"I@dep_code",0,"","",
-                "","N",self.doDepCod,dep,None,("notblank",)),
-            (("T",0,1,0),"I@dep_name",0,"","",
-                "","N",self.doDepName,None,None,("notblank",)))
-        tnd = ((self.doEnd,"y"),)
-        txt = (self.doExit,)
-        self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
-            eflds=fld, tend=tnd, txit=txt)
-
-    def doDepCod(self, frt, pag, r, c, p, i, w):
-        self.dept = w
-        acc = self.sql.getRec(tables="ctldep", where=[("dep_cono", "=",
-            self.opts["conum"]), ("dep_code", "=", self.dept)], limit=1)
-        if not acc:
-            return "Invalid Department"
-        self.df.loadEntry(frt, pag, p+1,
-            data=acc[self.sql.ctldep_col.index("dep_name")])
-
-    def doDepName(self, frt, pag, r, c, p, i, w):
-        self.name = w
-
-    def doEnd(self):
-        #######################################
-        # Once off routines e.g. Reports
-        #######################################
-        #self.df.closeProcess()
-        # Print the Report
-        #self.opts["mf"].closeLoop()
-        #######################################
-        # Repetitive routines e.g. Data Capture
-        #######################################
-        # Capture an Entry
-        # Loop for Next Entry
-        self.df.focusField("T", 0, 1)
-        #######################################
-
-    def doExit(self):
-        self.df.closeProcess()
-        self.opts["mf"].closeLoop()
-
-if __name__ == "__main__":
-    from TartanClasses import Dbase, MainFrame
-    mf = MainFrame()
-    mf.dbm = Dbase(rcdic=mf.rcdic)
-    mf.dbm.openDbase()
-    rpt = stddia(**{"mf": mf, "conum": 1, "conam": "Company One"})
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== added file 'stddia.py'
--- stddia.py	1970-01-01 00:00:00 +0000
+++ stddia.py	2017-02-20 09:29:56 +0000
@@ -0,0 +1,87 @@
+"""
+SYNOPSIS
+    Standard Dialog.
+
+    This file is part of Tartan Financial Systems (TARTAN).
+
+AUTHOR
+    Written by Paul Malherbe, <paul@tartan.co.za>
+
+COPYING
+    Copyright (C) 2004-2017 Paul Malherbe.
+"""
+
+from TartanClasses import Sql, TartanDialog
+
+class stddia:
+    def __init__(self, **opts):
+        self.opts = opts
+        if self.setVariables():
+            self.mainProcess()
+            self.opts["mf"].startLoop()
+
+    def setVariables(self):
+        self.sql = Sql(self.opts["mf"].dbm, ["ctldep"], prog=__name__)
+        if self.sql.error:
+            return
+        return True
+
+    def mainProcess(self):
+        tit = ("%03i %s" % (self.opts["conum"], self.opts["conam"]),
+            "Department Records Maintenance")
+        dep = {
+            "stype": "R",
+            "tables": ("ctldep",),
+            "cols": (
+                ("dep_code", "", 0, "Cod"),
+                ("dep_name", "", 0, "Name")),
+            "where": [("dep_cono", "=", self.opts["conum"])]}
+        fld = (
+            (("T",0,0,0),"I@dep_code",0,"","",
+                "","N",self.doDepCod,dep,None,("notblank",)),
+            (("T",0,1,0),"I@dep_name",0,"","",
+                "","N",self.doDepName,None,None,("notblank",)))
+        tnd = ((self.doEnd,"y"),)
+        txt = (self.doExit,)
+        self.df = TartanDialog(self.opts["mf"], tops=False, title=tit,
+            eflds=fld, tend=tnd, txit=txt)
+
+    def doDepCod(self, frt, pag, r, c, p, i, w):
+        self.dept = w
+        acc = self.sql.getRec(tables="ctldep", where=[("dep_cono", "=",
+            self.opts["conum"]), ("dep_code", "=", self.dept)], limit=1)
+        if not acc:
+            return "Invalid Department"
+        self.df.loadEntry(frt, pag, p+1,
+            data=acc[self.sql.ctldep_col.index("dep_name")])
+
+    def doDepName(self, frt, pag, r, c, p, i, w):
+        self.name = w
+
+    def doEnd(self):
+        #######################################
+        # Once off routines e.g. Reports
+        #######################################
+        #self.df.closeProcess()
+        # Print the Report
+        #self.opts["mf"].closeLoop()
+        #######################################
+        # Repetitive routines e.g. Data Capture
+        #######################################
+        # Capture an Entry
+        # Loop for Next Entry
+        self.df.focusField("T", 0, 1)
+        #######################################
+
+    def doExit(self):
+        self.df.closeProcess()
+        self.opts["mf"].closeLoop()
+
+if __name__ == "__main__":
+    from TartanClasses import Dbase, MainFrame
+    mf = MainFrame()
+    mf.dbm = Dbase(rcdic=mf.rcdic)
+    mf.dbm.openDbase()
+    rpt = stddia(**{"mf": mf, "conum": 1, "conam": "Company One"})
+
+# vim:set ts=4 sw=4 sts=4 expandtab:

=== modified file 'str/st1010.py'
--- str/st1010.py	2016-11-07 16:11:53 +0000
+++ str/st1010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st1020.py'
--- str/st1020.py	2016-02-27 13:18:41 +0000
+++ str/st1020.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/st2010.py'
--- str/st2010.py	2016-12-30 14:10:51 +0000
+++ str/st2010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st2020.py'
--- str/st2020.py	2016-12-30 14:10:51 +0000
+++ str/st2020.py	2017-02-22 07:33:25 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -455,7 +455,7 @@
         state = self.df.disableButtonsTags()
         self.tx = TartanDialog(self.opts["mf"], title=tit, tops=True,
             eflds=fld, tend=((self.doRepEnd, "n"),), txit=(self.doRepExit,),
-            view=("N","V"), mail=("Y","N"))
+            view=("Y","V"), mail=("Y","N"))
         self.opts["mf"].startLoop()
         self.df.enableButtonsTags(state=state)
         self.df.focusField(self.df.frt, self.df.pag, self.df.col)

=== modified file 'str/st2030.py'
--- str/st2030.py	2016-05-21 12:42:32 +0000
+++ str/st2030.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st2040.py'
--- str/st2040.py	2016-02-27 13:18:41 +0000
+++ str/st2040.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3010.py'
--- str/st3010.py	2016-02-27 13:18:41 +0000
+++ str/st3010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3020.py'
--- str/st3020.py	2016-02-27 13:18:41 +0000
+++ str/st3020.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3030.py'
--- str/st3030.py	2016-02-27 13:18:41 +0000
+++ str/st3030.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3040.py'
--- str/st3040.py	2016-02-27 13:18:41 +0000
+++ str/st3040.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3050.py'
--- str/st3050.py	2016-02-27 13:18:41 +0000
+++ str/st3050.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3060.py'
--- str/st3060.py	2016-02-27 13:18:41 +0000
+++ str/st3060.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3070.py'
--- str/st3070.py	2016-02-27 13:18:41 +0000
+++ str/st3070.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3080.py'
--- str/st3080.py	2016-02-27 13:18:41 +0000
+++ str/st3080.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3090.py'
--- str/st3090.py	2016-02-27 13:18:41 +0000
+++ str/st3090.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3100.py'
--- str/st3100.py	2016-02-27 13:18:41 +0000
+++ str/st3100.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'str/st3110.py'
--- str/st3110.py	2016-02-27 13:18:41 +0000
+++ str/st3110.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3120.py'
--- str/st3120.py	2016-02-27 13:18:41 +0000
+++ str/st3120.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st4010.py'
--- str/st4010.py	2016-02-27 13:18:41 +0000
+++ str/st4010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5010.py'
--- str/st5010.py	2016-02-27 13:18:41 +0000
+++ str/st5010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5020.py'
--- str/st5020.py	2016-09-03 14:07:52 +0000
+++ str/st5020.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5030.py'
--- str/st5030.py	2016-02-27 13:18:41 +0000
+++ str/st5030.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5040.py'
--- str/st5040.py	2016-05-21 12:42:32 +0000
+++ str/st5040.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st6010.py'
--- str/st6010.py	2016-02-27 13:18:41 +0000
+++ str/st6010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'str/st6020.py'
--- str/st6020.py	2016-02-27 13:18:41 +0000
+++ str/st6020.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st6030.py'
--- str/st6030.py	2016-09-03 14:07:52 +0000
+++ str/st6030.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc110.py'
--- str/stc110.py	2016-02-27 13:18:41 +0000
+++ str/stc110.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc210.py'
--- str/stc210.py	2016-02-27 13:18:41 +0000
+++ str/stc210.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'str/stc220.py'
--- str/stc220.py	2016-02-27 13:18:41 +0000
+++ str/stc220.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc310.py'
--- str/stc310.py	2016-02-27 13:18:41 +0000
+++ str/stc310.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/stc320.py'
--- str/stc320.py	2016-02-27 13:18:41 +0000
+++ str/stc320.py	2017-02-22 07:35:27 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -46,7 +46,7 @@
         tnd = ((self.doEnd,"Y"), )
         txt = (self.closeProcess, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"))
+            txit=txt, view=("Y","V"))
 
     def doEnd(self):
         heads = ["Product Groups Master Listing"]

=== modified file 'str/stc410.py'
--- str/stc410.py	2016-02-27 13:18:41 +0000
+++ str/stc410.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/stc420.py'
--- str/stc420.py	2016-02-27 13:18:41 +0000
+++ str/stc420.py	2017-02-22 07:36:02 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -36,7 +36,7 @@
         tnd = ((self.doEnd,"Y"), )
         txt = (self.closeProcess, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"))
+            txit=txt, view=("Y","V"))
 
     def doEnd(self):
         tables = ["strloc"]

=== modified file 'tab/tb1010.py'
--- tab/tb1010.py	2016-02-27 13:18:41 +0000
+++ tab/tb1010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os

=== modified file 'tab/tb1020.py'
--- tab/tb1020.py	2016-09-03 14:07:52 +0000
+++ tab/tb1020.py	2017-02-16 12:42:05 +0000
@@ -25,7 +25,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import csv, os, sys, time
@@ -56,10 +56,12 @@
             self.doProcessTables()
             if self.oldver[0] and self.oldver[0] < 5:
                 self.doWagCal()
-            self.doBwlSkp()
+            if self.dbm.checkTable("bwlskp"):
+                self.doBwlSkp()
             if self.opts["cln"]:
                 self.doCleanDatabase()
-            self.doBwlPts()
+            if self.bwltyp and len(self.bwltyp[0]) != 15:
+                self.doBwlPts()
             if self.opts["ver"]:
                 sql = Sql(self.dbm, "verupd", prog=__name__)
                 if not sql.getRec(tables="verupd"):
@@ -669,8 +671,6 @@
             spl.closeSplash()
 
     def doBwlSkp(self):
-        if not self.dbm.checkTable("bwlskp"):
-            return
         sql = Sql(self.dbm, ["bwlctl", "bwltab", "bwldrt", "bwlskp"],
             prog=__name__)
         scc = sql.bwlskp_col
@@ -692,8 +692,6 @@
         self.dbm.commitDbase()
 
     def doBwlPts(self):
-        if not self.bwltyp or len(self.bwltyp[0]) == 15:
-            return
         sql = Sql(self.dbm, "bwlpts", prog=__name__)
         for rec in self.bwltyp:
             data = rec[:2]
@@ -919,6 +917,7 @@
     -d [directory]  = Directory where .csv files are, defaults to "~/prg/csv"
     -f              = Force update of all records in a table
     -h              = Display Usage
+    -i              = Reindex a table
     -p [password]   = Database Admin Password
     -r [file]       = tartanrc file to use, defaults to ~/.tartanrc
     -s [system]     = system module to use, defaults to stdsys

=== modified file 'tab/tb1030.py'
--- tab/tb1030.py	2016-02-27 13:18:41 +0000
+++ tab/tb1030.py	2017-01-28 08:53:18 +0000
@@ -11,7 +11,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, SChoice, Sql, TartanDialog

=== modified file 'tab/tb1040.py'
--- tab/tb1040.py	2016-09-03 14:07:52 +0000
+++ tab/tb1040.py	2017-01-28 08:53:18 +0000
@@ -11,7 +11,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, sys

=== modified file 'tab/tb3010.py'
--- tab/tb3010.py	2016-02-27 13:18:41 +0000
+++ tab/tb3010.py	2017-01-28 08:53:18 +0000
@@ -11,7 +11,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'uty/bm1010.py'
--- uty/bm1010.py	2016-06-22 08:28:55 +0000
+++ uty/bm1010.py	2017-01-31 08:36:03 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import csv, glob, imghdr, os, sys, time, urllib
@@ -369,11 +369,15 @@
             if self.dtyp == "S":
                 fld.append(
                     (("T",0,2,0),"IUI",3,"Mobile Column","",
-                        0,"N",self.doFltEC,None,None,("efld",)))
+                        0,"N",self.doFltEC,None,None,("efld",),None,
+                        "The column number, starting with 0, containing "\
+                        "the Mobile Number of the recipient."))
             else:
                 fld.append(
                     (("T",0,2,0),"IUI",3,"Email Address Column","",
-                        0,"N",self.doFltEC,None,None,("efld",)))
+                        0,"N",self.doFltEC,None,None,("efld",),None,
+                        "The column number, starting with 0, containing "\
+                        "the Email Address of the recipient."))
             fld.extend([
                 (("T",0,3,0),("IRB",r1s),0,"Personalize","",
                     "N","N",self.doFltPP,None,None,None),

=== modified file 'uty/fc1010.py'
--- uty/fc1010.py	2016-02-27 13:18:41 +0000
+++ uty/fc1010.py	2017-01-28 08:53:18 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog

=== added file 'uty/my2to3.py'
--- uty/my2to3.py	1970-01-01 00:00:00 +0000
+++ uty/my2to3.py	2017-02-17 08:25:21 +0000
@@ -0,0 +1,108 @@
+#!/usr/bin/python
+import sys
+
+for flenam in sys.argv[1:]:
+    ifle = open(flenam, "r")
+    lines = ifle.readlines()
+    ifle.close()
+    ofle = open(flenam, "w")
+    tb = False
+    bl = False
+    asd = False
+    rnd = False
+    for line in lines:
+        if flenam[:3] == "csv":
+            ofle.write(line.replace('"UL"', '"UI"'))
+            continue
+        elif line.count("from __future__ import generators"):
+            bl = True
+            continue
+        elif bl:
+            bl = False
+            continue
+        elif line.count('"""') == 2:
+            ofle.write(line)
+        elif line.count('"""') == 1:
+            if tb:
+                tb = False
+            else:
+                tb = True
+            ofle.write(line)
+        elif not line.strip() or line.strip()[0] == "#":
+            ofle.write(line)
+        elif not tb and flenam == "ms0000.py" and line.count("import getopt"):
+            ofle.write(line)
+            ofle.write("""
+# Ensure that python 3 is being used
+if not sys.version[0] >= "3":
+    print "Invalid Python Version, Must be >= 3"
+    sys.exit()
+""")
+        elif not tb and line.strip()[:6] == "class ":
+            ofle.write(line)
+            if line.count("ASD"):
+                asd = True
+            else:
+                asd = False
+        elif not tb and line.count("data[0].replace"):
+            ofle.write(line.replace("data[0].replace", 'data[0].decode("utf=8").replace'))
+        elif not tb and line.count("zipfle.write"):
+            ofle.write(line.replace("(data)", '(data).encode("utf-8")'))
+        elif not tb and line.count("base64."):
+            ofle.write(line.replace("string(txt)", 'bytes(txt.encode("utf-8")).decode("utf-8")'))
+        elif not rnd and line.count("round(") and not line.count('"round('):
+                ofle.write(line)
+                br = 0
+                for c in line:
+                    if c in ("(", "["):
+                        br += 1
+                    elif c in (")", "]"):
+                        br -= 1
+                if br:
+                    rnd = True
+        elif rnd:
+            ofle.write(line)
+            rnd = False
+        elif not tb and not asd and line.count("/") and not line.count(".0") and not line.count("int(") and not line.count('"SD"'):
+            nl = ""
+            sp = False
+            db = False
+            pr = False
+            for c in line:
+                if c == '"':
+                    if db:
+                        db = False
+                    else:
+                        db = True
+                    nl += c
+                    sp = False
+                    continue
+                if db:
+                    nl += c
+                    sp = False
+                    continue
+                if c == " ":
+                    sp = True
+                    nl += c
+                    continue
+                if c == "/":
+                    pr = True
+                    if sp:
+                        nl = nl + c + c
+                    else:
+                        nl = nl + " " + c + c + " "
+                    sp = False
+                else:
+                    nl += c
+                    sp = False
+            if pr:
+                ofle.write(nl)
+            else:
+                ofle.write(line)
+        elif not tb and line.count("long("):
+            ofle.write(line.replace("long(", "int("))
+        elif not tb and line.count("xrange("):
+            ofle.write(line.replace("xrange(", "range("))
+        else:
+            ofle.write(line)
+    ofle.close()

=== modified file 'uty/pkgprg.py'
--- uty/pkgprg.py	2016-11-07 16:11:53 +0000
+++ uty/pkgprg.py	2017-02-18 07:35:43 +0000
@@ -91,7 +91,7 @@
     exclude = ["sc2010", "sc2030", "sc1010", "sc2020", "sc3010", "scc210",
                "tb1010", "tb1030", "tb1040", "tb3010", "ms1020", "ms1030",
                "ms3010", "ms3020", "msy010", "msy020", "msy030", "pm1010",
-               "pw1010"]
+               "fc1010", "pw1010", "ss1010"]
 elif system == "c":
     if publish or verinc:
         exeCmd("mv %s/TartanExe/Cshana_5.* %s/TartanOld/" % (bd, bd))
@@ -101,7 +101,7 @@
     chgfle = "tarchg"
     dirs.extend(["csh", "gen"])
     custom = [""]
-    exclude = ["tb1010", "tb1030", "tb1040", "tb3010", "pm1010", "pw1010"]
+    exclude = ["tb1010", "tb1030", "tb1040", "tb3010", "msy030"]
 elif system == "k":
     if publish or verinc:
         exeCmd("mv %s/TartanExe/Bksclb_5.* %s/TartanOld/" % (bd, bd))
@@ -125,8 +125,8 @@
     custom = ["rne", ["ar6020", "ar6030", "cr1010", "cr2010", "cr2020",
               "cr2030", "cr3030", "cr3070", "cr3310", "cr3320", "cr3330",
               "cr3340", "cr3350", "cr3360", "cr3370", "cr3380", "cr4010",
-              "cr6010", "gl3100", "gl3110", "gl3120", "gl3130", "gl6060",
-              "glc310", "glc410", "glc510", "ln2020", "ms1010", "tartanWork"]]
+              "cr6010", "gl3100", "gl3110", "gl3120", "gl3130", "glc310",
+              "glc410", "glc510", "ln2020", "ms1010", "tartanWork"]]
     exclude = ["cr3080", "dr1020", "dr2030", "dr6030", "drc210", "drc220",
                "drc310", "drc320", "drc510", "drc520", "drc610", "drc620",
                "drc710", "drc810", "msy020", "si2020", "si3010", "si3070",
@@ -146,8 +146,7 @@
     dirs.extend(["scp"])
     custom = ["oth", ["ms1010"]]
     exclude = ["tb1010", "tb1030", "tb1040", "tb3010", "ms1020", "ms1030",
-               "ms3010", "ms3020", "ms3030", "msy010", "msy020", "msy030",
-               "pm1010", "pw1010"]
+               "ms3010", "ms3020", "ms3030", "msy010", "msy020", "msy030"]
 elif system == "t":
     if publish or verinc:
         exeCmd("mv %s/TartanExe/Tartan_5.?.?.tgz %s/TartanOld/" % (bd, bd))
@@ -172,7 +171,7 @@
         else:
             vinc = "n"
         if vinc.lower() == "y":
-            ver[2] = ver[2] + 1
+            ver[2] += 1
             newver = "%s.%s.%s" % (ver[0], ver[1], ver[2])
     else:
         ver = list(newver.split("."))
@@ -294,22 +293,21 @@
 std = []
 rpt = []
 
-os.chdir(os.path.join(pypath, "std"))
-#cmd = "find fdb fpdf ghostscript nmb odf progressbar pyasn1 simpleodspy smb xlrd xlwt"
-cmd = "find fpdf ghostscript"
-if system in ("tartan", "rnehol"):
-    cmd += " pychart"
-if system == "rnehol":
-    cmd += " paramiko"
-proc = subprocess.Popen(cmd + " -name '*.py'", shell=True, bufsize=0,
-                        stdin=subprocess.PIPE, stdout=subprocess.PIPE,
-                        close_fds=True)
-lst = proc.stdout.readlines()
-for x in lst:
-    t = x.split("/")
-    if t[1] in ("demos", "docs", "test"):
-        continue
-    rpt.append(x.rstrip())
+#os.chdir(os.path.join(pypath, "std"))
+#cmd = "find fpdf ghostscript"
+#if system in ("tartan", "rnehol"):
+#    cmd += " pychart"
+#if system == "rnehol":
+#    cmd += " paramiko"
+#proc = subprocess.Popen(cmd + " -name '*.py'", shell=True, bufsize=0,
+#                        stdin=subprocess.PIPE, stdout=subprocess.PIPE,
+#                        close_fds=True)
+#lst = proc.stdout.readlines()
+#for x in lst:
+#    t = x.split("/")
+#    if t[1] in ("demos", "docs", "test"):
+#        continue
+#    rpt.append(x.rstrip())
 
 for pth in dirs:
     lst = os.listdir(os.path.join(pypath, pth))
@@ -438,13 +436,13 @@
             inc.write("import %s\n" % p[0])
         else:
             inc.write("import %s\n" % p[0].replace("_%s" % custom[0], ""))
-rpt.sort()
-for p in rpt:
-    exeCmd("zip -q %s/TartanSve/%s %s" % (bd, zipfle, p))
-    if not p.count("__init__"):
-        p = p.replace(".py", "")
-        p = p.replace("/", ".")
-        inc.write("import %s\n" % p)
+#rpt.sort()
+#for p in rpt:
+#    exeCmd("zip -q %s/TartanSve/%s %s" % (bd, zipfle, p))
+#    if not p.count("__init__"):
+#        p = p.replace(".py", "")
+#        p = p.replace("/", ".")
+#        inc.write("import %s\n" % p)
 inc.close()
 exeCmd("zip -qj %s/TartanSve/%s %s/std/%s.py" %
          (bd, zipfle, pypath, modfle))
@@ -513,12 +511,14 @@
 if system == "tartan":
     exeCmd("rst2pdf doc/QST.rst -o doc/QuickStart.pdf -s doc/mystylesheet")
     exeCmd("zip -qr %s/TartanSve/%s doc/QuickStart.pdf" % (bd, zipfle))
+elif system == "bwlclb":
+    exeCmd("rst2pdf doc/BQS.rst -o doc/QuickStart.pdf -s doc/mystylesheet")
+    exeCmd("zip -qr %s/TartanSve/%s doc/QuickStart.pdf" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/tartan.ico" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s snd/ding.wav" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/*.gif" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/*.png" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s uty/SumatraPDF.exe" % (bd, zipfle))
-exeCmd("zip -q %s/TartanSve/%s uty/SumatraPDF-settings.txt" % (bd, zipfle))
 if py3:
     # Create python 3 zip file
     if os.path.isdir("/home/paul/tartan"):
@@ -536,12 +536,12 @@
         shutil.rmtree("ghostscript")
     if os.path.exists("pychart"):
         shutil.rmtree("pychart")
-    exeCmd("python /home/paul/Tartan-5/sdy/my2to3.py *.py")
-    exeCmd("python /home/paul/Tartan-5/sdy/my2to3.py csv/*_fld.csv")
+    exeCmd("python /home/paul/Tartan-5/uty/my2to3.py *.py")
+    exeCmd("python /home/paul/Tartan-5/uty/my2to3.py csv/*_fld.csv")
     exeCmd("2to3 -w --no-diffs *.py")
     for fle in glob.glob("*.bak"):
         os.remove(fle)
-    exeCmd("unzip -q ~/Python3/PyChart-1.39 pychart/*")
+    exeCmd("unzip -q ~/TartanWin/Python3/PyChart-1.39 pychart/*")
     exeCmd("zip -qr ~/TartanSve/%s-5-py3 *" % system)
     os.chdir(pypath)
 # Create tgz file
@@ -576,7 +576,7 @@
         (bd, system, bd, system.capitalize(), ver[0], ver[1], ver[2]))
 if windows:
     # Python 2 windows executable
-    exeCmd("wineconsole c:/PyTartan/tartan.bat %s" % system)
+    exeCmd("wine2 wineconsole c:/PyInstall/maker.bat %s" % system)
     if py3:
         # Python 3 windows executable
         exeCmd("wine3 wineconsole c:/PyInstall/maker.bat %s" % system)
@@ -627,7 +627,7 @@
             exeCmd("rsync -artz %s/Tartan-5/doc/Changes.rst root@server:/var/www/tartan.co.za/htdocs/Changes/ --progress" % bd)
 os.remove("%s/Tartan-5/doc/Manual.pdf" % bd)
 os.remove("%s/Tartan-5/doc/%s.rst" % (bd, man))
-if system == "tartan":
+if system in ("tartan", "bwlclb"):
     os.remove("%s/Tartan-5/doc/QuickStart.pdf" % bd)
 # Remove Duplicate File
 # os.remove("%s/TartanSve/%s-5.zip" % (bd, system))
@@ -658,6 +658,7 @@
             "frikkie@lando.co.za",
             "galloway@awe.co.za",
             "jane@acsconsulting.co.za",
+            "karen@spargs.co.za",
             "keith@barrowdale.co.za",
             "lawrence@hawcweb.co.za",
             "liezel@acsconsulting.co.za",
@@ -670,19 +671,12 @@
             "no2pigstash@hotmail.com",
             "paul@tartan.co.za",
             "paulabergh@mweb.co.za",
+            "peetneethling.vdm@gmail.com",
             "rob@itennis.co.za",
             "rene@agfin.co.za",
             "ruthmiles52@gmail.com",
             "tyron@i-volt.net",
             "yolande@acsaccounting.co.za"]
-            #"avanhasselt@jadeworld.com"
-            #"brt@volmoed.co.za",
-            #"johnv@wpcc.co.za",
-            #"knorton@xsinet.co.za"
-            #"mjredman@bigpond.net.au"
-            #"neil@cpms.co.za",
-            #"nmacdonald@telkomsa.net",
-            #"rsatchl@iafrica.com",
         for addr in addrs:
             if addr == "deonk@spargs.co.za":
                 sendMail(serv, mfrm, addr, subj)

=== modified file 'uty/pm1010.py'
--- uty/pm1010.py	2016-12-30 14:10:51 +0000
+++ uty/pm1010.py	2017-01-28 08:53:18 +0000
@@ -12,7 +12,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, shutil, sys

=== modified file 'uty/pw1010.py'
--- uty/pw1010.py	2016-11-07 16:11:53 +0000
+++ uty/pw1010.py	2017-01-28 08:53:18 +0000
@@ -14,7 +14,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import random

=== modified file 'uty/rp1010.py'
--- uty/rp1010.py	2016-05-23 08:10:54 +0000
+++ uty/rp1010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os

=== modified file 'uty/ss1010.py'
--- uty/ss1010.py	2016-02-27 13:18:41 +0000
+++ uty/ss1010.py	2017-02-15 07:36:21 +0000
@@ -10,15 +10,15 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, CCD, RepPrt, Sql, SChoice, TartanDialog
 from tartanFunctions import askQuestion, getSingleRecords
 
 class ss1010:
-    def __init__(self, mf):
-        self.mf = mf
+    def __init__(self, **opts):
+        self.mf = opts["mf"]
         if self.setVariables():
             self.mainProcess()
             self.mf.startLoop()

=== modified file 'uty/td1010.py'
--- uty/td1010.py	2016-05-21 12:42:32 +0000
+++ uty/td1010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'uty/tdc110.py'
--- uty/tdc110.py	2016-02-27 13:18:41 +0000
+++ uty/tdc110.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'uty/tp1010.py'
--- uty/tp1010.py	2016-02-27 13:18:41 +0000
+++ uty/tp1010.py	2017-02-22 06:34:56 +0000
@@ -12,7 +12,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import operator, os
@@ -833,7 +833,7 @@
         self.df.setWidget(self.df.mstFrame, state="hide")
         RepPrt(self.opts["mf"], name="tp1010", tables=table, heads=heads,
             where=[("tpd_tname", "=", self.template)],
-            order="tpd_detseq asc", prtdia=(("N","V"), None))
+            order="tpd_detseq asc", prtdia=(("Y","V"), None))
         self.df.setWidget(self.df.mstFrame, state="show")
         self.df.enableButtonsTags(state=state)
         self.df.focusField(self.df.frt, self.df.pag, self.df.col)

=== modified file 'wag/sl1010.py'
--- wag/sl1010.py	2016-02-27 13:18:41 +0000
+++ wag/sl1010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2010.py'
--- wag/sl2010.py	2016-02-27 13:18:41 +0000
+++ wag/sl2010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2020.py'
--- wag/sl2020.py	2016-02-27 13:18:41 +0000
+++ wag/sl2020.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2030.py'
--- wag/sl2030.py	2016-02-27 13:18:41 +0000
+++ wag/sl2030.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3010.py'
--- wag/sl3010.py	2016-02-27 13:18:41 +0000
+++ wag/sl3010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3020.py'
--- wag/sl3020.py	2016-02-27 13:18:41 +0000
+++ wag/sl3020.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3030.py'
--- wag/sl3030.py	2016-11-07 16:11:53 +0000
+++ wag/sl3030.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3040.py'
--- wag/sl3040.py	2016-02-27 13:18:41 +0000
+++ wag/sl3040.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl4010.py'
--- wag/sl4010.py	2016-02-27 13:18:41 +0000
+++ wag/sl4010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg1010.py'
--- wag/wg1010.py	2016-09-03 14:07:52 +0000
+++ wag/wg1010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg2010.py'
--- wag/wg2010.py	2016-02-27 13:18:41 +0000
+++ wag/wg2010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg2020.py'
--- wag/wg2020.py	2016-02-27 13:18:41 +0000
+++ wag/wg2020.py	2017-02-23 11:33:52 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time
@@ -148,7 +148,7 @@
         if not self.allow or not self.rates:
             showError(self.opts["mf"].body, "Missing Rates",
                 "There are No Tax Rates for Year %s" % self.taxyr)
-            self.doExit()
+            return "rf"
         y = w / 10000
         m = (w % 10000) / 100
         if m < 3:

=== modified file 'wag/wg2030.py'
--- wag/wg2030.py	2016-02-27 13:18:41 +0000
+++ wag/wg2030.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wg3010.py'
--- wag/wg3010.py	2016-05-21 12:42:32 +0000
+++ wag/wg3010.py	2017-02-22 07:45:10 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -49,10 +49,18 @@
         tnd = ((self.doEnd,"y"), )
         txt = (self.doExit, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"), mail=("Y","Y"))
+            txit=txt, view=("Y","V"), mail=("Y","Y"))
 
     def doRptTyp(self, frt, pag, r, c, p, i, w):
         self.typ = w
+        if len(self.df.topEntry[0][2]) > 3:
+            if self.typ == "C":
+                state = "hide"
+            else:
+                state = "show"
+            if len(self.df.topEntry[0][2]) == 5:
+                self.df.setWidget(self.df.topEntry[0][2][4][0], state=state)
+            self.df.setWidget(self.df.topEntry[0][2][3][0], state=state)
 
     def doDepCod(self, frt, pag, r, c, p, i, w):
         self.dep = w

=== modified file 'wag/wg3020.py'
--- wag/wg3020.py	2016-02-27 13:18:41 +0000
+++ wag/wg3020.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg3030.py'
--- wag/wg3030.py	2016-05-21 12:42:32 +0000
+++ wag/wg3030.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg3040.py'
--- wag/wg3040.py	2016-02-27 13:18:41 +0000
+++ wag/wg3040.py	2017-02-22 07:47:14 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import ASD, RepPrt, Sql, TartanDialog
@@ -54,7 +54,7 @@
         tnd = ((self.doEnd,"y"), )
         txt = (self.doExit, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"), mail=("Y","N"))
+            txit=txt, view=("Y","V"), mail=("Y","N"))
 
     def doSDate(self, frt, pag, r, c, p, i, w):
         self.sdatew = w

=== modified file 'wag/wg3050.py'
--- wag/wg3050.py	2016-02-27 13:18:41 +0000
+++ wag/wg3050.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import csv, os, time

=== modified file 'wag/wg3060.py'
--- wag/wg3060.py	2016-02-27 13:18:41 +0000
+++ wag/wg3060.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'wag/wg3070.py'
--- wag/wg3070.py	2016-02-27 13:18:41 +0000
+++ wag/wg3070.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import os, time

=== modified file 'wag/wg4010.py'
--- wag/wg4010.py	2016-02-27 13:18:41 +0000
+++ wag/wg4010.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc110.py'
--- wag/wgc110.py	2016-02-27 13:18:41 +0000
+++ wag/wgc110.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc210.py'
--- wag/wgc210.py	2016-02-27 13:18:41 +0000
+++ wag/wgc210.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc220.py'
--- wag/wgc220.py	2016-02-27 13:18:41 +0000
+++ wag/wgc220.py	2017-02-22 07:49:28 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time
@@ -38,7 +38,7 @@
         tnd = ((self.doEnd,"Y"), )
         txt = (self.doExit, )
         self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt, view=("N","V"))
+            txit=txt, view=("Y","V"))
 
     def doSort(self, frt, pag, r, c, p, i, w):
         self.sort = w

=== modified file 'wag/wgc310.py'
--- wag/wgc310.py	2016-02-27 13:18:41 +0000
+++ wag/wgc310.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'wag/wgc320.py'
--- wag/wgc320.py	2016-02-27 13:18:41 +0000
+++ wag/wgc320.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc410.py'
--- wag/wgc410.py	2016-02-27 13:18:41 +0000
+++ wag/wgc410.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc420.py'
--- wag/wgc420.py	2016-02-27 13:18:41 +0000
+++ wag/wgc420.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc510.py'
--- wag/wgc510.py	2016-02-27 13:18:41 +0000
+++ wag/wgc510.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc520.py'
--- wag/wgc520.py	2016-02-27 13:18:41 +0000
+++ wag/wgc520.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc610.py'
--- wag/wgc610.py	2016-02-27 13:18:41 +0000
+++ wag/wgc610.py	2017-01-28 08:53:19 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2016 Paul Malherbe.
+    Copyright (C) 2004-2017 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

