=== modified file 'ass/ar1010.py'
--- ass/ar1010.py	2017-08-24 07:49:34 +0000
+++ ass/ar1010.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2010.py'
--- ass/ar2010.py	2017-08-24 07:49:34 +0000
+++ ass/ar2010.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2020.py'
--- ass/ar2020.py	2017-08-24 07:49:34 +0000
+++ ass/ar2020.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar2030.py'
--- ass/ar2030.py	2017-08-24 07:49:34 +0000
+++ ass/ar2030.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3010.py'
--- ass/ar3010.py	2017-08-24 07:49:34 +0000
+++ ass/ar3010.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3020.py'
--- ass/ar3020.py	2017-08-24 07:49:34 +0000
+++ ass/ar3020.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3030.py'
--- ass/ar3030.py	2017-08-24 07:49:34 +0000
+++ ass/ar3030.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3040.py'
--- ass/ar3040.py	2017-08-24 07:49:34 +0000
+++ ass/ar3040.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar3050.py'
--- ass/ar3050.py	2017-08-24 07:49:34 +0000
+++ ass/ar3050.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'ass/ar4010.py'
--- ass/ar4010.py	2017-08-24 07:49:34 +0000
+++ ass/ar4010.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/ar6010.py'
--- ass/ar6010.py	2017-08-24 07:49:34 +0000
+++ ass/ar6010.py	2018-07-17 06:11:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/ar6020_rne.py'
--- ass/ar6020_rne.py	2017-08-24 07:49:34 +0000
+++ ass/ar6020_rne.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'ass/ar6030_rne.py'
--- ass/ar6030_rne.py	2017-08-24 07:49:34 +0000
+++ ass/ar6030_rne.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'ass/arc110.py'
--- ass/arc110.py	2017-08-24 07:49:34 +0000
+++ ass/arc110.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ass/arc210.py'
--- ass/arc210.py	2017-08-24 07:49:34 +0000
+++ ass/arc210.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/arc310.py'
--- ass/arc310.py	2017-08-24 07:49:34 +0000
+++ ass/arc310.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'ass/arc320.py'
--- ass/arc320.py	2017-08-24 07:49:34 +0000
+++ ass/arc320.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk1010.py'
--- bkm/bk1010.py	2017-08-24 07:49:34 +0000
+++ bkm/bk1010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk1020.py'
--- bkm/bk1020.py	2017-08-24 07:49:34 +0000
+++ bkm/bk1020.py	2018-07-17 06:11:53 +0000
@@ -21,7 +21,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'bkm/bk2010.py'
--- bkm/bk2010.py	2017-08-24 07:49:34 +0000
+++ bkm/bk2010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'bkm/bk3010.py'
--- bkm/bk3010.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3020.py'
--- bkm/bk3020.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3020.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3030.py'
--- bkm/bk3030.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3030.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import datetime, os, time

=== modified file 'bkm/bk3040.py'
--- bkm/bk3040.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3040.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3050.py'
--- bkm/bk3050.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3050.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3060.py'
--- bkm/bk3060.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3060.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'bkm/bk3070.py'
--- bkm/bk3070.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3070.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bk3080.py'
--- bkm/bk3080.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3080.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import PrintBookingInvoice, Sql, TartanDialog

=== modified file 'bkm/bk3090.py'
--- bkm/bk3090.py	2017-08-24 07:49:34 +0000
+++ bkm/bk3090.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CreateChart, TartanDialog, Sql

=== modified file 'bkm/bkc110.py'
--- bkm/bkc110.py	2017-08-24 07:49:34 +0000
+++ bkm/bkc110.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bkm/bkc210.py'
--- bkm/bkc210.py	2017-08-24 07:49:34 +0000
+++ bkm/bkc210.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'bkm/bkc310.py'
--- bkm/bkc310.py	2017-08-24 07:49:34 +0000
+++ bkm/bkc310.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'bkm/bkc410.py'
--- bkm/bkc410.py	2017-08-24 07:49:34 +0000
+++ bkm/bkc410.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'bkm/bkc510.py'
--- bkm/bkc510.py	2018-02-17 07:36:43 +0000
+++ bkm/bkc510.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bks/bs1010.py'
--- bks/bs1010.py	2017-08-24 07:49:34 +0000
+++ bks/bs1010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bks/bs3010.py'
--- bks/bs3010.py	2017-08-24 07:49:34 +0000
+++ bks/bs3010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, requests, time

=== modified file 'bks/bsc110.py'
--- bks/bsc110.py	2017-08-24 07:49:34 +0000
+++ bks/bsc110.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bks/bsc210.py'
--- bks/bsc210.py	2017-08-24 07:49:34 +0000
+++ bks/bsc210.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc1010.py'
--- bwl/bc1010.py	2017-08-24 07:49:34 +0000
+++ bwl/bc1010.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bwl/bc1020.py'
--- bwl/bc1020.py	2017-08-24 07:49:34 +0000
+++ bwl/bc1020.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'bwl/bc1030.py'
--- bwl/bc1030.py	2017-08-24 07:49:34 +0000
+++ bwl/bc1030.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc1040.py'
--- bwl/bc1040.py	2017-08-24 07:49:34 +0000
+++ bwl/bc1040.py	2018-07-18 16:25:05 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc2010.py'
--- bwl/bc2010.py	2018-05-31 15:57:14 +0000
+++ bwl/bc2010.py	2018-08-15 06:55:17 +0000
@@ -87,7 +87,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import random, time
@@ -2350,13 +2350,15 @@
 
     def doTestTabs(self, qty):
         # Load a random selection of tabs for testing purposes
+        tabs = []
         self.teams = {}
         self.bounce = {}
         self.alltabs = {}
         recs = self.sql.getRec(tables="bwltab", cols=["btb_tab"],
             where=[("btb_cono", "=", self.opts["conum"]),
             ("btb_tab", "<", self.nstart)], group="btb_tab")
-        tabs = []
+        if len(recs) < qty:
+            qty = len(recs)
         for rec in recs:
             tabs.append(rec[0])
         random.shuffle(tabs)

=== modified file 'bwl/bc2020.py'
--- bwl/bc2020.py	2017-08-24 07:49:34 +0000
+++ bwl/bc2020.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, MyFpdf, TartanDialog, Sql

=== modified file 'bwl/bc2030.py'
--- bwl/bc2030.py	2017-08-24 07:49:34 +0000
+++ bwl/bc2030.py	2018-07-17 06:11:53 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bc2040.py'
--- bwl/bc2040.py	2018-02-17 07:36:43 +0000
+++ bwl/bc2040.py	2018-07-18 16:20:26 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'bwl/bc2050.py'
--- bwl/bc2050.py	2018-05-31 15:57:14 +0000
+++ bwl/bc2050.py	2018-07-18 16:20:32 +0000
@@ -25,7 +25,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, random, time

=== modified file 'bwl/bc2060.py'
--- bwl/bc2060.py	2018-02-17 07:36:43 +0000
+++ bwl/bc2060.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bwl/bc2070.py'
--- bwl/bc2070.py	2018-02-17 07:36:43 +0000
+++ bwl/bc2070.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, TartanDialog, Sql

=== modified file 'bwl/bc3010.py'
--- bwl/bc3010.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3010.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bwl/bc3020.py'
--- bwl/bc3020.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3020.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'bwl/bc3030.py'
--- bwl/bc3030.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3030.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, MyFpdf, Sql, TartanDialog

=== modified file 'bwl/bc3040.py'
--- bwl/bc3040.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3040.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'bwl/bc3050.py'
--- bwl/bc3050.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3050.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'bwl/bc3060.py'
--- bwl/bc3060.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3060.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'bwl/bc3070.py'
--- bwl/bc3070.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3070.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'bwl/bc3080.py'
--- bwl/bc3080.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3080.py	2018-07-22 14:39:39 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time
@@ -30,8 +30,8 @@
                 self.opts["mf"].startLoop()
 
     def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwltyp", "bwlpts"],
-            prog=__name__)
+        self.sql = Sql(self.opts["mf"].dbm, ["bwlcmp", "bwltyp", "bwlpts",
+            "bwlnot"], prog=__name__)
         if self.sql.error:
             return
         gc = GetCtl(self.opts["mf"])
@@ -62,16 +62,23 @@
         r1s = (("A4 Page", "P"), ("A6 Card", "C"))
         fld = (
             (("T",0,0,0),"I@bcm_code",0,"","",
-                "","N",self.doCmpCod,com,None,("notzero",)),
+                "","Y",self.doCmpCod,com,None,("notzero",)),
             (("T",0,0,0),"ONA",30,""),
-            (("T",0,1,0),("IRB",r1s),0,"Paper Type","",
+            (("T",0,1,0),"ITV",(50,10),"Notes","",
+                "","N",self.doNotes,None,None,None,None,"""Enter All Additional Rules and Notes for the Competition e.g. what to do in these cases:
+
+Trial Ends - Only 1 trial end per game.
+Burnt Ends - Replay the end."""),
+            (("T",0,2,0),("IRB",r1s),0,"Paper Type","",
                 "P","N",self.doPaper,None,None,None),
-            (("T",0,2,0),"IUI",2,"Quantity","",
+            (("T",0,3,0),"IUI",2,"Quantity","",
                 1,"N",self.doQty,None,None,("notzero",)))
+        but = (("Edit Notes", None, self.doEdit, 0, ("T",0,4), ("T",0,5)),)
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=False, title=self.tit,
-            eflds=fld, tend=tnd, txit=txt, view=("N","V"), mail=("Y","N"))
+            eflds=fld, butt=but, tend=tnd, txit=txt, view=("N","V"),
+            mail=("Y","N"))
 
     def doCmpCod(self, frt, pag, r, c, p, i, w):
         chk = self.sql.getRec(tables="bwlcmp", cols=["bcm_name", "bcm_type"],
@@ -79,9 +86,22 @@
             limit=1)
         if not chk:
             return "Invalid Competition Code"
+        self.ccod = w
         self.cnam = chk[0]
         self.ctyp = chk[1]
         self.df.loadEntry(frt, pag, p+1, data=self.cnam)
+        nte = self.sql.getRec(tables="bwlnot", where=[("bcn_cono", "=",
+            self.opts["conum"]), ("bcn_ccod", "=", self.ccod)], limit=1)
+        if nte:
+            self.notes = nte[2]
+            self.df.loadEntry(frt, pag, p+2, self.notes)
+            return "sk2"
+
+    def doEdit(self):
+        self.df.focusField("T", 0, 3, tag=False)
+
+    def doNotes(self, frt, pag, r, c, p, i, w):
+        self.notes = w
 
     def doPaper(self, frt, pag, r, c, p, i, w):
         if w == "P":
@@ -195,8 +215,11 @@
                             txt = "Game %s will be Expunged" % gms[0]
                         else:
                             txt = "Games %s" % gms[0]
-                            for g in gms[1:]:
-                                txt = "%s, %s" % (txt, g)
+                            for n, g in enumerate(gms[1:]):
+                                if n == len(gms) - 2:
+                                    txt = "%s and %s" % (txt, g)
+                                else:
+                                    txt = "%s, %s" % (txt, g)
                             txt = "%s will be Expunged." % txt
                         self.fpdf.drawText(txt=txt, x=x2, h=h, ctyp="M")
                     if ldic["bct_percent"]:
@@ -221,7 +244,7 @@
                 else:
                     txt = "Scoring for S v S Games"
                 self.fpdf.drawText(txt=txt, h=h)
-                self.fpdf.underLine(h=h, txt="Points for Drawn Games")
+                self.fpdf.underLine(h=h, txt=txt)
                 if ldic[ptyp]["bcp_sends"]:
                     self.fpdf.drawText(txt="Skins", h=h, ln=0)
                     self.fpdf.drawText(txt="Each Set of %s Ends will "\
@@ -256,7 +279,7 @@
                     txt = "1 Bonus Point will be Awarded as Follows:"
                     self.fpdf.drawText(txt=txt, x=x1, h=h, ctyp="M")
                     txt = "Winning by %s or More Shots or" % \
-                        (ldic[ptyp]["bcp_win_by"] + 11)
+                        (ldic[ptyp]["bcp_win_by"] + 1)
                     self.fpdf.drawText(txt=txt, x=x2, h=h, ctyp="M")
                     txt = "Losing by %s or Less Shots" % \
                         (ldic[ptyp]["bcp_lose_by"] - 1)
@@ -264,12 +287,23 @@
                     pts += 1
                 txt = "Therefore a Maximum of %s Points per Game." % pts
                 self.fpdf.drawText(txt=txt, x=x1, h=h, ctyp="M")
+            if self.notes:
+                txt = "Notes"
+                self.fpdf.drawText(h=h)
+                self.fpdf.drawText(txt=txt, h=h)
+                self.fpdf.underLine(h=h, txt=txt)
+                self.fpdf.drawText(txt=self.notes, h=h, ctyp="M")
+                self.sql.delRec("bwlnot", where=[("bcn_cono", "=",
+                    self.opts["conum"]), ("bcn_ccod", "=", self.ccod)])
+                self.sql.insRec("bwlnot", data=[self.opts["conum"],
+                    self.ccod, self.notes])
+                self.opts["mf"].dbm.commitDbase()
 
     def pageHeading(self):
         if self.card:
             self.fpdf.set_fill_color(220)
             self.fpdf.set_font("Arial","B",12)
-            self.fpdf.drawText("Competiton Format and Points", align="C",
+            self.fpdf.drawText("Competiton Format and Points", h=6, align="C",
                 border="TLRB", fill=True)
             self.fpdf.set_line_width(1)
             self.fpdf.rect(self.fpdf.l_margin, self.fpdf.t_margin, 100, 140)

=== modified file 'bwl/bc3090.py'
--- bwl/bc3090.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3090.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'bwl/bc3100.py'
--- bwl/bc3100.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3100.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'bwl/bc3110.py'
--- bwl/bc3110.py	2017-08-24 07:49:34 +0000
+++ bwl/bc3110.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import MyFpdf, Sql, TartanDialog

=== modified file 'bwl/bc6010.py'
--- bwl/bc6010.py	2018-02-17 07:36:43 +0000
+++ bwl/bc6010.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, SplashScreen, Sql, TartanDialog

=== modified file 'bwl/bc6020.py'
--- bwl/bc6020.py	2017-08-24 07:49:34 +0000
+++ bwl/bc6020.py	2018-07-27 12:39:22 +0000
@@ -12,11 +12,12 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
+import time
 from TartanClasses import GetCtl, SplashScreen, Sql, TartanDialog
-from tartanFunctions import getNextCode
+from tartanFunctions import getNextCode, projectDate
 
 class bc6020:
     def __init__(self, **opts):
@@ -50,15 +51,16 @@
             ("bwlgme", "bcg_cono", "bcg_scod"),
             ("bwlgme", "bcg_cono", "bcg_ocod"),
             ("bwltab", "btb_cono", "btb_tab"))
+        t = time.localtime()
+        self.sysdt = ((t[0] * 10000) + (t[1] * 100) + t[2])
         return True
 
     def mainProcess(self):
         tit = "Delete Visitors' Tabs"
         fld = (
-            (("T",0,0,0),"IUI",3,"Minimum Tabs-In","",
-                2,"N",self.doDelTyp,None,None,("notzero",),None,
-                "The Minimum Number of Times a Visitor Must Have "\
-                "Played Tabs-In to Remain in the System."),)
+            (("T",0,0,0),"IUI",2,"Months Not Played","",
+                12,"N",self.doDelTyp,None,None,("notzero",),None,
+                "The Cut-Off Number of Months Since Last Played."),)
         tnd = ((self.doEnd,"y"),)
         txt = (self.doExit,)
         self.df = TartanDialog(self.opts["mf"], tops=True, title=tit,
@@ -66,15 +68,14 @@
         self.opts["mf"].startLoop()
 
     def doDelTyp(self, frt, pag, r, c, p, i, w):
-        self.delent = w
+        self.delent = projectDate(self.sysdt, (0 - w), "months")
 
     def doEnd(self):
         self.df.closeProcess()
         splash = SplashScreen(self.opts["mf"].body,
             "Deleting Visitors' Tabs ... Please Wait")
-        # Delete tabs without competition history
         tab = ["bwltab", "bwldrt"]
-        col = ["count(*)", "btb_tab"]
+        col = ["btb_tab", "max(bdt_date)"]
         whr = [
             ("btb_cono", "=", self.opts["conum"]),
             ("btb_tab", ">=", self.nstart),
@@ -85,20 +86,20 @@
         tabs = self.sql.getRec(tables=tab, cols=col, where=whr, group=grp,
             order=odr)
         for tab in tabs:
-            if tab[0] >= self.delent:
+            if tab[1] >= self.delent:
                 continue
             found = False
             for key in self.keys:
                 if key[0] in ("bwldrt", "bwltab"):
                     continue
                 chk = self.sql.getRec(tables=key[0], where=[(key[1], "=",
-                    self.opts["conum"]), (key[2], "=", tab[1])], limit=1)
+                    self.opts["conum"]), (key[2], "=", tab[0])], limit=1)
                 if chk:
                     found = True
                     break
             if not found:
                 self.sql.delRec("bwltab", where=[("btb_cono", "=",
-                    self.opts["conum"]), ("btb_tab", "=", tab[1])])
+                    self.opts["conum"]), ("btb_tab", "=", tab[0])])
                 nxt = getNextCode(self.sql, "bwldrt", "bdt_tab",
                     [("bdt_cono", "=", self.opts["conum"])], 900001, 999999)
                 for key in self.keys:
@@ -106,7 +107,7 @@
                         continue
                     self.sql.updRec(key[0], cols=[key[2]], data=[nxt],
                         where=[(key[1], "=", self.opts["conum"]),
-                        (key[2], "=", tab[1])])
+                        (key[2], "=", tab[0])])
         # Re-number tabs with competition history
         tabs = self.sql.getRec(tables="bwltab", cols=["btb_tab"],
             where=[("btb_cono", "=", self.opts["conum"]),

=== modified file 'bwl/bc6030.py'
--- bwl/bc6030.py	2017-08-24 07:49:34 +0000
+++ bwl/bc6030.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'bwl/bcc110.py'
--- bwl/bcc110.py	2017-08-24 07:49:34 +0000
+++ bwl/bcc110.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'bwl/bcc210.py'
--- bwl/bcc210.py	2017-08-24 07:49:34 +0000
+++ bwl/bcc210.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'crs/cr1010.py'
--- crs/cr1010.py	2017-08-24 07:49:34 +0000
+++ crs/cr1010.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr1010_rne.py'
--- crs/cr1010_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr1010_rne.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2010.py'
--- crs/cr2010.py	2017-08-24 07:49:34 +0000
+++ crs/cr2010.py	2018-08-15 07:44:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2010_rne.py'
--- crs/cr2010_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr2010_rne.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import glob, os, time, xml.parsers.expat

=== modified file 'crs/cr2020_rne.py'
--- crs/cr2020_rne.py	2018-07-13 08:38:41 +0000
+++ crs/cr2020_rne.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr2030_rne.py'
--- crs/cr2030_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr2030_rne.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3010.py'
--- crs/cr3010.py	2017-08-24 07:49:34 +0000
+++ crs/cr3010.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3020.py'
--- crs/cr3020.py	2017-08-24 07:49:34 +0000
+++ crs/cr3020.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3030.py'
--- crs/cr3030.py	2017-08-24 07:49:34 +0000
+++ crs/cr3030.py	2018-07-17 06:11:54 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3030_rne.py'
--- crs/cr3030_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr3030_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3040.py'
--- crs/cr3040.py	2017-08-24 07:49:34 +0000
+++ crs/cr3040.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3050.py'
--- crs/cr3050.py	2018-07-13 08:38:41 +0000
+++ crs/cr3050.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3060.py'
--- crs/cr3060.py	2017-08-24 07:49:34 +0000
+++ crs/cr3060.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3070.py'
--- crs/cr3070.py	2017-08-24 07:49:34 +0000
+++ crs/cr3070.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3070_rne.py'
--- crs/cr3070_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr3070_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3080.py'
--- crs/cr3080.py	2017-08-24 07:49:34 +0000
+++ crs/cr3080.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3090.py'
--- crs/cr3090.py	2017-08-24 07:49:34 +0000
+++ crs/cr3090.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3100.py'
--- crs/cr3100.py	2017-08-24 07:49:34 +0000
+++ crs/cr3100.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'crs/cr3110.py'
--- crs/cr3110.py	2017-08-24 07:49:34 +0000
+++ crs/cr3110.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3310_rne.py'
--- crs/cr3310_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr3310_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3320_rne.py'
--- crs/cr3320_rne.py	2018-06-18 06:16:26 +0000
+++ crs/cr3320_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'crs/cr3330_rne.py'
--- crs/cr3330_rne.py	2018-05-31 15:57:14 +0000
+++ crs/cr3330_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3340_rne.py'
--- crs/cr3340_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr3340_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3350_rne.py'
--- crs/cr3350_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr3350_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3360_rne.py'
--- crs/cr3360_rne.py	2018-07-13 08:38:41 +0000
+++ crs/cr3360_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr3370_rne.py'
--- crs/cr3370_rne.py	2018-03-30 21:03:30 +0000
+++ crs/cr3370_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'crs/cr3380_rne.py'
--- crs/cr3380_rne.py	2018-03-30 21:03:30 +0000
+++ crs/cr3380_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'crs/cr3390_rne.py'
--- crs/cr3390_rne.py	2018-03-30 21:03:30 +0000
+++ crs/cr3390_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'crs/cr4010.py'
--- crs/cr4010.py	2017-08-24 07:49:34 +0000
+++ crs/cr4010.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr4010_rne.py'
--- crs/cr4010_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr4010_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/cr6010.py'
--- crs/cr6010.py	2017-08-24 07:49:34 +0000
+++ crs/cr6010.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'crs/cr6010_rne.py'
--- crs/cr6010_rne.py	2017-08-24 07:49:34 +0000
+++ crs/cr6010_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'crs/cr6020.py'
--- crs/cr6020.py	2018-07-13 08:38:41 +0000
+++ crs/cr6020.py	2018-08-01 08:57:12 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -179,9 +179,6 @@
                     cbal = ctr[crc.index("balance")]
                     camt = cbal
                     for dno, dtr in enumerate(dr):
-                        dcdt = dtr[drc.index("crt_curdt")]
-                        if dcdt > ccdt:
-                            continue
                         dbal = dtr[drc.index("balance")]
                         if not dbal:
                             continue

=== modified file 'crs/cr6020_rne.py'
--- crs/cr6020_rne.py	2018-07-13 08:38:41 +0000
+++ crs/cr6020_rne.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'crs/crc110.py'
--- crs/crc110.py	2017-08-24 07:49:34 +0000
+++ crs/crc110.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'csh/ca2010.py'
--- csh/ca2010.py	2017-08-24 07:49:34 +0000
+++ csh/ca2010.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'csh/ca2020.py'
--- csh/ca2020.py	2017-08-24 07:49:34 +0000
+++ csh/ca2020.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time, xlrd

=== modified file 'csh/ca3010.py'
--- csh/ca3010.py	2017-08-24 07:49:34 +0000
+++ csh/ca3010.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== added file 'csv/bwlnot_fld.csv'
--- csv/bwlnot_fld.csv	1970-01-01 00:00:00 +0000
+++ csv/bwlnot_fld.csv	2018-07-18 14:08:56 +0000
@@ -0,0 +1,3 @@
+0,"bcn_cono","UI","3.0","Company Number","Coy"
+1,"bcn_ccod","UI","3.0","Competition Code","Cod"
+2,"bcn_note","TX","50.0","Competition Notes","Competition-Notes"

=== added file 'csv/bwlnot_idx.csv'
--- csv/bwlnot_idx.csv	1970-01-01 00:00:00 +0000
+++ csv/bwlnot_idx.csv	2018-07-18 14:08:56 +0000
@@ -0,0 +1,1 @@
+"Bowls Competition Notes",1,"U","bcn_cono","bcn_ccod"

=== modified file 'csv/bwlsys.py'
--- csv/bwlsys.py	2017-02-25 14:03:05 +0000
+++ csv/bwlsys.py	2018-07-18 14:10:06 +0000
@@ -1,8 +1,8 @@
 tables = [
     # Bowls
     "bwlclb", "bwlcmp", "bwlctl", "bwldrm", "bwldrt", "bwlent", "bwlflf",
-        "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlrnd", "bwltab",
-        "bwltms", "bwltyp", "bwlpts",
+        "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlnot", "bwlrnd",
+        "bwltab", "bwltms", "bwltyp", "bwlpts",
     # Controls
     "ctllog", "ctlmst", "ctlnot", "ctlpwm", "ctlpwr", "ctlpwu", "ctlsys",
     # Reports

=== modified file 'csv/frelat.dat'
--- csv/frelat.dat	2017-02-25 14:03:05 +0000
+++ csv/frelat.dat	2018-08-11 10:26:18 +0000
@@ -1,129 +1,4 @@
-# Control Master
-assctl|cta_cono|ctlmst|ctm_cono
-assdep|asd_cono|ctlmst|ctm_cono
-assgrp|asg_cono|ctlmst|ctm_cono
-assmst|asm_cono|ctlmst|ctm_cono
-asstrn|ast_cono|ctlmst|ctm_cono
-bkmcon|bkc_cono|ctlmst|ctm_cono
-bkmctl|cbk_cono|ctlmst|ctm_cono
-bkmlet|bkl_cono|ctlmst|ctm_cono
-bkmmst|bkm_cono|ctlmst|ctm_cono
-bkmrtm|brm_cono|ctlmst|ctm_cono
-bkmrtr|brr_cono|ctlmst|ctm_cono
-bkmtrn|bkt_cono|ctlmst|ctm_cono
-bkmunm|bum_cono|ctlmst|ctm_cono
-bksmst|bmf_auth|bksaut|baf_code
-bksmst|bmf_ownr|bksown|bof_code
-bwlcmp|bcm_cono|ctlmst|ctm_cono
-bwlctl|ctb_cono|ctlmst|ctm_cono
-bwldrm|bdm_cono|ctlmst|ctm_cono
-bwldrt|bdt_cono|ctlmst|ctm_cono
-bwlent|bce_cono|ctlmst|ctm_cono
-bwlflf|bff_cono|ctlmst|ctm_cono
-bwlflm|bfm_cono|ctlmst|ctm_cono
-bwlflo|bfo_cono|ctlmst|ctm_cono
-bwlfls|bfs_cono|ctlmst|ctm_cono
-bwlflt|bft_cono|ctlmst|ctm_cono
-bwlgme|bcg_cono|ctlmst|ctm_cono
-bwlrnd|bcr_cono|ctlmst|ctm_cono
-bwltab|btb_cono|ctlmst|ctm_cono
-bwltyp|bct_cono|ctlmst|ctm_cono
-crsage|cra_cono|ctlmst|ctm_cono
-crsctl|ctc_cono|ctlmst|ctm_cono
-crsmst|crm_cono|ctlmst|ctm_cono
-crstrn|crt_cono|ctlmst|ctm_cono
-ctlare|arm_cono|ctlmst|ctm_cono
-ctlbat|btm_cono|ctlmst|ctm_cono
-ctlctl|ctl_cono|ctlmst|ctm_cono
-ctldep|dep_cono|ctlmst|ctm_cono
-ctlnot|not_cono|ctlmst|ctm_cono
-ctlpwr|pwd_cono|ctlmst|ctm_cono
-ctlrep|rpm_cono|ctlmst|ctm_cono
-ctlvmf|vtm_cono|ctlmst|ctm_cono
-ctlvrf|vtr_cono|ctlmst|ctm_cono
-ctlvtf|vtt_cono|ctlmst|ctm_cono
-ctlynd|cye_cono|ctlmst|ctm_cono
-drsage|dra_cono|ctlmst|ctm_cono
-drschn|chm_cono|ctlmst|ctm_cono
-drsctl|ctd_cono|ctlmst|ctm_cono
-drsmst|drm_cono|ctlmst|ctm_cono
-drsrcm|dcm_cono|ctlmst|ctm_cono
-drsrct|dct_cono|ctlmst|ctm_cono
-drstrn|drt_cono|ctlmst|ctm_cono
-genbal|glo_cono|ctlmst|ctm_cono
-genbud|glb_cono|ctlmst|ctm_cono
-gendtm|gdm_cono|ctlmst|ctm_cono
-gendtt|gdt_cono|ctlmst|ctm_cono
-genint|cti_cono|ctlmst|ctm_cono
-genjlm|gjm_cono|ctlmst|ctm_cono
-genjlt|gjt_cono|ctlmst|ctm_cono
-genmst|glm_cono|ctlmst|ctm_cono
-genrcc|grc_cono|ctlmst|ctm_cono
-genrct|grt_cono|ctlmst|ctm_cono
-genrpc|glc_cono|ctlmst|ctm_cono
-genrpt|glr_cono|ctlmst|ctm_cono
-genstr|gls_cono|ctlmst|ctm_cono
-gentrn|glt_cono|ctlmst|ctm_cono
-ibtmst|ibm_cono|ctlmst|ctm_cono
-ibtmst|ibm_branch|ctlmst|ctm_cono
-ibttrn|ibt_cono|ctlmst|ctm_cono
-lonctl|cln_cono|ctlmst|ctm_cono
-lonmf1|lm1_cono|ctlmst|ctm_cono
-lonmf2|lm2_cono|ctlmst|ctm_cono
-lonrte|lrt_cono|ctlmst|ctm_cono
-lontrn|lnt_cono|ctlmst|ctm_cono
-memadd|mla_cono|ctlmst|ctm_cono
-memage|mta_cono|ctlmst|ctm_cono
-memcat|mlc_cono|ctlmst|ctm_cono
-memctc|mcc_cono|ctlmst|ctm_cono
-memctl|mcm_cono|ctlmst|ctm_cono
-memctp|mcp_cono|ctlmst|ctm_cono
-memkon|mlk_cono|ctlmst|ctm_cono
-memlnk|mll_cono|ctlmst|ctm_cono
-memmst|mlm_cono|ctlmst|ctm_cono
-memsta|mls_cono|ctlmst|ctm_cono
-memtrn|mlt_cono|ctlmst|ctm_cono
-memtrs|mst_cono|ctlmst|ctm_cono
-rcacon|rcc_cono|ctlmst|ctm_cono
-rcactl|cte_cono|ctlmst|ctm_cono
-rcaint|rci_cono|ctlmst|ctm_cono
-rcaowm|rom_cono|ctlmst|ctm_cono
-rcaowt|rot_cono|ctlmst|ctm_cono
-rcaprm|rcp_cono|ctlmst|ctm_cono
-rcatnm|rtn_cono|ctlmst|ctm_cono
-rcatnt|rtu_cono|ctlmst|ctm_cono
-rtlcon|rtc_cono|ctlmst|ctm_cono
-rtlctl|ctr_cono|ctlmst|ctm_cono
-rtlmst|rtm_cono|ctlmst|ctm_cono
-rtlprm|rtp_cono|ctlmst|ctm_cono
-rtltrn|rtt_cono|ctlmst|ctm_cono
-slsctl|ctv_cono|ctlmst|ctm_cono
-slsiv1|si1_cono|ctlmst|ctm_cono
-slsiv2|si2_cono|ctlmst|ctm_cono
-slsiv3|si3_cono|ctlmst|ctm_cono
-strctl|cts_cono|ctlmst|ctm_cono
-strgrp|gpm_cono|ctlmst|ctm_cono
-strloc|srl_cono|ctlmst|ctm_cono
-strmf1|st1_cono|ctlmst|ctm_cono
-strmf2|st2_cono|ctlmst|ctm_cono
-strpom|pom_cono|ctlmst|ctm_cono
-strpot|pot_cono|ctlmst|ctm_cono
-strprc|stp_cono|ctlmst|ctm_cono
-strrcp|srr_cono|ctlmst|ctm_cono
-strtrn|stt_cono|ctlmst|ctm_cono
-struoi|unm_cono|ctlmst|ctm_cono
-strvar|stv_cono|ctlmst|ctm_cono
-wagbal|wbl_cono|ctlmst|ctm_cono
-wagcap|wcp_cono|ctlmst|ctm_cono
-wagcod|wcd_cono|ctlmst|ctm_cono
-wagctl|ctw_cono|ctlmst|ctm_cono
-wagedc|ced_cono|ctlmst|ctm_cono
-wagirp|wip_cono|ctlmst|ctm_cono
-waglmf|wlm_cono|ctlmst|ctm_cono
-wagltf|wlt_cono|ctlmst|ctm_cono
-wagmst|wgm_cono|ctlmst|ctm_cono
-wagtf1|wt1_cono|ctlmst|ctm_cono
-wagtf2|wt2_cono|ctlmst|ctm_cono
+# Control Master - Auto Generated
 # Asset Register
 assmst|asm_cono|assgrp|asg_cono
 assmst|asm_group|assgrp|asg_group
@@ -151,10 +26,14 @@
 bkmunm|bum_code|bkmrtt|brt_ucode
 bkmunm|bum_cono|ctlvmf|vtm_cono
 bkmunm|bum_vatc|ctlvmf|vtm_code
+# Book Clubs
+bksmst|bmf_auth|bksaut|baf_code
+bksmst|bmf_ownr|bksown|bof_code
 # Bowls
 bwldrm|bdm_cono|bwldrt|bdt_cono
 bwldrm|bdm_date|bwldrt|bdt_date
 bwldrm|bdm_time|bwldrt|bdt_time
+bwlent|bce_ccod|bwlcmp|bcm_code
 bwlent|bce_ccod|bwlgme|bcg_ccod
 bwlent|bce_scod|bwltab|btb_tab
 bwlent|bce_scod|bwlgme|bcg_scod
@@ -218,6 +97,8 @@
 genrcc|grc_vat|ctlvmf|vtm_code
 gentrn|glt_cono|ctlvmf|vtm_cono
 gentrn|glt_taxind|ctlvmf|vtm_code
+# Inter Branch Transfers
+ibtmst|ibm_branch|ctlmst|ctm_cono
 # Loans
 lonmf2|lm2_cono|lonmf1|lm1_cono
 lonmf2|lm2_cono|lonmf1|lm1_acno

=== modified file 'csv/rcacon_fld.csv'
--- csv/rcacon_fld.csv	2014-03-28 07:32:49 +0000
+++ csv/rcacon_fld.csv	2018-08-17 08:57:48 +0000
@@ -8,4 +8,8 @@
 7,"rcc_period","UI","3.0","Number of Periods","Per"
 8,"rcc_rtlamt","UD","12.2","Rental Amount","Rent-Amount"
 9,"rcc_deposit","UD","12.2","Deposit Amount","Depo-Amount"
-10,"rcc_status","UA","1.0","Status Flag","S"
+10,"rcc_wamt","UD","12.2","Water Amount","Watr-Amount"
+11,"rcc_wtyp","UI","12.2","Water Type","W"
+12,"rcc_eamt","UD","12.2","Electricity Amount","Elec-Amount"
+13,"rcc_etyp","UI","12.2","Electricity Type","E"
+14,"rcc_status","UA","1.0","Status Flag","S"

=== modified file 'csv/stdsys.py'
--- csv/stdsys.py	2017-02-25 14:03:05 +0000
+++ csv/stdsys.py	2018-07-18 14:10:30 +0000
@@ -6,8 +6,8 @@
     "bkmtrn", "bkmunm",
     # Bowls
     "bwlclb", "bwlcmp", "bwlctl", "bwldrm", "bwldrt", "bwlent", "bwlflf",
-    "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlrnd", "bwltab",
-    "bwltms", "bwltyp", "bwlpts",
+    "bwlflm", "bwlflo", "bwlfls", "bwlflt", "bwlgme", "bwlnot", "bwlrnd",
+    "bwltab", "bwltms", "bwltyp", "bwlpts",
     # Controls
     "ctlbat", "ctlctl", "ctldep", "ctllog", "ctlmes", "ctlmst", "ctlnot",
     "ctlpwm", "ctlpwr", "ctlpwu", "ctlrep", "ctlsys", "ctlvmf", "ctlvrf",

=== modified file 'doc/BKS.rst'
--- doc/BKS.rst	2018-07-13 08:38:41 +0000
+++ doc/BKS.rst	2018-08-19 10:43:42 +0000
@@ -2,7 +2,7 @@
  TARTAN SYSTEMS - Book Clubs
 =============================
 
-:Version:   5.3.11
+:Version:   5.3.12
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za

=== modified file 'doc/BWL.rst'
--- doc/BWL.rst	2018-05-31 15:57:14 +0000
+++ doc/BWL.rst	2018-07-18 15:28:05 +0000
@@ -333,6 +333,7 @@
 Use this routine to print the competition format.
 
 + **Competition Code** - The relevant competition number.
++ **Notes** - The notes relevant to this competition e.g. No trial ends. Please note that termination of this field is the <F9> key and and not <Return> or <Enter> key.
 
 Competition Draw (BC)
 +++++++++++++++++++++

=== modified file 'doc/BWM.rst'
--- doc/BWM.rst	2018-07-13 08:38:41 +0000
+++ doc/BWM.rst	2018-08-19 10:43:42 +0000
@@ -2,7 +2,7 @@
  TARTAN SYSTEMS - Bowling Clubs
 ================================
 
-:Version:   5.3.11
+:Version:   5.3.12
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za

=== modified file 'doc/Downloads.rst'
--- doc/Downloads.rst	2018-07-13 08:38:41 +0000
+++ doc/Downloads.rst	2018-08-19 10:43:42 +0000
@@ -11,23 +11,23 @@
 
 |tartan| Version
 ================
-The latest version of Tartan is 5.3.11 and was released on the 13th July, 2018.
+The latest version of Tartan is 5.3.12 and was released on the 19th August, 2018.
 
 Backup and restore functions must only be done with the  same version of Tartan i.e. the version used to restore a backup must be the same as the one used to make the backup.
 
 .. _Documentation: http://www.tartan.co.za/cgi-bin/simple_web.py/Documentation
-.. _Tartan-5-lnx: ftp://tartan.co.za/Tartan_5.3.11.tgz
-.. _Tartan-4-lnx: ftp://tartan.co.za/Tartan_4.1.14.tgz
-.. _Tartan-3-lnx: ftp://tartan.co.za/Tartan_3.4.51.tgz
-.. _Tartan-2-lnx: ftp://tartan.co.za/Tartan_2.5.29.tgz
-.. _Tartan-5-win: ftp://tartan.co.za/Tartan_5.3.11.exe
-.. _Tartan-4-win: ftp://tartan.co.za/Tartan_4.1.14.exe
-.. _Tartan-3-win: ftp://tartan.co.za/Tartan_3.4.51.exe
-.. _Tartan-2-win: ftp://tartan.co.za/Tartan_2.5.29.exe
-.. _Bwlclb-5-lnx: ftp://tartan.co.za/Bwlclb_5.3.11.tgz
-.. _Bwlclb-5-win: ftp://tartan.co.za/Bwlclb_5.3.11.exe
-.. _Seccmp-5-lnx: ftp://tartan.co.za/Seccmp_5.3.11.tgz
-.. _Seccmp-5-win: ftp://tartan.co.za/Seccmp_5.3.11.exe
+.. _Tartan-5-lnx: http://tartan.co.za/files/Tartan_5.3.12.tgz
+.. _Tartan-4-lnx: http://tartan.co.za/files/Tartan_4.1.14.tgz
+.. _Tartan-3-lnx: http://tartan.co.za/files/Tartan_3.4.51.tgz
+.. _Tartan-2-lnx: http://tartan.co.za/files/Tartan_2.5.29.tgz
+.. _Tartan-5-win: http://tartan.co.za/files/Tartan_5.3.12.exe
+.. _Tartan-4-win: http://tartan.co.za/files/Tartan_4.1.14.exe
+.. _Tartan-3-win: http://tartan.co.za/files/Tartan_3.4.51.exe
+.. _Tartan-2-win: http://tartan.co.za/files/Tartan_2.5.29.exe
+.. _Bwlclb-5-lnx: http://tartan.co.za/files/Bwlclb_5.3.12.tgz
+.. _Bwlclb-5-win: http://tartan.co.za/files/Bwlclb_5.3.12.exe
+.. _Seccmp-5-lnx: http://tartan.co.za/files/Seccmp_5.3.12.tgz
+.. _Seccmp-5-win: http://tartan.co.za/files/Seccmp_5.3.12.exe
 
 |linux| Linux
 =============

=== modified file 'doc/MST.rst'
--- doc/MST.rst	2018-07-13 08:38:41 +0000
+++ doc/MST.rst	2018-08-19 10:43:42 +0000
@@ -2,7 +2,7 @@
  Tartan Systems - User Manual
 ==============================
 
-:Version:   5.3.11
+:Version:   5.3.12
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za

=== modified file 'doc/SEC.rst'
--- doc/SEC.rst	2018-07-13 08:38:41 +0000
+++ doc/SEC.rst	2018-08-19 10:43:42 +0000
@@ -2,7 +2,7 @@
  TARTAN SYSTEMS - Sectional Competitions
 ========================================
 
-:Version:   5.3.11
+:Version:   5.3.12
 :Author:    Paul Malherbe
 :Contact:   paul@tartan.co.za
 :Home:      http://www.tartan.co.za

=== added file 'doc/i18n.txt'
--- doc/i18n.txt	1970-01-01 00:00:00 +0000
+++ doc/i18n.txt	2018-08-12 12:17:08 +0000
@@ -0,0 +1,28 @@
+Internationalization
+--------------------
+1) Edit modules and change "Text" to _("Text")
+2) Create .pot file
+    gettext pygettext -d base -o locales/base.pot module.py
+3) Edit locales/base.pot and change where needed especially:
+    "Content-Type: text/plain; charset=UTF-8\n"
+    "Content-Transfer-Encoding: 8bit\n"
+4) Create language directories:
+    mkdir locales/lang/LC_MESSAGES
+5) Copy locales/base.pot to each language directory
+6) Edit language files other than english and enter translations e.g.
+    msgid "Hello World"
+    msgstr "Hello Wêreld"
+
+    I can use googletrans to achieve this:
+        pip install googletrans
+        translate "Hello world" -s en -d af
+7) Compile base.pt:
+    cd locales/lang/LC_MESSAGES
+    msgfmt -o base.mo base
+8) Edit base module.py and include:
+    import gettext
+    lang = rc.dic["lang"]
+    langs = {"en": "English", "af": "Afrikaans"}
+    ll = gettext.translation('base', localedir='locales', languages=[lang])
+    ll.install()
+    _ = ll.gettext

=== modified file 'drs/dr1010.py'
--- drs/dr1010.py	2018-02-17 07:36:43 +0000
+++ drs/dr1010.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr1020.py'
--- drs/dr1020.py	2017-08-24 07:49:34 +0000
+++ drs/dr1020.py	2018-08-13 07:39:45 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog
@@ -106,7 +106,7 @@
             ("Quarterly","3"),
             ("Bi-Annually","6"),
             ("Annually","Y"))
-        flds = [
+        fld = [
             (("T",0,0,0),"IUI",3, "Number","Charge Number",
                 "","Y",self.doNum,num_sel,None,None),
             (("T",0,1,0),"INA",30,"Description","",
@@ -118,25 +118,25 @@
                 "Enter the day of the month when the entry must be raised. "\
                 "Use 30 to denote the last day of the month.")]
         if self.glint == "Y":
-            flds.append((("T",0,4,0),"IUI",7,"Charge Account","G/L Account",
+            fld.append((("T",0,4,0),"IUI",7,"Charge Account","G/L Account",
                 "","N",self.doGlAc,glm_sel,None,("notzero",)))
-            flds.append((("T",0,4,0),"ONA",30,""))
+            fld.append((("T",0,4,0),"ONA",30,""))
             nxt = 5
         else:
             nxt = 4
-        flds.append((("T",0,nxt,0),"IUA",1,"VAT Code","V.A.T. Code",
+        fld.append((("T",0,nxt,0),"IUA",1,"VAT Code","V.A.T. Code",
                 self.taxdf,"N",self.doVat,vat_sel,None,("notblank",)))
-        flds.append((("C",0,0,0),"IUI",3,"Seq","Sequence Number",
+        fld.append((("C",0,0,0),"IUI",3,"Seq","Sequence Number",
                 "i","N",self.doSeq,seq_sel,None,("notzero",)))
         if self.chains == "Y":
-            flds.append((("C",0,0,0),"IUI",3,"Chn","Chain Store",
+            fld.append((("C",0,0,0),"IUI",3,"Chn","Chain Store",
                 "","N",self.doChn,chn_sel,self.doDelSeq,("efld",)))
         else:
             self.chn = 0
-            flds.append((("C",0,0,0),"OUI",3,"Chn"))
-        flds.append((("C",0,0,1),"INA",7,"Acc-Num","Account Number",
+            fld.append((("C",0,0,0),"OUI",3,"Chn"))
+        fld.append((("C",0,0,1),"INA",7,"Acc-Num","Account Number",
             "","N",self.doAcc,drm_sel,self.doDelSeq,("efld",)))
-        flds.extend((
+        fld.extend((
             (("C",0,0,2),"ONA",30,"Name","",
                 "","N",None,None,None,None),
             (("C",0,0,3),"ITX",30,"Charge-Details","Charge Details",
@@ -158,7 +158,7 @@
         txt = (self.exitTop,)
         cnd = ((self.endCol,"y"),)
         cxt = (self.exitCol,)
-        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=flds,
+        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld,
             butt=but, tend=tnd, txit=txt, cend=cnd, cxit=cxt)
 
     def doNum(self, frt, pag, r, c, p, i, w):

=== modified file 'drs/dr2010.py'
--- drs/dr2010.py	2017-08-24 07:49:34 +0000
+++ drs/dr2010.py	2018-08-15 07:44:50 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr2020.py'
--- drs/dr2020.py	2017-08-24 07:49:34 +0000
+++ drs/dr2020.py	2018-08-15 07:44:41 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr2030.py'
--- drs/dr2030.py	2017-08-24 07:49:34 +0000
+++ drs/dr2030.py	2018-07-17 06:11:55 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'drs/dr3010.py'
--- drs/dr3010.py	2017-08-24 07:49:34 +0000
+++ drs/dr3010.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3020.py'
--- drs/dr3020.py	2017-08-24 07:49:34 +0000
+++ drs/dr3020.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3030.py'
--- drs/dr3030.py	2017-08-24 07:49:34 +0000
+++ drs/dr3030.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3040.py'
--- drs/dr3040.py	2017-08-24 07:49:34 +0000
+++ drs/dr3040.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3050.py'
--- drs/dr3050.py	2018-07-13 08:38:41 +0000
+++ drs/dr3050.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3060.py'
--- drs/dr3060.py	2017-08-24 07:49:34 +0000
+++ drs/dr3060.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3080.py'
--- drs/dr3080.py	2017-08-24 07:49:34 +0000
+++ drs/dr3080.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3090.py'
--- drs/dr3090.py	2017-08-24 07:49:34 +0000
+++ drs/dr3090.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3100.py'
--- drs/dr3100.py	2017-08-24 07:49:34 +0000
+++ drs/dr3100.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'drs/dr3110.py'
--- drs/dr3110.py	2017-08-24 07:49:34 +0000
+++ drs/dr3110.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr3120.py'
--- drs/dr3120.py	2017-08-24 07:49:34 +0000
+++ drs/dr3120.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr4010.py'
--- drs/dr4010.py	2017-08-24 07:49:34 +0000
+++ drs/dr4010.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/dr6010.py'
--- drs/dr6010.py	2017-08-24 07:49:34 +0000
+++ drs/dr6010.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'drs/dr6020.py'
--- drs/dr6020.py	2018-07-13 08:38:41 +0000
+++ drs/dr6020.py	2018-08-01 08:56:47 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -216,9 +216,6 @@
                     cbal = CCD(ctr[crc.index("balance")], "SD", 13.2).work
                     camt = cbal
                     for dno, dtr in enumerate(dr):
-                        dcdt = dtr[drc.index("drt_curdt")]
-                        if dcdt > ccdt:
-                            continue
                         dbal = dtr[drc.index("balance")]
                         if not dbal:
                             continue

=== modified file 'drs/dr6030.py'
--- drs/dr6030.py	2017-08-24 07:49:34 +0000
+++ drs/dr6030.py	2018-08-16 16:51:16 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc110.py'
--- drs/drc110.py	2017-08-24 07:49:34 +0000
+++ drs/drc110.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc210.py'
--- drs/drc210.py	2017-08-24 07:49:34 +0000
+++ drs/drc210.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'drs/drc220.py'
--- drs/drc220.py	2017-08-24 07:49:34 +0000
+++ drs/drc220.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc310.py'
--- drs/drc310.py	2017-08-24 07:49:34 +0000
+++ drs/drc310.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc320.py'
--- drs/drc320.py	2017-08-24 07:49:34 +0000
+++ drs/drc320.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc410.py'
--- drs/drc410.py	2017-08-24 07:49:34 +0000
+++ drs/drc410.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc420.py'
--- drs/drc420.py	2017-08-24 07:49:34 +0000
+++ drs/drc420.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'drs/drc510.py'
--- drs/drc510.py	2017-08-24 07:49:34 +0000
+++ drs/drc510.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc520.py'
--- drs/drc520.py	2017-08-24 07:49:34 +0000
+++ drs/drc520.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'drs/drc610.py'
--- drs/drc610.py	2017-08-24 07:49:34 +0000
+++ drs/drc610.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'drs/drc710.py'
--- drs/drc710.py	2017-08-24 07:49:34 +0000
+++ drs/drc710.py	2018-07-17 06:11:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl1010.py'
--- gen/gl1010.py	2017-08-24 07:49:34 +0000
+++ gen/gl1010.py	2018-08-14 12:26:17 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, os, time
@@ -58,6 +58,8 @@
             self.newgen = False
         else:
             self.newgen = True
+        if "args" in self.opts:
+            self.acno = None
         return True
 
     def mainProcess(self):
@@ -117,6 +119,10 @@
                 err = self.doCheckDep(self.acno)
                 if err:
                     return err
+        elif "args" in self.opts:
+            showError(self.opts["mf"].body, "Error",
+                "Only a New Account is Allowed")
+            return "rf"
         else:
             self.new = False
             for x in xrange(0, self.df.topq[pag]):
@@ -177,7 +183,10 @@
                         str(dat), str(data[num]), 0])
         self.opts["mf"].dbm.commitDbase()
         self.df.setWidget(self.df.B3, state="disabled")
-        self.df.focusField("T", 0, 1)
+        if "args" in self.opts:
+            self.doQuit()
+        else:
+            self.df.focusField("T", 0, 1)
 
     def doAccept(self, widget=None):
         frt, pag, col, mes = self.df.doCheckFields()

=== modified file 'gen/gl1020.py'
--- gen/gl1020.py	2017-08-24 07:49:34 +0000
+++ gen/gl1020.py	2018-08-13 07:40:11 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, Sql, TartanDialog
@@ -59,7 +59,7 @@
                 ("glm_acno", "", 0, "Acc-Num"),
                 ("glm_desc", "", 0, "Description", "Y")),
             "where": [("glm_cono", "=", self.opts["conum"])]}
-        flds = (
+        fld = (
             (("T",0,0,0),"INa",9, "Number","Journal Number",
                 "","Y",self.doNum,num_sel,None,("notblank",)),
             (("T",0,1,0),"INA",30,"Description","",
@@ -88,7 +88,7 @@
         txt = (self.exitTop,)
         cnd = ((self.endCol,"y"),)
         cxt = (self.exitCol,)
-        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=flds,
+        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld,
             butt=but, tend=tnd, txit=txt, cend=cnd, cxit=cxt)
 
     def doNum(self, frt, pag, r, c, p, i, w):

=== modified file 'gen/gl1030.py'
--- gen/gl1030.py	2017-08-24 07:49:34 +0000
+++ gen/gl1030.py	2018-07-17 06:11:57 +0000
@@ -11,7 +11,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'gen/gl1040.py'
--- gen/gl1040.py	2017-08-24 07:49:34 +0000
+++ gen/gl1040.py	2018-08-13 07:40:20 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog
@@ -47,7 +47,7 @@
                 ("gdt_cono", "=", self.opts["conum"]),
                 ("gdt_curdt", "between", self.sper, self.eper)],
             "whera": (("T","gdt_code", 0),)}
-        flds = (
+        fld = (
             (("T",0,0,0,4),"INA",2,"Code","",
                 "","Y",self.doCode,cod_sel,None,("notblank",)),
             (("T",0,0,0),"INA",30,"Description","",
@@ -65,7 +65,7 @@
         cnd = ((self.endData,"y"),)
         cxt = (self.exitData,)
         self.df = TartanDialog(self.opts["mf"], sc=None, title=self.title,
-            eflds=flds, rows=row, butt=but, tend=tnd, cend=cnd, txit=txt,
+            eflds=fld, rows=row, butt=but, tend=tnd, cend=cnd, txit=txt,
             cxit=cxt)
 
     def doCode(self, frt, pag, r, c, p, i, w):

=== modified file 'gen/gl1050.py'
--- gen/gl1050.py	2017-08-24 07:49:34 +0000
+++ gen/gl1050.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'gen/gl1060.py'
--- gen/gl1060.py	2017-08-24 07:49:34 +0000
+++ gen/gl1060.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'gen/gl2010.py'
--- gen/gl2010.py	2017-08-24 07:49:34 +0000
+++ gen/gl2010.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, FileImport, Sql, TartanDialog

=== modified file 'gen/gl2020.py'
--- gen/gl2020.py	2017-08-24 07:49:34 +0000
+++ gen/gl2020.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, CCD, FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl2030.py'
--- gen/gl2030.py	2018-06-18 06:16:26 +0000
+++ gen/gl2030.py	2018-08-14 14:54:07 +0000
@@ -22,7 +22,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -58,8 +58,8 @@
         self.allcoy = self.opts["conum"]
         self.allnam = self.opts["conam"]
         # Get Enabled Modules
-        tab = ["ctlctl", "ctlmst", "ctlvmf", "ctlvrf", "ctlvtf", "genint",
-            "genmst", "gentrn", "genrcc", "genrct"]
+        tab = ["ctlctl", "ctlmst", "ctlpwu", "ctlvmf", "ctlvrf", "ctlvtf",
+            "genint", "genmst", "gentrn", "genrcc", "genrct"]
         mod = []
         for x in xrange(0, len(ctlmst["ctm_modules"].rstrip()), 2):
             mod.append(ctlmst["ctm_modules"][x:x+2])
@@ -199,6 +199,12 @@
                 self.incoac = False
         if not self.incoac and self.doChkLoadCtls():
             return
+        # Get users security level
+        acc = self.sql.getRec(tables="ctlpwu", cols=["usr_lvl"],
+            where=[("usr_name", "=", self.opts["capnm"])], limit=1)
+        if not acc:
+            return
+        self.lvl = acc[0]
         return True
 
     def batchHeader(self):
@@ -470,7 +476,7 @@
             [["C",2,0,0],"IUI",3,"Coy","Company Number",
                 self.opts["conum"],"N",self.doCoyNum,coy,None,("notzero",)],
             [["C",2,0,1],"IUI",7,"Acc-Num","Account Number",
-                "","N",self.doAccNum,glm,None,None],
+                "","Y",self.doAccNum,glm,None,None],
             [["C",2,0,2],"ONA",30,"Description"],
             [["C",2,0,3],"ISD",13.2,"Alloc-Amt","Allocation Amount",
                 "","N",self.doAllAmt,None,None,("efld",)],
@@ -1365,6 +1371,17 @@
                 self.rtlctl.append(r[0])
 
     def doAccNum(self, frt, pag, r, c, p, i, w):
+        if not w and self.lvl >= 3:
+            ok = askQuestion(self.opts["mf"].body, "Zero Number",
+                "Do you wish to create a New Account?",
+                default="no")
+            if ok == "yes":
+                w = callModule(self.opts["mf"], self.df, "gl1010",
+                    coy=[self.allcoy, self.allnam], user=self.opts["capnm"],
+                    args=True, ret="acno")
+                self.df.loadEntry(frt, pag, p, data=w)
+        if not w:
+            return "Invalid Account Number"
         if self.allcoy == self.opts["conum"] and w == self.bh.acc:
             return "Invalid Number, Same as Origin"
         self.others = False

=== modified file 'gen/gl2040.py'
--- gen/gl2040.py	2018-02-25 13:05:58 +0000
+++ gen/gl2040.py	2018-08-14 20:26:22 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -35,8 +35,8 @@
         self.allcoy = self.opts["conum"]
         self.allnam = self.opts["conam"]
         # Get Enabled Modules
-        tab = ["ctlctl", "ctlmst", "ctlvmf", "ctlvrf", "ctlvtf", "genint",
-            "genmst", "gentrn"]
+        tab = ["ctlctl", "ctlmst", "ctlpwu", "ctlvmf", "ctlvrf", "ctlvtf",
+            "genint", "genmst", "gentrn"]
         mod = []
         for x in xrange(0, len(ctlmst["ctm_modules"].rstrip()), 2):
             mod.append(ctlmst["ctm_modules"][x:x+2])
@@ -151,6 +151,12 @@
                 self.incoac = False
         if not self.incoac and self.doChkLoadCtls():
                 return
+        # Get users security level
+        acc = self.sql.getRec(tables="ctlpwu", cols=["usr_lvl"],
+            where=[("usr_name", "=", self.opts["capnm"])], limit=1)
+        if not acc:
+            return
+        self.lvl = acc[0]
         # Batch Header
         self.bh = Batches(self.opts["mf"], self.opts["conum"],
             self.opts["conam"], self.opts["period"], "GEN",
@@ -399,13 +405,13 @@
             (("T",0,0,0),"OUI",9,"Batch %s Quantity" % self.bh.batno),
             (("T",0,0,0),"OSD",13.2,"Value"),
             (("C",1,0,0),"INa",9,"Ref-Num","Reference Number",
-                "i","N",self.doTrnRef,None,None,("notblank",)),
-            (("C",1,0,1),"ID1",10,"Date","Transaction Date",
+                "i","Y",self.doTrnRef,None,None,("notblank",)),
+            (("C",1,0,1),"Id1",10,"Date","Transaction Date",
                 "r","N",self.doTrnDat,None,None,("efld",)),
             [("C",1,0,2),"IUI",3,"Coy","Company Number",
                 self.opts["conum"],"N",self.doCoyNum,coy,None,("notzero",)],
             (("C",1,0,3),"IUI",7,"Acc-Num","Account Number",
-                "","N",self.doAccNum,glm,None,None),
+                "","Y",self.doAccNum,glm,None,None),
             (("C",1,0,4),"ONA",20,"Description"),
             (("C",1,0,5),"ISD",13.2,"Amount","Transaction Amount",
                 "","N",self.doTrnAmt,None,None,None),
@@ -907,6 +913,17 @@
             self.batind = ""
 
     def doAccNum(self, frt, pag, r, c, p, i, w):
+        if not w and self.lvl >= 3:
+            ok = askQuestion(self.opts["mf"].body, "Zero Number",
+                "Do you wish to create a New Account?",
+                default="no")
+            if ok == "yes":
+                w = callModule(self.opts["mf"], self.df, "gl1010",
+                    coy=[self.allcoy, self.allnam], user=self.opts["capnm"],
+                    args=True, ret="acno")
+                self.df.loadEntry(frt, pag, p, data=w)
+        if not w:
+            return "Invalid Account Number"
         self.others = False
         self.othtot = 0
         if self.ass_gl == "Y" and w in self.assctl:

=== modified file 'gen/gl2050.py'
--- gen/gl2050.py	2017-08-24 07:49:34 +0000
+++ gen/gl2050.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3010.py'
--- gen/gl3010.py	2017-08-24 07:49:34 +0000
+++ gen/gl3010.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3020.py'
--- gen/gl3020.py	2017-08-24 07:49:34 +0000
+++ gen/gl3020.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3030.py'
--- gen/gl3030.py	2017-08-24 07:49:34 +0000
+++ gen/gl3030.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 import time
 from TartanClasses import ASD, CCD, MyFpdf, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl3030_rne.py'
--- gen/gl3030_rne.py	2018-02-25 13:05:58 +0000
+++ gen/gl3030_rne.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 import time
 from TartanClasses import ASD, CCD, MyFpdf, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl3040.py'
--- gen/gl3040.py	2017-08-24 07:49:34 +0000
+++ gen/gl3040.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3050.py'
--- gen/gl3050.py	2017-08-24 07:49:34 +0000
+++ gen/gl3050.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'gen/gl3060.py'
--- gen/gl3060.py	2017-08-24 07:49:34 +0000
+++ gen/gl3060.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, TartanDialog

=== modified file 'gen/gl3070.py'
--- gen/gl3070.py	2017-08-24 07:49:34 +0000
+++ gen/gl3070.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'gen/gl3080.py'
--- gen/gl3080.py	2017-08-24 07:49:34 +0000
+++ gen/gl3080.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl3090.py'
--- gen/gl3090.py	2017-08-24 07:49:34 +0000
+++ gen/gl3090.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import RepPrt, Sql, TartanDialog

=== modified file 'gen/gl3100_rne.py'
--- gen/gl3100_rne.py	2018-02-17 07:36:43 +0000
+++ gen/gl3100_rne.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy

=== modified file 'gen/gl3110_rne.py'
--- gen/gl3110_rne.py	2018-02-17 07:36:43 +0000
+++ gen/gl3110_rne.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, MyFpdf, Sql, TartanDialog

=== modified file 'gen/gl3140_rne.py'
--- gen/gl3140_rne.py	2018-05-31 15:57:14 +0000
+++ gen/gl3140_rne.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'gen/gl3150_rne.py'
--- gen/gl3150_rne.py	2018-05-31 15:57:14 +0000
+++ gen/gl3150_rne.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'gen/gl4010.py'
--- gen/gl4010.py	2017-08-24 07:49:34 +0000
+++ gen/gl4010.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl4020.py'
--- gen/gl4020.py	2017-08-24 07:49:34 +0000
+++ gen/gl4020.py	2018-08-17 07:56:26 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -259,8 +259,8 @@
             self.repco = 0
         else:
             self.repco = self.opts["conum"]
-        self.grpind = "n"
-        self.xits = "n"
+        self.grpind = False
+        self.xits = False
         self.clearData()
         self.allFields = []
         self.mth_tot = makeArray(14, 10, 1)
@@ -292,18 +292,18 @@
                 self.stanam = "Profit and Loss"
             else:
                 self.stanam = self.rpt_lst[self.rep_num][4]
-            while self.xits != "y":
+            while not self.xits:
                 self.processRecords()
 
     def processRecords(self):
-        if self.grpind == "y":
-            self.grpind = "n"
+        if self.grpind:
+            self.grpind = False
         else:
             self.nextRepRecord()
             self.storeRepRecord()
             if self.rpt_dic == {}:
-                self.xits = "y"
-        if self.xits != "y":
+                self.xits = True
+        if not self.xits:
             if self.s_type == "H":
                 self.doHead()
             elif self.s_type == "L":
@@ -324,21 +324,23 @@
     def doLedger(self):
         accs = self.readGenmst()
         for acc in accs:
-            self.lstdicGenmst(acc)
+            self.dicGenmst(acc)
             self.s_cono = self.gen_dic["glm_cono"]
             self.s_acno = self.gen_dic["glm_acno"]
             self.s_desc = self.gen_dic["glm_desc"]
             self.accumData()
             amt = self.mth[13]
-            if self.s_print == "+" and amt < 0:
+            if self.s_print == "N":
+                pass
+            elif self.s_print == "+" and amt < 0:
                 self.clearData()
                 continue
             elif self.s_print == "-" and amt >= 0:
                 self.clearData()
                 continue
-            elif self.s_print == "N":
-                pass
             else:
+                if self.trn:
+                    self.trans.update(self.trn)
                 self.printLine()
             self.accumTotals(self.s_acbal)
             if self.s_store == "Y":
@@ -346,26 +348,28 @@
             self.clearData()
 
     def doGroup(self):
-        self.grpind = "y"
+        self.grpind = True
         while self.rpt_dic and self.rpt_dic["glr_type"] == "G" and \
                         self.rpt_dic["glr_group"] == self.s_group:
             accs = self.readGenmst()
             for acc in accs:
-                self.lstdicGenmst(acc)
+                self.dicGenmst(acc)
                 self.s_cono = self.gen_dic["glm_cono"]
                 self.s_acno = self.gen_dic["glm_acno"]
                 self.accumData()
             self.nextRepRecord()
         amt = self.mth[13]
-        if self.s_print == "+" and amt < 0:
+        if self.s_print == "N":
+            pass
+        elif self.s_print == "+" and amt < 0:
             self.clearData()
             return
         elif self.s_print == "-" and amt >= 0:
             self.clearData()
             return
-        elif self.s_print == "N":
-            pass
         else:
+            if self.trn:
+                self.trans.update(self.trn)
             self.printLine()
         self.accumTotals(self.s_acbal)
         if self.s_store == "Y":
@@ -532,8 +536,7 @@
                             ("glm_acno", "=", ac[0])], limit=1))
         return accs
 
-    def lstdicGenmst(self, acc):
-        self.gen_lst = acc
+    def dicGenmst(self, acc):
         self.gen_dic = {}
         num = 0
         for fld in self.sql.genmst_col:
@@ -546,11 +549,12 @@
         self.lyr = [0,0,0,0,0,0,0,0,0,0,0,0,0,0]
         self.bud = [0,0,0,0,0,0,0,0,0,0,0,0,0,0]
         self.var = [0,0,0,0,0,0,0,0,0,0,0,0,0,0]
+        self.trn = None
 
     def accumData(self):
-        if self.s_desc not in self.trans:
+        if not self.trn:
             exists = False
-            self.trans[self.s_desc] = {}
+            self.trn = {self.s_desc: {}}
         else:
             exists = True
         if self.rpt_dic["glr_obal"] == "Y":
@@ -562,21 +566,21 @@
             self.var[1] = float(ASD(self.var[1]) - ASD(self.o_cyr))
             self.var[13] = float(ASD(self.var[13]) - ASD(self.o_cyr))
             if not exists:
-                trans = [0, 0, int(self.opts["period"][1][0] / 100),
+                trn = [0, 0, int(self.opts["period"][1][0] / 100),
                     self.opts["period"][1][0], 4, "O/Balance", "B/Fwd",
                     self.o_cyr, 0, "Opening Balance", "", "", 0, 0, 0]
-                self.trans[self.s_desc][1] = [trans]
-                self.trans[self.s_desc][13] = [trans]
+                self.trn[self.s_desc][1] = [trn]
+                self.trn[self.s_desc][13] = [trn]
             else:
-                a = copyList(self.trans[self.s_desc][1][0])
+                a = copyList(self.trn[self.s_desc][1][0])
                 a[7] = float(ASD(a[7]) + ASD(self.o_cyr))
-                self.trans[self.s_desc][1][0] = a
-                b = copyList(self.trans[self.s_desc][13][0])
+                self.trn[self.s_desc][1][0] = a
+                b = copyList(self.trn[self.s_desc][13][0])
                 b[7] = float(ASD(b[7]) + ASD(self.o_cyr))
-                self.trans[self.s_desc][13][0] = b
+                self.trn[self.s_desc][13][0] = b
         elif not exists:
-            self.trans[self.s_desc][1][0] = [[]]
-            self.trans[self.s_desc][13][0] = [[]]
+            self.trn[self.s_desc][1][0] = [[]]
+            self.trn[self.s_desc][13][0] = [[]]
         curdt = self.s_per
         for mth in xrange(1, 13):
             lyr, cyr, bud, trn = self.getMbal(curdt)
@@ -594,11 +598,11 @@
                 y += 1
                 m -= 12
             curdt = (y * 100) + m
-            if mth not in self.trans[self.s_desc]:
-                self.trans[self.s_desc][mth] = []
+            if mth not in self.trn[self.s_desc]:
+                self.trn[self.s_desc][mth] = []
             if trn:
-                self.trans[self.s_desc][mth].extend(trn)
-                self.trans[self.s_desc][13].extend(trn)
+                self.trn[self.s_desc][mth].extend(trn)
+                self.trn[self.s_desc][13].extend(trn)
 
     def getObal(self):
         if not self.con:
@@ -746,7 +750,7 @@
     def nextRepRecord(self):
         self.rpt_dic = {}
         if self.rep_num == len(self.rpt_lst) - 1:
-            self.xits = "y"
+            self.xits = True
         else:
             self.rep_num += 1
             num = 0

=== modified file 'gen/gl6010.py'
--- gen/gl6010.py	2017-08-24 07:49:34 +0000
+++ gen/gl6010.py	2018-07-17 06:11:57 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl6020.py'
--- gen/gl6020.py	2017-08-24 07:49:34 +0000
+++ gen/gl6020.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ProgressBar, Sql, TartanDialog

=== modified file 'gen/gl6030.py'
--- gen/gl6030.py	2017-08-24 07:49:34 +0000
+++ gen/gl6030.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl6040.py'
--- gen/gl6040.py	2017-08-24 07:49:34 +0000
+++ gen/gl6040.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'gen/gl6050.py'
--- gen/gl6050.py	2017-08-24 07:49:34 +0000
+++ gen/gl6050.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl6060.py'
--- gen/gl6060.py	2017-08-24 07:49:34 +0000
+++ gen/gl6060.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/gl6070.py'
--- gen/gl6070.py	2017-08-24 07:49:34 +0000
+++ gen/gl6070.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, Sql, TartanDialog

=== modified file 'gen/glc110.py'
--- gen/glc110.py	2017-08-24 07:49:34 +0000
+++ gen/glc110.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'gen/glc210.py'
--- gen/glc210.py	2017-08-24 07:49:34 +0000
+++ gen/glc210.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc310_rne.py'
--- gen/glc310_rne.py	2017-08-24 07:49:34 +0000
+++ gen/glc310_rne.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc410_rne.py'
--- gen/glc410_rne.py	2017-08-24 07:49:34 +0000
+++ gen/glc410_rne.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'gen/glc510_rne.py'
--- gen/glc510_rne.py	2017-08-24 07:49:34 +0000
+++ gen/glc510_rne.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'ibt/ib2010.py'
--- ibt/ib2010.py	2017-08-24 07:49:34 +0000
+++ ibt/ib2010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib2020.py'
--- ibt/ib2020.py	2017-08-24 07:49:34 +0000
+++ ibt/ib2020.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib3010.py'
--- ibt/ib3010.py	2017-08-24 07:49:34 +0000
+++ ibt/ib3010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, PrintTransfer, Sql, TartanDialog

=== modified file 'ibt/ib3020.py'
--- ibt/ib3020.py	2017-08-24 07:49:34 +0000
+++ ibt/ib3020.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ib3030.py'
--- ibt/ib3030.py	2017-08-24 07:49:34 +0000
+++ ibt/ib3030.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'ibt/ib3040.py'
--- ibt/ib3040.py	2017-08-24 07:49:34 +0000
+++ ibt/ib3040.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'ibt/ibc110.py'
--- ibt/ibc110.py	2017-08-24 07:49:34 +0000
+++ ibt/ibc110.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln1010.py'
--- lon/ln1010.py	2018-02-17 07:36:43 +0000
+++ lon/ln1010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2010.py'
--- lon/ln2010.py	2017-08-24 07:49:34 +0000
+++ lon/ln2010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2020.py'
--- lon/ln2020.py	2017-08-24 07:49:34 +0000
+++ lon/ln2020.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2020_rne.py'
--- lon/ln2020_rne.py	2017-08-24 07:49:34 +0000
+++ lon/ln2020_rne.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln2030.py'
--- lon/ln2030.py	2018-03-30 21:03:30 +0000
+++ lon/ln2030.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3010.py'
--- lon/ln3010.py	2017-08-24 07:49:34 +0000
+++ lon/ln3010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3020.py'
--- lon/ln3020.py	2017-08-24 07:49:34 +0000
+++ lon/ln3020.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3030.py'
--- lon/ln3030.py	2017-08-24 07:49:34 +0000
+++ lon/ln3030.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3040.py'
--- lon/ln3040.py	2017-08-24 07:49:34 +0000
+++ lon/ln3040.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln3050.py'
--- lon/ln3050.py	2017-08-24 07:49:34 +0000
+++ lon/ln3050.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'lon/ln4010.py'
--- lon/ln4010.py	2017-08-24 07:49:34 +0000
+++ lon/ln4010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'lon/ln6010.py'
--- lon/ln6010.py	2017-08-24 07:49:34 +0000
+++ lon/ln6010.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'lon/lnc110.py'
--- lon/lnc110.py	2017-08-24 07:49:34 +0000
+++ lon/lnc110.py	2018-07-17 06:11:58 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml1010.py'
--- mem/ml1010.py	2017-08-24 07:49:34 +0000
+++ mem/ml1010.py	2018-07-17 06:11:59 +0000
@@ -18,7 +18,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/ml2010.py'
--- mem/ml2010.py	2017-08-24 07:49:34 +0000
+++ mem/ml2010.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml2020.py'
--- mem/ml2020.py	2017-08-24 07:49:34 +0000
+++ mem/ml2020.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3010.py'
--- mem/ml3010.py	2017-08-24 07:49:34 +0000
+++ mem/ml3010.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3020.py'
--- mem/ml3020.py	2017-08-24 07:49:34 +0000
+++ mem/ml3020.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3030.py'
--- mem/ml3030.py	2017-08-24 07:49:34 +0000
+++ mem/ml3030.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3040.py'
--- mem/ml3040.py	2017-08-24 07:49:34 +0000
+++ mem/ml3040.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'mem/ml3050.py'
--- mem/ml3050.py	2017-08-24 07:49:34 +0000
+++ mem/ml3050.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'mem/ml3060.py'
--- mem/ml3060.py	2017-08-24 07:49:34 +0000
+++ mem/ml3060.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3070.py'
--- mem/ml3070.py	2017-08-24 07:49:34 +0000
+++ mem/ml3070.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3080.py'
--- mem/ml3080.py	2017-08-24 07:49:34 +0000
+++ mem/ml3080.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3090.py'
--- mem/ml3090.py	2017-08-24 07:49:34 +0000
+++ mem/ml3090.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3100.py'
--- mem/ml3100.py	2018-02-17 07:36:43 +0000
+++ mem/ml3100.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3110.py'
--- mem/ml3110.py	2017-08-24 07:49:34 +0000
+++ mem/ml3110.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml3120.py'
--- mem/ml3120.py	2017-08-24 07:49:34 +0000
+++ mem/ml3120.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CreateChart, TartanDialog, Sql

=== modified file 'mem/ml6010.py'
--- mem/ml6010.py	2017-08-24 07:49:34 +0000
+++ mem/ml6010.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/ml6020.py'
--- mem/ml6020.py	2017-08-24 07:49:34 +0000
+++ mem/ml6020.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/ml6030.py'
--- mem/ml6030.py	2017-08-24 07:49:34 +0000
+++ mem/ml6030.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, os, time

=== modified file 'mem/mlc110.py'
--- mem/mlc110.py	2017-08-24 07:49:34 +0000
+++ mem/mlc110.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mem/mlc210.py'
--- mem/mlc210.py	2017-08-24 07:49:34 +0000
+++ mem/mlc210.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mem/mlc310.py'
--- mem/mlc310.py	2017-08-24 07:49:34 +0000
+++ mem/mlc310.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'mem/mlc410.py'
--- mem/mlc410.py	2017-08-24 07:49:34 +0000
+++ mem/mlc410.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'mem/mlm010.py'
--- mem/mlm010.py	2017-08-24 07:49:34 +0000
+++ mem/mlm010.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'men/bksmen.py'
--- men/bksmen.py	2016-07-10 11:57:24 +0000
+++ men/bksmen.py	2018-08-15 20:15:50 +0000
@@ -37,6 +37,7 @@
     ["MM","mm_bs","Book Club"],
     ["MM","mm_hp","Help"]]
 msmod = [
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
     ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
     ["F","mm_sy","tarRes",5,"Restore Database"],

=== modified file 'men/bwlmen.py'
--- men/bwlmen.py	2017-08-24 07:49:34 +0000
+++ men/bwlmen.py	2018-08-15 08:14:17 +0000
@@ -42,7 +42,7 @@
     ["F","mm_sy","chgUsr",0,"Change User"],
     ["F","mm_sy","chgPwd",0,"Change Password"],
     ["F","mm_sy","tarUsr",7,"User's Maintenance"],
-    ["F","mm_sy","sysUpd",0,"Upgrade System"],
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
     ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
     ["F","mm_sy","tarRes",5,"Restore Database"],

=== modified file 'men/cshmen.py'
--- men/cshmen.py	2017-03-25 15:17:51 +0000
+++ men/cshmen.py	2018-08-15 20:16:14 +0000
@@ -43,7 +43,8 @@
     ["F","mm_sy","chgUsr",0,"Change User"],
     ["F","mm_sy","chgPwd",0,"Change Password"],
     ["F","mm_sy","tarUsr",7,"User's Maintenance"],
-    ["F","mm_sy","tarUpd",5,"Update File Formats"],
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
+    ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
     ["F","mm_sy","tarRes",5,"Restore Database"],
     ["F","mm_sy","tarCfg",0,"Preferences"],

=== modified file 'men/rnemen.py'
--- men/rnemen.py	2018-05-31 15:57:14 +0000
+++ men/rnemen.py	2018-08-15 20:16:41 +0000
@@ -59,7 +59,8 @@
     ["F","mm_sy","chgUsr",0,"Change User"],
     ["F","mm_sy","chgPwd",0,"Change Password"],
     ["F","mm_sy","tarUsr",7,"User's Maintenance"],
-    ["F","mm_sy","tarUpd",9,"Update File Formats"],
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
+    ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
     ["F","mm_sy","tarRes",5,"Restore Database"],
     ["F","mm_sy","tarCfg",0,"Preferences"],

=== modified file 'men/scpmen.py'
--- men/scpmen.py	2015-04-10 10:19:18 +0000
+++ men/scpmen.py	2018-08-15 08:15:04 +0000
@@ -35,7 +35,8 @@
     ["MM","mm_sc","Master"],
     ["MM","mm_hp","Help","right"]]
 msmod = [
-    ["F","mm_sy","tarUpd",5,"Update File Formats"],
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
+    ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
     ["F","mm_sy","tarRes",5,"Restore Database"],
     ["F","mm_sy","tarCfg",0,"Preferences"],

=== modified file 'men/stdmen.py'
--- men/stdmen.py	2018-05-31 15:57:14 +0000
+++ men/stdmen.py	2018-08-17 14:49:05 +0000
@@ -69,7 +69,7 @@
     ["F","mm_sy","chgUsr",0,"Change User"],
     ["F","mm_sy","chgPwd",0,"Change Password"],
     ["F","mm_sy","tarUsr",7,"User's Maintenance"],
-    ["F","mm_sy","sysUpd",0,"Upgrade System"],
+    ["F","mm_sy","sysUpd",8,"Upgrade System"],
     ["F","mm_sy","tarUpd",8,"Update File Formats"],
     ["PNNN","mm_sy","tb1040",9,"Copy Tables"],
     ["F","mm_sy","tarBck",0,"Backup Database"],
@@ -403,8 +403,8 @@
 rcmen = [
     ["CM","mm_rc","rc_fm","File Maintenance"],
     ["CM","mm_rc","rc_rp","Reporting"],
-    ["CM","mm_rc","rc_qy","Interrogation"],
-    ["CM","mm_rc","rc_tb","Toolbox"]]
+    ["CM","mm_rc","rc_qy","Interrogation"]]
+    #["CM","mm_rc","rc_tb","Toolbox"]]
 rcmod = [
     ["PYNY","rc_fm","rcc110",5,"Control Record"],
     ["PYNY","rc_fm","rc1010",3,"Owners Records"],
@@ -424,9 +424,9 @@
     ["PNNN","rc_rp","rcc220",1,"Statement Messages"],
     ["PYNY","rc_qy","rc4010",0,"Owners Interrogation"],
     ["PYNY","rc_qy","rc4020",0,"Tenants Interrogation"],
-    ["PNNN","rc_tb","rc6010",1,"CSV Masterfile Importing"],
-    ["PNNN","rc_tb","rc6020",1,"CSV Transaction Importing"],
-    ["PNNN","rc_tb","rc6030",1,"Check for Missing Records"],
+    #["PNNN","rc_tb","rc6010",1,"CSV Masterfile Importing"],
+    #["PNNN","rc_tb","rc6020",1,"CSV Transaction Importing"],
+    #["PNNN","rc_tb","rc6030",1,"Check for Missing Records"],
     ["PYNY","mm_rc","rc2010",2,"Data Capture",0],
     ["PYNY","mm_rc","rcm010",4,"Month End Routine",0]]
 

=== modified file 'mst/ms0000.py'
--- mst/ms0000.py	2018-07-13 08:38:41 +0000
+++ mst/ms0000.py	2018-08-19 10:43:42 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import getopt, os, sys
@@ -38,7 +38,7 @@
     temp = tuple(os.environ["TARVER"].split("."))
     VERSION = (int(temp[0]), int(temp[1]), int(temp[2]))
 else:
-    VERSION = (5, 3, 11)
+    VERSION = (5, 3, 12)
 if __name__ == "__main__":
     # Run Tartan
     try:

=== modified file 'mst/ms1010.py'
--- mst/ms1010.py	2017-08-24 07:49:34 +0000
+++ mst/ms1010.py	2018-07-20 08:04:30 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mst/ms1010_oth.py'
--- mst/ms1010_oth.py	2017-08-24 07:49:34 +0000
+++ mst/ms1010_oth.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms1010_rne.py'
--- mst/ms1010_rne.py	2017-08-24 07:49:34 +0000
+++ mst/ms1010_rne.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'mst/ms1020.py'
--- mst/ms1020.py	2017-08-24 07:49:34 +0000
+++ mst/ms1020.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'mst/ms1030.py'
--- mst/ms1030.py	2017-08-24 07:49:34 +0000
+++ mst/ms1030.py	2018-07-17 06:11:59 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog, Sql

=== modified file 'mst/ms1040.py'
--- mst/ms1040.py	2018-04-08 06:05:45 +0000
+++ mst/ms1040.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms3010.py'
--- mst/ms3010.py	2018-07-13 08:38:41 +0000
+++ mst/ms3010.py	2018-08-10 11:49:42 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -465,7 +465,7 @@
                 self.ttipv[cat][vtr.disp] = 0
                 self.ttipt[cat][vtr.disp] = 0
         tax = CCD(data[self.sql.ctlvtf_col.index("vtt_tax")],"SD",13.2)
-        inc = CCD(((exc.work * 100) + (tax.work * 100)) / 100, "SD", 13.2)
+        inc = CCD((exc.work + tax.work), "SD", 13.2)
         return (vtyp, curdt,styp, ttyp, acno, refno, refdt, desc, exc, vtr,
                 tax, inc)
 
@@ -544,7 +544,7 @@
         self.ctopt = 0
 
     def doPrintCatTotal(self, ttype="P", page=True):
-        rates = self.ttipv[self.pcat].keys()
+        rates = list(self.ttipv[self.pcat].keys())
         rates.sort()
         for num, rte in enumerate(rates):
             j = CCD(self.ttipv[self.pcat][rte], "SD", 13.2)
@@ -585,7 +585,7 @@
                 continue
             if self.cat == "B" and c[0] == "N":
                 continue
-            rates = self.ttipv[c[0]].keys()
+            rates = list(self.ttipv[c[0]].keys())
             rates.sort()
             desc = True
             for rte in rates:

=== modified file 'mst/ms3020.py'
--- mst/ms3020.py	2017-08-24 07:49:34 +0000
+++ mst/ms3020.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/ms3030.py'
--- mst/ms3030.py	2017-08-24 07:49:34 +0000
+++ mst/ms3030.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/msc000.py'
--- mst/msc000.py	2018-06-18 06:16:26 +0000
+++ mst/msc000.py	2018-08-18 06:59:13 +0000
@@ -6,19 +6,18 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
-import cStringIO, fpdf, getpass, gc, glob, os, platform, sys, time
+import fpdf, getpass, gc, glob, os, platform, sys, requests, time
 from TartanClasses import AboutTartan, CCD, Dbase, DBCreate, FileDialog
 from TartanClasses import GetCtl, GUI, MainFrame, MkWindow, PwdConfirm
 from TartanClasses import ScrollText, SelectChoice, Sql, TarBckRes
-from TartanClasses import TartanConfig, TartanDialog, TartanMenu
-from TartanClasses import TartanUser
+from TartanClasses import TartanConfig, TartanDialog, TartanMenu, TartanUser
 from tartanFunctions import askQuestion, b64Convert, copyList, dateDiff
-from tartanFunctions import ftpDownload, getPeriods, getPrgPath
-from tartanFunctions import internetConnect, loadRcFile, parsePrg, projectDate
-from tartanFunctions import runModule, showError, showException
+from tartanFunctions import getPeriods, getPrgPath, internetConnect
+from tartanFunctions import loadRcFile, parsePrg, projectDate, runModule
+from tartanFunctions import showError, showException
 
 class msc000:
     def __init__(self, version, opts, args):
@@ -175,7 +174,7 @@
         if not self.version and not self.xdisplay:
             nodisp = ("tarBck", "tarUpd", "ml6030")
             if not self.query and self.program not in nodisp:
-                print("xdisplay False but program not in %s" % str(nodisp))
+                print("xdisplay False but module not in %s" % str(nodisp))
                 self.doExit(dbm=False)
             elif not self.user:
                 print("xdisplay False but No User Name")
@@ -271,7 +270,7 @@
                 self.doExit(dbm=False)
         self.mf = None
         self.rcdic = None
-        main = "Tartan Systems - Copyright %s 2004-2017 P Malherbe" % u"\u00A9"
+        main = "Tartan Systems - Copyright %s 2004-2018 P Malherbe" % u"\u00A9"
         while not self.rcdic:
             self.rcdic = loadRcFile(self.rcfile, default=True)
             if self.rcdic == "error":
@@ -344,7 +343,15 @@
             self.userLogin()
         else:
             # Check if user details supplied are valid
-            self.userReadCheck(user=self.user["name"], pwd=self.user["pwd"])
+            self.userReadCheck(user=self.user["name"], pwd=self.user["pwd"],
+                pwdchk=True)
+            if not self.user:
+                if self.xdisplay:
+                    scrn = self.mf.window
+                else:
+                    scrn = "text"
+                showError(scrn, "Error", "Invalid User or User Password")
+                self.doExit()
         if not self.user:
             self.doExit()
         if not self.program or self.program != "tarUpd":
@@ -383,6 +390,8 @@
                     self.mf.window.deiconify()
                 self.execCommand(mod[0], self.program, mod[4], rtn=self.tcode,
                     menu=False)
+            else:
+                print("Missing Options e,g, (-c, -f or -t)")
             self.doExit()
         if self.itoggle:
             if self.mf.rcdic["img"].lower() == "y":
@@ -683,6 +692,8 @@
                 self.mf.updateStatus("")
             try:
                 getattr(self, prg)()
+            except SystemExit:
+                os._exit(0)
             except:
                 if self.xdisplay:
                     showException(self.mf.body, self.rcdic["wrkdir"],
@@ -1236,17 +1247,25 @@
 
     def doSysLoc(self, frt, pag, r, c, p, i, w):
         self.updtyp = w
-        sql = Sql(self.db, "ctlmst", prog="msc000")
-        chk = sql.getRec(tables="ctlmst", cols=["ctm_modules"],
-            group="ctm_modules")
-        self.upgsys = ""
-        for mod in chk:
-            if mod == ["BC"] and self.upgsys is not "Tartan":
-                self.upgsys = "Bwlclb"
-            elif mod == ["SC"] and self.upgsys is not "Tartan":
-                self.upgsys = "Seccmp"
-            else:
-                self.upgsys = "Tartan"
+        sql = Sql(self.db, ["ctlmst", "bksmst", "crsrmf", "cshana", "scpclb"],
+            prog="msc000")
+        if "bksmst" not in sql.error:
+            self.upgsys = "Bksclb"
+        elif "cshana" not in sql.error:
+            self.upgsys = "Cshana"
+        elif "crsrmf" not in sql.error:
+            self.upgsys = "Rnehol"
+        elif "scpclb" not in sql.error:
+            self.upgsys = "Seccmp"
+        else:
+            self.upgsys = ""
+            chk = sql.getRec(tables="ctlmst", cols=["ctm_modules"],
+                group="ctm_modules")
+            for mod in chk:
+                if mod == ["BC"] and self.upgsys is not "Tartan":
+                    self.upgsys = "Bwlclb"
+                else:
+                    self.upgsys = "Tartan"
         if self.updtyp == "I":
             err = self.doSysChkUpgrade()
             if err:
@@ -1291,18 +1310,10 @@
 
     def doSysChkUpgrade(self):
         try:
-            err = self.conoCheck(1)
-            if err or not self.email:
-                self.email = "info@tartan.co.za"
-            flenam = cStringIO.StringIO()
-            err = ftpDownload("tartan.co.za", "current",
-                word=self.email, dest=flenam)
-            if err:
+            r = requests.get("http://tartan.co.za/files/current")
+            if r.status_code is not 200:
                 raise Exception
-            v = flenam.getvalue()
-            flenam.close()
-            # Read and create Tartan file
-            v = v.rstrip().split(".")
+            v = r.content.split(".")
             self.newver = (int(v[0]), int(v[1]), int(v[2]))
             self.nvtxt = "%s.%s.%s" % self.newver
             if self.newver[0] > self.current[0][0]:
@@ -1346,17 +1357,21 @@
      Windows, execute the file.""" % (self.upgsys, self.upgsys))
         try:
             if self.updtyp == "I":
+                url = "http://tartan.co.za/files/"
                 if sys.platform == "win32":
                     nam = self.upgsys + "_%s.%s.%s_upd" % self.newver + ".exe"
-                    if not ftpDownload("tartan.co.za", nam, check=True):
+                    r = requests.get(url + nam)
+                    if r.status_code is not 200:
                         nam = self.upgsys + "_%s.%s.%s" % self.newver + ".exe"
+                        r = requests.get(url + nam)
                 else:
                     nam = self.upgsys + "_%s.%s.%s" % self.newver + ".tgz"
+                    r = requests.get(url + nam)
+                if r.status_code is not 200:
+                    raise Exception
                 fle = os.path.join(self.mf.rcdic["upgdir"], nam)
-                err = ftpDownload("tartan.co.za", nam, word=self.email,
-                    dest=fle, close=True)
-                if err:
-                    raise Exception
+                with open(fle, "wb") as code:
+                    code.write(r.content)
             else:
                 fle = self.updfle
             if sys.platform == "win32":
@@ -1410,13 +1425,8 @@
 
     def doVersionCheck(self, vtype="chk"):
         error = None
-        self.oldver = (0, 0, 0)
-        self.ovtxt = "%s.%s.%s" % self.oldver
-        upddate = CCD(0, "d1", 10)
-        if self.xdisplay:
-            scrn = self.mf.window
-        else:
-            scrn = "text"
+        self.ovlst = (0, 0, 0)
+        self.ovtxt = "%s.%s.%s" % self.ovlst
         if not self.db.dbopen:
             self.db.openDbase()
             dbopend = True
@@ -1428,11 +1438,12 @@
                 return "missing"
             else:
                 return
+        upddate = CCD(0, "d1", 10)
         ver = sql.getRec(tables="verupd", limit=1)
         if ver:
             v = ver[0].split(".")
-            self.oldver = (int(v[0]), int(v[1]), int(v[2]))
-            self.ovtxt = "%s.%s.%s" % self.oldver
+            self.ovlst = (int(v[0]), int(v[1]), int(v[2]))
+            self.ovtxt = "%s.%s.%s" % self.ovlst
             upd = sql.getRec(tables="verupd", cols=["ver_upddate"],
                 where=[("ver_version", "=", ver[0])], limit=1)
             if upd:
@@ -1440,21 +1451,25 @@
         if dbopend:
             self.db.closeDbase()
         if vtype == "chk" and not self.nocheck:
-            if self.oldver == (0, 0, 0):
+            if self.ovlst == (0, 0, 0):
                 error = "not"
-            elif self.oldver < (4, 1, 10):
+            elif self.ovlst < (4, 1, 10):
                 error = "tooold"
-            elif self.oldver < self.current[0]:
+            elif self.ovlst < self.current[0]:
                 error = "newer"
-            elif self.oldver > self.current[0]:
+            elif self.ovlst > self.current[0]:
                 error = "older"
         elif vtype == "upd":
-            if self.oldver == (0, 0, 0):
+            if self.ovlst == (0, 0, 0):
                 pass
-            elif self.oldver == self.current[0]:
+            elif self.ovlst == self.current[0]:
                 error = "updated"
-            elif self.oldver > self.current[0]:
+            elif self.ovlst > self.current[0]:
                 error = "older"
+        if self.xdisplay:
+            scrn = self.mf.window
+        else:
+            scrn = "text"
         if error == "tooold":
             showError(scrn, "Version Error",
                 """The Version of the Data, %s.%s.%s, is too Old.
@@ -1463,7 +1478,7 @@
 
 or
 
-Email info@tartan.co.za, with your current version number, for assistance.""" % self.oldver)
+Email info@tartan.co.za, with your current version number, for assistance.""" % self.ovlst)
             self.doExit()
         elif error == "not":
             showError(scrn, "Version Error", """'Update File Formats'
@@ -1515,6 +1530,12 @@
                 TarBckRes(self.mf, mode="B", csys=csys, bar=False)
             else:
                 TarBckRes(self.mf, mode="B", csys=csys)
+        else:
+            if self.xdisplay:
+                scrn = self.mf.window
+            else:
+                scrn = "text"
+            showError(scrn, "Error", "Invalid Backup Password")
 
     def tarRes(self):
         cf = PwdConfirm(self.mf, conum=0, system="MST", code="TarRes",
@@ -1588,27 +1609,29 @@
             try:
                 sys.stdout.close()
                 sys.stdout = sys.__stdout__
-                if os.path.getsize(self.stdout) and not self.debug:
+                if os.path.getsize(self.stdout):
                     text = open(self.stdout, "r")
                     lines = text.readlines()
                     text.close()
-                    if self.debug and len(lines) > 50:
-                        maxi = 50
+                    if self.debug and len(lines) > 1000:
+                        maxi = 1000
                     else:
                         maxi = len(lines)
                     mess = ""
                     for x in xrange(maxi):
                         mess = "%s%s" % (mess, lines[x - maxi])
+                    if self.version:
+                        scrn = None
+                    else:
+                        scrn = self.mf.body
                     if self.debug:
-                        if self.xdisplay:
-                            ScrollText(title="Trace Output", mess=mess)
-                        else:
-                            print("Trace Output: ", mess)
-                    else:
-                        if self.xdisplay:
-                            ScrollText(title="Standard Output", mess=mess)
-                        else:
-                            print("Standard Output: ", mess)
+                        titl = "Trace Output"
+                    else:
+                        titl = "Standard Output"
+                    if self.xdisplay:
+                        ScrollText(title=titl, scrn=scrn, mess=mess)
+                    else:
+                        print(titl, mess)
                 # Housekeeping
                 for pid in xrange(1000):
                     try:
@@ -1619,7 +1642,7 @@
             except:
                 pass
         if sysexit:
-            os._exit(1)
+            sys.exit()
 
     def doCheckSys(self):
         sql = Sql(self.db, "ctlsys", prog=__name__)
@@ -1706,22 +1729,24 @@
                     sq = Sql(self.db)
                     if sel:
                         ret = sq.sqlRec(line, limit=qty)
-                        mess = ""
+                        self.mess = ""
                         for r in ret:
                             if type(r) is list:
                                 r = str(r)[1:-1]
                             else:
                                 r = str(r)
-                            if not mess:
-                                mess = r
+                            if not self.mess:
+                                self.mess = r
                             else:
-                                mess = mess + "\n" + r
+                                self.mess = self.mess + "\n" + r
                         if self.xdisplay and self.output:
                             self.mf.window.deiconify()
                             self.mf.head.configure(text="SQL Query")
-                            ScrollText(scrn=self.mf.body, mess=mess)
+                            but = ([("Save", self.doSave)])
+                            ScrollText(scrn=self.mf.body, mess=self.mess,
+                                butt=but)
                         else:
-                            print(mess)
+                            print(self.mess)
                     else:
                         sq.sqlRec(line)
             except:
@@ -1729,4 +1754,9 @@
                 return "Error in SQL Statement\n\n%s" % line
         self.db.closeDbase()
 
+    def doSave(self):
+        fle = open(os.path.join(self.rcdic["wrkdir"], "query.txt"), "w")
+        fle.write(self.mess)
+        fle.close()
+
 # vim:set ts=4 sw=4 sts=4 expandtab:

=== removed file 'mst/msc000_rne.py'
--- mst/msc000_rne.py	2018-07-13 08:38:41 +0000
+++ mst/msc000_rne.py	1970-01-01 00:00:00 +0000
@@ -1,1731 +0,0 @@
-"""
-SYNOPSIS
-    This file is part of Tartan Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
-"""
-
-import cStringIO, fpdf, getpass, gc, glob, os, platform, sys, time
-from TartanClasses import AboutTartan, CCD, Dbase, DBCreate, FileDialog
-from TartanClasses import GetCtl, GUI, MainFrame, MkWindow, PwdConfirm
-from TartanClasses import ScrollText, SelectChoice, Sql, TarBckRes
-from TartanClasses import TartanConfig, TartanDialog, TartanMenu, TartanUser
-from tartanFunctions import askQuestion, b64Convert, copyList, dateDiff
-from tartanFunctions import ftpDownload, getPeriods, getPrgPath
-from tartanFunctions import internetConnect, loadRcFile, parsePrg, projectDate
-from tartanFunctions import runModule, showError, showException
-
-class msc000:
-    def __init__(self, version, opts, args):
-        self.current = [version, "%s.%s.%s" % version]
-        default = [
-            ("bpwd", ""),
-            ("conum", None),
-            ("debug", False),
-            ("exclude", []),
-            ("finper", None),
-            ("help", False),
-            ("itoggle", False),
-            ("loader", False),
-            ("menu", "stdmen"),
-            ("nocheck", False),
-            ("program", None),
-            ("query", None),
-            ("rcfdir", None),
-            ("rcfile", None),
-            ("script", None),
-            ("sysmod", "stdsys"),
-            ("tcode", 0),
-            ("user", {}),
-            ("version", False),
-            ("xdisplay", True),
-            ("zerobar", False)]
-        if sys.platform == "win32":
-            default.append(("output", True))
-        else:
-            default.append(("output", False))
-        for arg, val in default:
-            setattr(self, arg, val)
-        for o, v in opts:
-            if o in ("-b", "--bpwd"):
-                self.bpwd = v
-            elif o in ("-c", "--conum"):
-                self.conum = int(v)
-            elif o in ("-d", "--debug"):
-                self.debug = True
-            elif o in ("-e", "--exclude"):
-                self.exclude = v.split(",")
-            elif o in ("-f", "--finper"):
-                self.finper = int(v)
-            elif o in ("-h", "--help"):
-                self.help = True
-            elif o in ("-i", "--image"):
-                self.itoggle = True
-            elif o in ("-l", "--loader"):
-                self.loader = True
-            elif o in ("-m", "--menu"):
-                self.menu = v
-            elif o in ("-n", "--nocheck"):
-                self.nocheck = True
-            elif o in ("-o", "--output"):
-                if sys.platform == "win32":
-                    self.output = False
-                else:
-                    self.output = True
-            elif o in ("-p", "--program"):
-                self.program = v
-            elif o in ("-q", "--query"):
-                if not args:
-                    if len(v.split()) == 1:
-                        self.query = v  # Execute sql commands in a file
-                    else:
-                        self.query = [v.replace("\\", "")]
-                else:
-                    self.query = []
-                    for a in args:
-                        if a == ";":
-                            self.query.append(v)
-                            v = ""
-                            continue
-                        if not v:
-                            v = a
-                        else:
-                            v = "%s %s" % (v, a.replace("\\", ""))
-                    self.query.append(v)
-            elif o in ("-R", "--rcfdir"):
-                self.rcfdir = v
-            elif o in ("-r", "--rcfile"):
-                self.rcfile = v
-            elif o == "--script":
-                self.script = v
-            elif o in ("-s", "--sysmod"):
-                self.sysmod = v
-            elif o in ("-t", "--tcode"):
-                self.tcode = int(v)
-            elif o in ("-u", "--user"):
-                user = v.split(":")
-                self.user["name"] = user[0]
-                if len(user) == 2:
-                    self.user["pwd"] = user[1]
-                else:
-                    self.user["pwd"] = ""
-            elif o in ("-v", "--version"):
-                self.version = True
-            elif o in ("-x", "--xdisplay"):
-                self.xdisplay = False
-            elif o in ("-z", "--zerobar"):
-                self.zerobar = True
-        if self.output:
-            # Redirect stdout
-            for pid in xrange(1000):
-                if self.debug:
-                    name = "tracer_%s.txt" % pid
-                else:
-                    name = "stdout_%s.txt" % pid
-                self.stdout = os.path.join(getPrgPath(), name)
-                try:
-                    if not os.path.exists(self.stdout):
-                        sys.stdout = open(self.stdout, "w")
-                        os.chmod(self.stdout, 0777)
-                        break
-                except:
-                    pass
-        if self.script:
-            if os.sep in self.script or self.script.count(".py"):
-                import imp
-                imp.load_source(os.path.basename(self.script), self.script)
-            else:
-                __import__(self.script)
-            self.doExit(dbm=False)
-        if self.help:
-            print("""
-Usage:      python ms0000.py [options]
-
-Options:
-            -b, --bpwd=             The backup password
-            -c, --conum=            The company number
-            -d, --debug             Enter debug/trace mode
-            -e, --exclude=          Modules to ignore in debug/trace mode
-            -f, --finper=           The financial period
-            -h, --help              This Help Message
-            -i, --image             Toggle the Tartan image option.
-            -l, --loader            Try and remove module before importing
-            -m, --menu=             The menu to use, defaults to stdmen
-            -n, --nocheck           Do not check for system records
-            -o, --output            Toggle stdout redirection to stdout.txt
-                                        Linux   defaults to False
-                                        Windows defaults to True
-            -p, --program=          Execute program directly bypassing the menu
-            -q, --query=            Execute a sql query
-            -R, --rcfdir=           Directory of Available Tartan RC Files
-            -r, --rcfile=           Path of Tartan RC File to use
-            -s, --sysmod=           Name of the system module to use
-            -t, --tcode=            Transaction code
-            -u, --user=             User name and password e.g. name:password
-            -v, --version           Display Version Details
-            -x, --xdisplay          Do not have a mainframe with -ptarBck
-            -z, --zerobar           Do not have a progressbar with -ptarBck
-""")
-            self.doExit(dbm=False)
-        if not self.version and not self.xdisplay:
-            nodisp = ("tarBck", "tarUpd", "ml6030")
-            if not self.query and self.program not in nodisp:
-                print("xdisplay False but program not in %s" % str(nodisp))
-                self.doExit(dbm=False)
-            elif not self.user:
-                print("xdisplay False but No User Name")
-                self.doExit(dbm=False)
-        if not self.version and self.xdisplay and not GUI:
-            print("Tkinter/ttk not Available or Installed")
-            self.doExit(dbm=False)
-        if self.version:
-            nm = platform.uname()
-            print("%-16s: %s, %s, %s" % ("O/System", nm[0], nm[2], nm[4]))
-            print("%-16s: %s" % ("Tartan", self.current[1]))
-            print("%-16s: %s" % ("Python", sys.version.split()[0]))
-            if self.xdisplay:
-                from TartanClasses import tk
-                from PIL import VERSION
-                print("%-16s: %s" % ("Tcl/Tk",
-                        tk.Tcl().eval("info patchlevel")))
-                print("%-16s: %s" % ("PIL", VERSION))
-            try:
-                import fdb
-                print("%-16s: %s" % ("FDB", fdb.__version__))
-            except:
-                pass
-            try:
-                import MySQLdb
-                print("%-16s: %s" % ("MySQLdb", MySQLdb.__version__))
-            except:
-                try:
-                    import pymysql
-                    print("%-16s: %s" % ("Pymysql", pymysql.__version__))
-                except:
-                    pass
-            try:
-                import psycopg2
-                print("%-16s: %s" % ("Psycopg2",
-                        psycopg2.__version__.split()[0]))
-            except:
-                pass
-            try:
-                import pychart.version
-                print("%-16s: %s" % ("Pychart", pychart.version.version))
-            except:
-                pass
-            try:
-                import sqlite3
-                print("%-16s: %s" % ("Pysqlite", sqlite3.version))
-                print("%-16s: %s" % ("Sqlite3", sqlite3.sqlite_version))
-            except:
-                pass
-            try:
-                print("%-16s: %s" % ("Fpdf", fpdf.__version__))
-            except:
-                pass
-            try:
-                import xlrd
-                print("%-16s: %s" % ("Xlrd", xlrd.info.__VERSION__))
-            except:
-                pass
-            try:
-                import xlwt
-                print("%-16s: %s" % ("Xlwt", xlwt.__VERSION__))
-            except:
-                pass
-            self.doExit(dbm=False)
-        if self.debug:
-            # Set trace mode
-            import trace
-            igm = ["__init__"]
-            if self.exclude:
-                igm.extend(self.exclude)
-            if sys.platform == "win32" and \
-                    os.path.basename(sys.path[0]) == "library.zip":
-                igd = []
-                for mod in sys.modules:
-                    igm.append(mod)
-            else:
-                igd = [sys.prefix, sys.exec_prefix]
-            os.environ["TARTANDB"] = "1"
-            self.tracer = trace.Trace(ignoredirs=igd, ignoremods=igm,
-                trace=1, count=0)
-        self.setVariables()
-        if self.rcfdir:
-            if not os.path.isdir(self.rcfdir):
-                showError(None, "Directory Error",
-                    "Invalid -R Directory: %s" % self.rcfdir)
-                self.doExit(dbm=False)
-            icon = os.path.join(getPrgPath(), "img", "tartan.png")
-            scrn = MkWindow(tk=True, icon=icon).newwin
-            dialog = FileDialog(**{"parent": scrn, "initd": self.rcfdir})
-            self.rcfile = dialog.askopenfilename()
-            scrn.destroy()
-            if not self.rcfile:
-                self.doExit(dbm=False)
-        self.mf = None
-        self.rcdic = None
-        main = "Tartan Systems - Copyright %s 2004-2017 P Malherbe" % u"\u00A9"
-        while not self.rcdic:
-            self.rcdic = loadRcFile(self.rcfile, default=True)
-            if self.rcdic == "error":
-                self.doExit(dbm=False)
-            elif not os.path.isfile(self.rcdic["name"]):
-                self.mf = MainFrame(title=main, rcdic=self.rcdic)
-                if self.mf.rcdic == "error":
-                    self.doExit(dbm=False)
-                self.mf.window.deiconify()
-                self.mf.dbm = None
-                cfg = TartanConfig(self.mf, rcfile=self.rcfile,
-                    rcdic=self.rcdic, level=9)
-                if not cfg.rcfile:
-                    self.doExit(dbm=False)
-                self.rcfile = self.mf.rcfile = cfg.rcfile
-                self.rcdic = self.mf.rcdic = loadRcFile(self.rcfile)
-        titl = "%s - (%s - %s@%s)" % (main, self.rcdic["dbase"],
-            self.rcdic["dbname"], self.rcdic["dbhost"])
-        if not self.mf:
-            # Create MainFrame if not already existing
-            self.mf = MainFrame(title=titl, rcdic=self.rcdic,
-                xdisplay=self.xdisplay)
-            if self.mf.rcdic == "error":
-                self.doExit(dbm=False)
-        else:
-            self.mf.window.title(titl)
-        # Try connecting to the database and create if missing
-        if self.mf.children:
-            screen = self.mf.body
-        else:
-            screen = self.mf.window
-        self.db = Dbase(rcdic=self.rcdic, screen=screen)
-        if self.db.err:
-            self.doExit(dbm=False)
-        self.mf.dbm = self.db
-        err = self.db.checkDbase()
-        if err not in (True, False):
-            self.doExit()
-        elif err is False:
-            ok = askQuestion(self.mf.window, "Database",
-                "Create the Database Now?")
-            if ok == "no":
-                self.doExit()
-            else:
-                opts = [
-                    ("-c", "i"),
-                    ("-d", "%s" % os.path.join(self.rcdic["prgdir"], "csv")),
-                    ("-l", self.mf.body),
-                    ("-u", self.rcdic["dbuser"]),
-                    ("-p", self.rcdic["dbpwd"]),
-                    ("-s", self.sysmod),
-                    ("-v", self.current[1]),
-                    ("-x", True)]
-                DBCreate(dbm=self.db, opts=opts)
-                self.tarUpd(True)
-        if not self.nocheck:
-            # Open the database
-            self.db.openDbase()
-            # Check for ctlsys and ctlmst
-            err = self.doCheckSys()
-            # Check for ctlmst and if missing call ms1010 or scc110
-            if not err:
-                err = self.doCheckMst()
-            # Close the database
-            if err:
-                self.doExit()
-            self.db.closeDbase()
-        if not self.user:
-            # Login user
-            self.userLogin()
-        else:
-            # Check if user details supplied are valid
-            self.userReadCheck(user=self.user["name"], pwd=self.user["pwd"])
-        if not self.user:
-            self.doExit()
-        if not self.program or self.program != "tarUpd":
-            # Check tartan version
-            self.db.openDbase()
-            self.doVersionCheck()
-            self.db.closeDbase()
-        if self.query:
-            if self.user["lvl"] == 9:
-                err = self.doSqlCmd()
-            else:
-                err = "Invalid Security Level"
-            if err:
-                if self.xdisplay:
-                    showError(self.mf.body, "Data Base Error",
-                        "\nDbCommand Error: %s\n" % err)
-                else:
-                    print("Data Base Error", "DbCommand Error: %s\n" % err)
-            self.doExit()
-        if self.program:
-            mods = copyList(self.usrmod)
-            mods.append(["PNNN", "mm_sy", "tb1010", 9, "Amend Tables"])
-            mods.append(["PNNN", "mm_sy", "tb1030", 9, "Edit Tables"])
-            mods.append(["PNNN", "mm_sy", "tb3010", 9, "Print Tables"])
-            found = False
-            for mod in mods:
-                if mod[2] == self.program:
-                    if len(mod) == 5:
-                        found = True
-                        break
-                    elif len(mod) == 6 and mod[5] == self.tcode:
-                        found = True
-                        break
-            if found:
-                if self.xdisplay:
-                    self.mf.window.deiconify()
-                self.execCommand(mod[0], self.program, mod[4], rtn=self.tcode,
-                    menu=False)
-            self.doExit()
-        if self.itoggle:
-            if self.mf.rcdic["img"].lower() == "y":
-                self.image = False
-            else:
-                self.image = True
-        elif self.mf.rcdic["img"].lower() == "y":
-            self.image = True
-        else:
-            self.image = False
-        if self.image:
-            image = os.path.join(self.rcdic["prgdir"], "img", "tartan.png")
-        else:
-            image = None
-        self.tarmen = TartanMenu(mf=self.mf, usr=self.user["name"],
-            men=self.usrmen, mod=self.usrmod, lvl=self.user["lvl"],
-            cmd=self.execCommand, img=image)
-        if not self.doVersionCheck():
-            self.checkNotes()
-        self.tarmen.drawMenu()
-
-    def setVariables(self):
-        stdmen = __import__(self.menu)
-        self.vop = []
-        self.sss = {}
-        self.men = []
-        self.mod = []
-        self.acoy = []
-        self.dcoy = []
-        for s in stdmen.systems:
-            self.sss[s[0]] = s[1]
-            try:
-                self.men.extend(getattr(stdmen, "%2smen" % s[0]))
-                self.mod.extend(getattr(stdmen, "%2smod" % s[0]))
-            except:
-                pass
-        t = time.localtime()
-        self.sysdtw = (t[0] * 10000) + (t[1] * 100) + t[2]
-        self.direct = False
-        self.tarmen = None
-        self.email = None
-
-    def userLogin(self):
-        if not self.db.dbopen:
-            self.db.openDbase()
-            dbopend = True
-        else:
-            dbopend = False
-        if not self.user:
-            self.userReadCheck()
-            if self.user and not self.user["pwd"]:
-                return
-        if self.user:
-            login = self.user["name"]
-        else:
-            try:
-                login = getpass.getuser()
-                if not self.userReadCheck(login, userchk=True):
-                    raise Exception
-            except:
-                login = ""
-        self.mf.head.configure(text="TARTAN User Login and Validation")
-        tit = ("User Validation",)
-        fld = (
-            (("T",0,0,0),"INA",30,"Name","Your User Name",
-                login,"N",self.usrNam,None,None,None,None,
-                "Your log-in Name"),
-            (("T",0,1,0),"IHA",30,"Password","Your Password",
-                "","N",self.usrPwd,None,None,None,None,
-                "Your password. You are allowed a Maximum of 3 attempts."))
-        but = (("Quit", None, self.noUser, 1, None, None),)
-        self.li = TartanDialog(self.mf, tops=True, title=tit, eflds=fld,
-            butt=but, tend=((self.endUser, "n"),), txit=(self.noUser,))
-        self.mf.startLoop()
-        if dbopend:
-            self.db.closeDbase()
-
-    def usrNam(self, frt, pag, r, c, p, i, w):
-        self.userReadCheck(w)
-        if not self.user:
-            return "Invalid User"
-        if not self.user["pwd"]:
-            return "sk1"
-        self.times = 0
-
-    def usrPwd(self, frt, pag, r, c, p, i, w):
-        err = self.userCheckPwd(w)
-        if not err:
-            return "nc"
-        elif err == "Expired Password" or self.times == 2:
-            return "xt"
-        else:
-            self.times += 1
-            return "Invalid Password"
-
-    def noUser(self, widget=None):
-        self.user = {}
-        self.endUser()
-
-    def endUser(self):
-        self.li.closeProcess()
-        self.mf.closeLoop()
-
-    def userReadCheck(self, user=None, userchk=False, pwd=None, pwdchk=False):
-        if not self.db.dbopen:
-            self.db.openDbase()
-            dbopend = True
-        else:
-            dbopend = False
-        sql = Sql(self.db, ["ctlmst", "ctlpwu", "ctlpwm"], prog="msc000")
-        if not user:
-            chk = sql.getRec(tables="ctlpwu")
-            if len(chk) == 1:
-                user = chk[0][sql.ctlpwu_col.index("usr_name")]
-        usr = sql.getRec(tables="ctlpwu", where=[("usr_name", "=", user)],
-            limit=1)
-        if userchk:
-            if dbopend:
-                self.db.closeDbase()
-            return usr
-        if not usr:
-            self.user = {}
-        else:
-            self.user = {
-                "name": user,
-                "pwd":  usr[sql.ctlpwu_col.index("usr_pwd")]}
-            if "usr_last" in sql.ctlpwu_col:
-                self.user["last"] = usr[sql.ctlpwu_col.index("usr_last")]
-            else:
-                self.user["last"] = 0
-            if "usr_coy" in sql.ctlpwu_dic:
-                self.user["acoy"] = usr[sql.ctlpwu_col.index("usr_coy")]
-                self.user["dcoy"] = ""
-            else:
-                self.user["acoy"] = usr[sql.ctlpwu_col.index("usr_acoy")]
-                self.user["dcoy"] = usr[sql.ctlpwu_col.index("usr_dcoy")]
-            self.user["lvl"] = usr[sql.ctlpwu_col.index("usr_lvl")]
-            if pwdchk and self.user["pwd"] and self.userCheckPwd(pwd):
-                self.user = {}
-            if self.user:
-                self.acoy = []
-                self.dcoy = []
-                self.usrnam = self.user["name"]
-                self.pwd = self.user["pwd"]
-                acoy = self.user["acoy"]
-                dcoy = self.user["dcoy"]
-                self.lvl = self.user["lvl"]
-                if acoy:
-                    acoy = acoy.split(",")
-                else:
-                    acoy = []
-                for co in acoy:
-                    if int(co):
-                        self.acoy.append(int(co))
-                if dcoy:
-                    dcoy = dcoy.split(",")
-                else:
-                    dcoy = []
-                for co in dcoy:
-                    if int(co):
-                        self.dcoy.append(int(co))
-                nos = []
-                # All systems not in the company modules
-                for sss in self.sss:
-                    if sss not in ("bm", "bs", "ca", "ms", "rp", "td"):
-                        nos.append(sss)
-                ctm = sql.getRec(tables="ctlmst", cols=["ctm_modules"])
-                for m in ctm:
-                    for x in xrange(0, len(m[0]), 2):
-                        if m[0][x:x+2].lower() in nos:
-                            nos.remove(m[0][x:x+2].lower())
-                # All systems excluded for the user - nos
-                tmp = sql.getRec(tables="ctlpwm", cols=["mpw_sys"],
-                    where=[("mpw_usr", "=", self.user["name"]),
-                    ("mpw_prg", "=", "")])
-                if tmp:
-                    for s in tmp:
-                        if s not in nos:
-                            nos.append(s[0])
-                # All modules excluded for the user - nop
-                nop = sql.getRec(tables="ctlpwm", cols=["mpw_sys", "mpw_prg"],
-                    where=[("mpw_usr", "=", self.user["name"]), ("mpw_prg",
-                    "<>", ""), ("mpw_pwd", "=", "")])
-                # All modules enabled for the user - self.vop
-                self.vop = sql.getRec(tables="ctlpwm", cols=["mpw_sys",
-                    "mpw_prg", "mpw_coy", "mpw_pwd"], where=[("mpw_usr",
-                    "=", self.user["name"]), ("mpw_prg", "<>", ""),
-                    ("mpw_pwd", "<>", "")])
-                if self.vop:
-                    for sss, mod, coy, pwd in self.vop:
-                        if sss in nos:
-                            # System in nos, remove system from nos
-                            nos.remove(sss)
-                            for prg in self.mod:
-                                # Add all modules in sss to nop
-                                if prg[2][:2] == sss:
-                                    nop.append([prg[2][:2], prg[2][2:]])
-                    for sss, mod, coy, pwd in self.vop:
-                        # Remove all enabled modules from nop
-                        if [sss, mod] in nop:
-                            nop.remove([sss, mod])
-                self.usrmen = []
-                self.usrmod = []
-                for men in self.men:
-                    add = True
-                    for sss in nos:
-                        if men[1] == "mm_%s" % sss:
-                            add = False
-                    if add:
-                        self.usrmen.append(men)
-                mods = copyList(self.mod)
-                for mod in mods:
-                    add = True
-                    for sss in nos:
-                        if mod[2][:2] == sss:
-                            add = False
-                    for sss, prg in nop:
-                        if mod[2] == "%s%s" % (sss, prg):
-                            add = False
-                    if add:
-                        self.usrmod.append(mod)
-        if dbopend:
-            self.db.closeDbase()
-
-    def userCheckPwd(self, pwd):
-        try:
-            crypt = b64Convert("decode", self.user["pwd"])
-        except:
-            crypt = self.user["pwd"]
-        if pwd == self.mf.override:
-            return
-        elif pwd in (self.user["pwd"], crypt):
-            pwlife = self.getCtlSys(["sys_pwlife"])
-            if not pwlife or not self.user["last"]:
-                return
-            t = time.localtime()
-            dte = (t[0] * 10000) + (t[1] * 100) + t[2]
-            chk = projectDate(self.user["last"], pwlife)
-            dif = dateDiff(dte, chk, ptype="days")
-            if not dif:
-                chg = askQuestion(self.mf.window, "Password Expired",
-                    "Your Password Has Expired.\n\nDo You Want to Renew It?")
-                tx = "Expired Password"
-            elif dif < 8:
-                chg = askQuestion(self.mf.window, "Password Expiring",
-                    "Your Password Expires in %s Day(s)!!!\n\nDo You Want "\
-                    "to Renew It Now?" % dif)
-                tx = None
-            else:
-                chg = "no"
-                tx = None
-            if chg == "yes":
-                self.chgPwd()
-                if self.new:
-                    return self.userCheckPwd(self.new)
-                else:
-                    return self.userCheckPwd(self.user["pwd"])
-            else:
-                return tx
-        else:
-            return "Invalid Password"
-
-    def userLogout(self):
-        self.user = {}
-
-    def execCommand(self, typ, prg, tit="", rtn=None, menu=True, password=True):
-        if menu:
-            self.tarmen.closeMenu()
-        if prg not in ("sysUpd", "sysEnd"):
-            if prg == "tarUpd":
-                vtype = "upd"
-            else:
-                vtype = "chk"
-            if self.doVersionCheck(vtype):
-                if menu:
-                    self.tarmen.drawMenu()
-                return
-        try:
-            rtn = int(rtn)
-        except:
-            rtn = None
-        if not self.db.dbopen:
-            self.db.openDbase()
-            dbopend = True
-        else:
-            dbopend = False
-        if password and self.getCtlSys(["sys_pwmust"]) == "Y" and not \
-                self.user["pwd"] and prg not in ("chgPwd", "chgUsr", "sysEnd"):
-            showError(self.mf.window, "Missing Password",
-                """Passwords are Enforced.
-
-Please Create a Password by going to:
-
-System --> Change Password""")
-        elif typ[0] == "F":
-            if self.xdisplay:
-                self.mf.head.configure(text="%s (%s)" % (tit, prg))
-                self.mf.updateStatus("")
-            try:
-                getattr(self, prg)()
-            except:
-                if self.xdisplay:
-                    showException(self.mf.body, self.rcdic["wrkdir"],
-                        "Function %s Error" % prg, dbm=self.db)
-                else:
-                    showException(None, self.rcdic["wrkdir"],
-                        "Function %s Error" % prg, dbm=self.db)
-                if dbopend:
-                    self.db.closeDbase()
-                sys.exit()
-        elif typ[0] == "P":
-            self.mf.updateStatus("")
-            mcoy = None
-            error = False
-            if self.vop:
-                sss = prg[:2]
-                mmm = prg[2:]
-                if rtn:
-                    mmm = mmm[:3] + str(rtn)
-                for vvv in self.vop:
-                    if vvv[0] == sss and vvv[1] == mmm:
-                        mcoy, self.mpwd = vvv[2:]
-                        error = self.pwdCheck()
-            if not error:
-                popt = {"mf": self.mf}
-                text = tit
-                if typ[1] == "Y":
-                    if typ[2] in ("L", "Y"):
-                        if self.program and self.conum:
-                            error = self.conoCheck(self.conum, prg=prg)
-                            if not error and typ[2] == "L":
-                                self.getLastPeriod()
-                        else:
-                            self.getCompany(prg=prg, period=typ[2])
-                        if not self.conum:
-                            error = True
-                        else:
-                            if prg in ("gl3030", "gl3040", "gl3050", "gl3080",
-                                    "gl4010", "gl4020", "gl6030", "gl6040"):
-                                check = True
-                            else:
-                                check = False
-                            per = getPeriods(self.mf, self.conum, self.finper,
-                                check=check)
-                            if per == (None, None, None):
-                                error = True
-                            elif rtn and per[2] == "Y":
-                                showError(self.mf.body, "Period Error",
-                                    "This Period Has Already Been Finalised")
-                                error = True
-                            else:
-                                popt["period"] = (self.finper, (per[0].work,
-                                    per[0].disp), (per[1].work, per[1].disp))
-                    else:
-                        if self.program and self.conum:
-                            error = self.conoCheck(self.conum, prg=prg)
-                        else:
-                            self.getCompany(prg=prg, period=False)
-                        if not self.conum:
-                            error = True
-                    if mcoy and self.conum != mcoy:
-                        showError(self.mf.body, "Company Error",
-                            "This Company, Module Combination "\
-                            "is Not Allowed for This User")
-                        error = True
-                    if not error:
-                        popt["conum"] = self.conum
-                        popt["conam"] = self.conam
-                        text = "%-s for %s (%s)" % (text, self.conam, prg)
-                else:
-                    text = "%-s for All Companies (%s)" % (text, prg)
-            if not error:
-                if typ[3] == "Y":
-                    popt["capnm"] = self.user["name"]
-                if prg == "ml1010":
-                    popt["level"] = self.user["lvl"]
-                if rtn:
-                    popt["rtn"] = int(rtn)
-                if self.xdisplay:
-                    self.mf.head.configure(text=text)
-                    self.mf.updateStatus("")
-                if self.debug:
-                    self.tracer.runfunc(self.doRunModule, prg, **popt)
-                else:
-                    self.doRunModule(prg, **popt)
-        if dbopend:
-            try:
-                # Rollback any uncommitted transactions
-                self.db.rollbackDbase()
-            except:
-                pass
-            # Close the database
-            self.db.closeDbase()
-        if menu:
-            # Display the menu
-            if prg == "ms1010":
-                self.userReadCheck(user=self.user["name"])
-                self.tarmen.lvl = self.user["lvl"]
-                self.tarmen.men = self.usrmen
-                self.tarmen.mod = self.usrmod
-                self.tarmen.setVariables()
-            if not self.doVersionCheck():
-                self.checkNotes()
-            self.tarmen.drawMenu()
-
-    def pwdCheck(self):
-        tit = ("Password Validation",)
-        fld = ((("T",0,0,0),"IHA",30,"Password","Password","","N",
-                self.doPGet,None,None,None,None),)
-        but = (("Cancel", None, self.doPCancel, 1, None, None),)
-        self.df = TartanDialog(self.mf, tops=True, title=tit, eflds=fld,
-            butt=but, tend=((self.doPEnd, "n"),), txit=(self.doPCancel,))
-        self.mf.startLoop()
-        return self.pwderr
-
-    def doPGet(self, frt, pag, r, c, p, i, w):
-        if w != b64Convert("decode", self.mpwd):
-            return "Invalid Password"
-        self.pwderr = False
-
-    def doPCancel(self, widget=None):
-        self.pwderr = True
-        self.doPEnd()
-
-    def doPEnd(self):
-        self.df.closeProcess()
-        self.mf.closeLoop()
-
-    def conoCheck(self, coy, prg=None, ctl=False):
-        if self.acoy and not self.acoy.count(coy):
-            self.conum = None
-            return "Unavailable Company Number"
-        if self.dcoy and self.dcoy.count(coy):
-            self.conum = None
-            return "Unavailable Company Number"
-        gcl = GetCtl(self.mf)
-        chk = gcl.getCtl("ctlmst", coy, error=False)
-        if not chk:
-            self.conum = None
-            return "Invalid Company"
-        if ctl:
-            return
-        self.conum = coy
-        self.conum = chk["ctm_cono"]
-        self.conam = chk["ctm_name"]
-        self.email = chk["ctm_email"]
-        self.modul = chk["ctm_modules"]
-        if not prg:
-            return
-        # Check Module
-        mod = prg[:2].upper()
-        if mod in ("BM", "CA", "MS", "RP", "TD"):
-            return
-        for x in xrange(0, len(self.modul), 2):
-            if self.modul[x:x + 2] == mod:
-                return
-        return "System (%s) Not Enabled for Company %s" % (mod, self.conum)
-
-    def getCompany(self, prg=None, period=None):
-        self.prg = prg
-        self.pertyp = period
-        sql = Sql(self.db, "ctlmst", prog="msc000")
-        if self.acoy:
-            whr = [("ctm_cono", "in", tuple(self.acoy))]
-        else:
-            whr = None
-        coy = sql.getRec(tables="ctlmst", where=whr, order="ctm_cono")
-        if not coy:
-            showError(self.mf.window, "Error", "No Valid Company Records.")
-            return
-        self.coys = len(coy)
-        if self.coys == 1:
-            # Single Company
-            self.conum = coy[0][sql.ctlmst_col.index("ctm_cono")]
-            self.conam = coy[0][sql.ctlmst_col.index("ctm_name")].rstrip()
-            self.email = coy[0][sql.ctlmst_col.index("ctm_email")].rstrip()
-            self.modul = coy[0][sql.ctlmst_col.index("ctm_modules")].rstrip()
-            if not self.pertyp:
-                self.finper = None
-                return
-        if not self.conum:
-            if self.acoy:
-                self.conum = self.acoy[0]
-            else:
-                self.conum = 1
-        csel = {
-            "stype": "R",
-            "tables": ("ctlmst",),
-            "cols": (
-                ("ctm_cono", "", 0, "Com"),
-                ("ctm_name", "", 0, "Name", "Y")),
-            "order": "ctm_cono"}
-        if self.acoy:
-            csel["where"] = [("ctm_cono", "in", tuple(self.acoy))]
-        if self.coys == 1:
-            # Single Company
-            tit = (self.conam,)
-            fld = []
-        else:
-            tit = ("Company Details",)
-            fld = [
-                [("T",0,0,0),"IUI",3,"Company Number","",
-                    self.conum,"N",self.coNum,csel,None,("notzero",)],
-                [("T",0,1,0),"ONA",30,"Company Name","",
-                    "","N",None,None,None,None]]
-        if self.pertyp == "Y":
-            self.psel = {
-                "stype": "R",
-                "tables": ("ctlynd",),
-                "cols": (
-                    ("cye_period", "", 0, "Prd"),
-                    ("cye_start", "", 0, "Start"),
-                    ("cye_end", "", 0, "End"),
-                    ("cye_final", "", 0, "F")),
-                "where": []}
-            fld.append(
-                [["T",0,2,0],"IUI",3,"Financial Period","",
-                    0,"N",self.finPeriod,self.psel,None,None])
-            if self.coys == 1:
-                self.psel["where"] = [("cye_cono", "=", self.conum)]
-                fld[0][0][2] = 0
-                self.getLastPeriod()
-                fld[0][5] = self.finper
-        elif self.pertyp == "L":
-            self.getLastPeriod()
-            if self.coys == 1:
-                return
-        else:
-            self.finper = None
-            if self.coys == 1:
-                return
-        but = (("Cancel", None, self.coExit, 1, ("T",0,1), ("T",0,0)),)
-        self.cp = TartanDialog(self.mf, title=tit, tops=True, eflds=fld,
-            butt=but, tend=((self.coEnd, "y"),), txit=(self.coExit,))
-        if self.conum:
-            try:
-                self.cp.loadEntry("T", 0, 0, data=self.conum)
-                self.cp.loadEntry("T", 0, 1, data=self.conam)
-                if self.pertyp == "Y" and self.finper is not None:
-                    self.cp.topf[0][2][5] = self.finper
-                    self.cp.loadEntry("T", 0, 2, data=self.finper)
-            except:
-                pass
-        self.cp.focusField("T", 0, 1)
-        self.mf.startLoop()
-
-    def coNum(self, frt, pag, r, c, p, i, w):
-        err = self.conoCheck(w, prg=self.prg)
-        if err:
-            return err
-        self.cp.loadEntry("T", pag, p+1, data=self.conam)
-        if not self.pertyp or self.pertyp == "L":
-            return "ok"
-        self.psel["where"] = [("cye_cono", "=", self.conum)]
-        if self.finper is None:
-            self.getLastPeriod()
-        self.cp.topf[0][2][5] = self.finper
-
-    def getLastPeriod(self):
-        sql = Sql(self.db, "ctlynd", prog="msc000")
-        p = sql.getRec(tables="ctlynd", cols=["max(cye_period)"],
-            where=[("cye_cono", "=", self.conum)])
-        self.finper = int(p[0][0])
-
-    def finPeriod(self, frt, pag, r, c, p, i, w):
-        sql = Sql(self.db, "ctlynd", prog="msc000")
-        r = sql.getRec(tables="ctlynd", cols=["cye_period"],
-            where=[("cye_cono", "=", self.conum), ("cye_period", "=", w)],
-            limit=1)
-        if not r:
-            return "Invalid Financial Period"
-        self.finper = w
-
-    def coExit(self, widget=None):
-        self.conum = None
-        self.coEnd()
-
-    def coEnd(self):
-        self.cp.closeProcess()
-        self.mf.closeLoop()
-
-    def doRunModule(self, *prg, **popt):
-        if self.loader and prg[0] in sys.modules:
-            del(sys.modules[prg[0]])
-            gc.collect()
-        try:
-            if "rtn" in popt:
-                rtn = popt["rtn"]
-            else:
-                rtn = 0
-            sql = Sql(self.mf.dbm, ["ffield", "ctllog"], prog="msc000")
-            if not sql.error:
-                chk = sql.getRec(tables="ffield",
-                    where=[("ff_tabl", "=", "ctllog")])
-            if not sql.error and len(chk) == 7:
-                if not self.user:
-                    name = "admin"
-                else:
-                    name = self.user["name"]
-                logd = [getpass.getuser(), name, prg[0], rtn]
-                if "conum" in popt:
-                    logd.append(popt["conum"])
-                else:
-                    logd.append(0)
-                if "period" in popt:
-                    logd.append(popt["period"][0])
-                else:
-                    logd.append(0)
-                logd.append(long(
-                    "%04i%02i%02i%02i%02i%02i" % time.localtime()[:-3]))
-                sql.insRec("ctllog", data=logd)
-                self.mf.dbm.commitDbase()
-            runModule(prg[0], **popt)
-        except:
-            if self.xdisplay:
-                for wgt in self.mf.window.winfo_children():
-                    if wgt not in (self.mf.head, self.mf.body, self.mf.status):
-                        wgt.destroy()
-                showException(self.mf.body, self.rcdic["wrkdir"],
-                    "Mod: %s or Arg: %s Error" % (prg, popt), dbm=self.db)
-            else:
-                showException(None, self.rcdic["wrkdir"],
-                    "Mod: %s or Arg: %s Error" % (prg, popt), dbm=self.db)
-
-    def checkNotes(self):
-        self.db.openDbase()
-        t = time.localtime()
-        self.cdate = ((t[0] * 10000) + (t[1] * 100) + t[2])
-        self.sql = Sql(self.db, ["ctlnot", "ctlpwu"], prog="msc000")
-        chk = self.sql.getRec(tables="ctlnot", where=[("(", "not_user", "=",
-            self.user["name"], "or", "not_auser", "=", self.user["name"],
-            ")"), ("not_adate", ">", 0), ("not_adate", "<=", self.cdate),
-            ("not_aflag", "<>", "C")])
-        if chk:
-            ok = askQuestion(self.mf.window, "Notes", "There are Notes "\
-                "Flagged for Action Still Outstanding, do You want to "\
-                "View them?")
-            if ok == "yes":
-                self.showNotes(chk)
-        self.db.closeDbase()
-
-    def showNotes(self, notes):
-        data = []
-        for note in notes:
-            nte = note[:4]
-            nte.append(note[6])
-            nte.append(note[7])
-            nte.append(note[8])
-            nte.append(note[5])
-            nte.append(note[9])
-            data.append(nte)
-        tits = "Today's Notes"
-        cols = [
-            ("not_cono", "Coy", 3, "UI", "N"),
-            ("not_sys", "Sys", 3, "UA", "N"),
-            ("not_key", "Key", 30, "NA", "N"),
-            ("not_date", "Entry-Date", 10, "D1", "N"),
-            ("not_aflag", "F", 1, "UA", "N"),
-            ("not_adate", "Action-Dte", 10, "d1", "N"),
-            ("not_auser", "Action-User", 20, "NA", "N"),
-            ("not_desc", "Description", 50, "TX", "N"),
-            ("not_seq", "Sequence", 10, "US", "N")]
-        sr = SelectChoice(self.mf.body, tits, cols, data)
-        if sr.selection:
-            self.selectNote(sr.selection)
-            self.checkNotes()
-
-    def selectNote(self, note):
-        self.chgflag = note[5]
-        self.chgdate = note[6]
-        self.chguser = note[7]
-        self.nseq = note[-1:][0]
-        tit = ("Notes Editing",)
-        r1s = (("Normal","N"),("Urgent","U"),("Completed","C"))
-        fld = (
-            (("T",0,0,0),"O@not_date",0,""),
-            (("T",0,1,0),"O@not_user",0,""),
-            (("T",0,2,0),"OTV",(50,10),"Details"),
-            (("T",0,3,0),("IRB",r1s),0,"Action Flag (C/N/U)","Action Flag",
-                "N","N",self.doChgFlag,None,None,None),
-            (("T",0,4,0),"I@not_adate",0,"","",
-                "","N",self.doChgDate,None,None,("efld",)),
-            (("T",0,5,0),"I@not_auser",0,"","",
-                "","N",self.doChgUser,None,None,("efld",)))
-        but = (
-            ("Accept",None,self.doNEnd,1,None,None),
-            ("Cancel",None,self.doNExit,1,None, None))
-        tnd = ((self.doNEnd, "n"), )
-        txt = (self.doNExit, )
-        self.nf = TartanDialog(self.mf, title=tit, eflds=fld, butt=but,
-            tend=tnd, txit=txt, focus=False)
-        self.nf.loadEntry("T", 0, 0, data=note[4])
-        self.nf.loadEntry("T", 0, 1, data=self.user["name"])
-        mess = note[8]
-        #if len(note) > 7:
-        #    for x in xrange(6, len(note) - 1):
-        #        mess = "%s\n%s" % (mess, note[x])
-        self.nf.loadEntry("T", 0, 2, data=mess)
-        self.nf.loadEntry("T", 0, 3, data=note[5])
-        self.nf.loadEntry("T", 0, 4, data=note[6])
-        self.nf.loadEntry("T", 0, 5, data=note[7])
-        if self.chgflag == "C":
-            self.nf.setWidget(self.nf.B0, "normal")
-            self.nf.setWidget(self.nf.B1, "normal")
-        else:
-            self.nf.focusField("T", 0, 4)
-        self.mf.startLoop()
-
-    def doChgFlag(self, frt, pag, r, c, p, i, w):
-        self.chgflag = w
-        if self.chgflag == "C":
-            return "nd"
-
-    def doChgDate(self, frt, pag, r, c, p, i, w):
-        self.chgdate = w
-
-    def doChgUser(self, frt, pag, r, c, p, i, w):
-        usr = self.sql.getRec(tables="ctlpwu", where=[("usr_name", "=", w)],
-            limit=1)
-        if not usr:
-            return "Invalid User Name"
-        self.chguser = w
-        return "nd"
-
-    def doNEnd(self, widget=None):
-        self.sql.updRec("ctlnot", cols=["not_aflag", "not_adate", "not_auser"],
-            data=[self.chgflag, self.chgdate, self.chguser], where=[("not_seq",
-            "=", self.nseq)])
-        self.db.commitDbase()
-        self.doNExit()
-
-    def doNExit(self, widget=None):
-        self.nf.closeProcess()
-        self.mf.closeLoop()
-
-    def chgUsr(self):
-        self.userLogout()
-        if not self.db.dbopen:
-            self.db.openDbase()
-            dbopend = True
-        else:
-            dbopend = False
-        self.userLogin()
-        if dbopend:
-            self.db.closeDbase()
-        if not self.user:
-            self.doExit()
-        self.tarmen.usr = self.user["name"]
-        self.tarmen.lvl = self.user["lvl"]
-        self.tarmen.men = self.usrmen
-        self.tarmen.mod = self.usrmod
-        self.tarmen.setVariables()
-
-    def chgPwd(self):
-        tit = ("Change Password",)
-        fld = (
-            (("T",0,0,0),"IHA",30,"Old Password","",
-                "","N",self.doOldPwd,None,None,None,None),
-            (("T",0,1,0),"IHA",30,"New Password","",
-                "","N",self.doNewP1,None,None,None,None),
-            (("T",0,2,0),"IHA",30,"New Password","New Password Again",
-                "","N",self.doNewP2,None,None,None,None))
-        but = (("Cancel", None, self.doPwdExit, 1, None, None),)
-        self.np = TartanDialog(self.mf, title=tit, eflds=fld, butt=but,
-            tend=((self.doPwdEnd, "n"),), txit=(self.doPwdExit,))
-        if not self.pwd:
-            self.np.skip[self.np.pag].append(1)
-            self.np.focusField(self.np.frt, self.np.pag, col=2)
-        self.mf.startLoop()
-
-    def doOldPwd(self, frt, pag, r, c, p, i, w):
-        if w == self.pwd or w == b64Convert("decode", self.pwd):
-            pass
-        else:
-            return "Invalid Old Password"
-
-    def doNewP1(self, frt, pag, r, c, p, i, w):
-        if w == self.pwd or w == b64Convert("decode", self.pwd):
-            return "Same Password"
-        pwmust, pwsize = self.getCtlSys(["sys_pwmust", "sys_pwsize"])
-        if not w and pwmust == "Y":
-            return "You Must Have a Password"
-        if pwsize and len(w) < pwsize:
-            return "Minimum of %s Characters Required" % pwsize
-        self.new = w
-
-    def doNewP2(self, frt, pag, r, c, p, i, w):
-        if w != self.new:
-            return "Invalid New Password"
-        self.pwd = b64Convert("encode", w)
-
-    def doPwdEnd(self, widget=None):
-        pwmust, pwsize = self.getCtlSys(["sys_pwmust", "sys_pwsize"])
-        if not self.pwd and pwmust == "Y":
-            if not self.pwd:
-                self.np.skip[self.np.pag].append(1)
-                self.np.focusField(self.np.frt, self.np.pag, col=2)
-            else:
-                self.np.focusField(self.np.frt, self.np.pag, col=1)
-            self.mf.updateStatus("You Must Have a Password",
-                bg="white", fg="red")
-            return
-        t = time.localtime()
-        dte = (t[0] * 10000) + (t[1] * 100) + t[2]
-        sql = Sql(self.db, "ctlpwu", prog="msc000")
-        sql.updRec("ctlpwu", cols=["usr_pwd", "usr_last"], data=[self.pwd,
-            dte], where=[("usr_name", "=", self.user["name"])])
-        self.db.commitDbase()
-        self.user["pwd"] = self.pwd
-        self.user["last"] = dte
-        self.np.closeProcess()
-        self.mf.closeLoop()
-
-    def doPwdExit(self, widget=None):
-        self.new = None
-        self.np.closeProcess()
-        self.mf.closeLoop()
-
-    def tarUsr(self):
-        sss = []
-        prg = {}
-        keys = list(self.sss.keys())
-        keys.sort()
-        for s in keys:
-            sm = []
-            sss.append((self.sss[s], s))
-            for mod in self.mod:
-                if mod[0][0] == "P" and mod[2][:2] == s:
-                    if len(mod) == 6:
-                        mod[2] = "%s%s" % (mod[2][:5], mod[5])
-                    sm.append((mod[3], mod[2][2:], mod[4]))
-            prg[s] = sm
-        TartanUser(self.mf, sss, prg)
-
-    def sysUpd(self):
-        tit = ("System Upgrade",)
-        typ = (("Internet", "I"), ("Local", "L"))
-        fld = (
-            (("T",0,0,0),("IRB",typ),0,"Upgrade Type","",
-                "I","N",self.doSysLoc,None,None,None,None),
-            (("T",0,1,0),"ONA",9,"Current Version","",
-                "","N",None,None,None,None,None),
-            (("T",0,2,0),"ONA",9,"Upgrade Version","",
-                "","N",None,None,None,None,None))
-        but = (
-            ("Upgrade", None, self.doSysUpgrade, 0, ("T",0,0), ("T",0,1)),
-            ("Cancel", None, self.doSysUpdXit, 1, None, None))
-        self.su = TartanDialog(self.mf, title=tit, eflds=fld, butt=but,
-            tend=None, txit=(self.doSysUpdXit,))
-        self.mf.startLoop()
-
-    def doSysLoc(self, frt, pag, r, c, p, i, w):
-        self.updtyp = w
-        sql = Sql(self.db, "ctlmst", prog="msc000")
-        chk = sql.getRec(tables="ctlmst", cols=["ctm_modules"],
-            group="ctm_modules")
-        self.upgsys = ""
-        for mod in chk:
-            if mod == ["BC"] and self.upgsys is not "Tartan":
-                self.upgsys = "Bwlclb"
-            elif mod == ["SC"] and self.upgsys is not "Tartan":
-                self.upgsys = "Seccmp"
-            else:
-                self.upgsys = "Tartan"
-        if self.updtyp == "I":
-            err = self.doSysChkUpgrade()
-            if err:
-                showError(self.mf.window, err[0], err[1])
-                return "Upgrade Error"
-            else:
-                self.su.loadEntry("T", 0, 1, data=self.current[1])
-                self.su.loadEntry("T", 0, 2, data=self.nvtxt)
-                return
-        self.su.setWidget(self.su.mstFrame, "hide")
-        if sys.platform == "win32":
-            ftype = [("Upgrade Files", "%s_5.*.exe" % self.upgsys)]
-        else:
-            ftype = [("Upgrade Files", "%s_5.*.tgz" % self.upgsys)]
-        dialog = FileDialog(**{
-            "parent": self.mf.body,
-            "title": "Select Upgrade File",
-            "initd": self.rcdic["upgdir"],
-            "ftype": ftype})
-        self.updfle = dialog.askopenfilename()
-        self.su.setWidget(self.su.mstFrame, "show")
-        if not self.updfle:
-            return "Invalid File"
-        self.su.loadEntry("T", 0, 1, data=self.current[1])
-        nv = os.path.basename(self.updfle).split("_")[1].split(".")
-        self.newver = (int(nv[0]), int(nv[1]), int(nv[2]))
-        self.nvtxt = "%s.%s.%s" % self.newver
-        self.su.loadEntry("T", 0, 2, data=self.nvtxt)
-        self.su.setWidget(self.su.B0, "focus")
-        if int(nv[0]) > self.current[0][0]:
-            return
-        if int(nv[0]) == self.current[0][0]:
-            if int(nv[1]) > self.current[0][1]:
-                return
-            if int(nv[1]) == self.current[0][1]:
-                if int(nv[2]) > self.current[0][2]:
-                    return
-        self.updfle = None
-        showError(self.mf.window, "Invalid Version",
-            "Not Later Than Current Version.")
-        return "Version Error"
-
-    def doSysChkUpgrade(self):
-        try:
-            err = self.conoCheck(1)
-            if err or not self.email:
-                self.email = "info@tartan.co.za"
-            flenam = cStringIO.StringIO()
-            err = ftpDownload("tartan.co.za", "current",
-                word=self.email, dest=flenam)
-            if err:
-                raise Exception
-            v = flenam.getvalue()
-            flenam.close()
-            # Read and create Tartan file
-            v = v.rstrip().split(".")
-            self.newver = (int(v[0]), int(v[1]), int(v[2]))
-            self.nvtxt = "%s.%s.%s" % self.newver
-            if self.newver[0] > self.current[0][0]:
-                return
-            elif self.newver[0] == self.current[0][0]:
-                if self.newver[1] > self.current[0][1]:
-                    return
-                elif self.newver[1] == self.current[0][1]:
-                    if self.newver[2] > self.current[0][2]:
-                        return
-            return ("Upgrade Error", "No Upgrade Available")
-        except:
-            return ("Connection Error", """Please Ensure that You Are Connected to the Internet.
-
-
-"If Not, Please Connect and then Try Again!""")
-
-    def doSysUpgrade(self, widget=None):
-        self.su.closeProcess()
-        self.mf.updateStatus("")
-        self.mf.closeLoop()
-        ScrollText(scrn=self.mf.body, mess="""
-                        Performing the Upgrade
-
-  After the update has completed you must perform the following:
-
-  1) If you are running Linux the downloaded file will be in your
-     '~/upg' directory. The file's name will be something like
-     '%s_5.x.x.tgz'.
-
-                                 or
-
-  1) If you are running Windows the downloaded file will be in your
-     'C:\\Tartan\\upg' directory. The file's name will be something like
-     '%s_5.x.x.exe'.
-  2) Restart Tartan.
-  3) Execute the 'Update File Formats' routine on the 'System' menu.
-  4) If Tartan is installed on other workstations, copy the downloaded
-     file to those other workstations and either, in the case of linux,
-     extract the file into the ~/prg directory or, in the case of
-     Windows, execute the file.""" % (self.upgsys, self.upgsys))
-        try:
-            if self.updtyp == "I":
-                if sys.platform == "win32":
-                    nam = self.upgsys + "_%s.%s.%s_upd" % self.newver + ".exe"
-                    if not ftpDownload("tartan.co.za", nam, check=True):
-                        nam = self.upgsys + "_%s.%s.%s" % self.newver + ".exe"
-                else:
-                    nam = self.upgsys + "_%s.%s.%s" % self.newver + ".tgz"
-                fle = os.path.join(self.mf.rcdic["upgdir"], nam)
-                err = ftpDownload("tartan.co.za", nam, word=self.email,
-                    dest=fle, close=True)
-                if err:
-                    raise Exception
-            else:
-                fle = self.updfle
-            if sys.platform == "win32":
-                os.spawnv(os.P_NOWAIT, fle, (fle,))
-            else:
-                os.spawnv(os.P_NOWAIT, "/bin/tar",
-                    ("tar", "-xzf", fle, "-C", self.mf.rcdic["prgdir"]))
-            os._exit(0)
-        except:
-            showError(self.mf.window, "Get Error",
-                "Upgrade File Could Not be Retrieved.\n\n"\
-                "Your System Has Not Been Upgraded.\n\n"\
-                "Please Contact Your IT Manager.")
-            self.doSysUpdXit()
-
-    def doSysUpdXit(self, widget=None):
-        self.su.closeProcess()
-        self.mf.closeLoop()
-
-    def tarUpd(self, dbcreate=False):
-        if not dbcreate:
-            # Check on status of Database
-            if self.mf.window:
-                ok = askQuestion(self.mf.window, "Backup",
-                    "Have You Backed Up the Database?", default="no")
-            else:
-                ok = raw_input("Have You Backed Up the Database? (yes/no) ")
-            if ok != "yes":
-                return
-        else:
-            if self.xdisplay:
-                self.mf.head.configure(text="Update File Formats (tarUpd)")
-                self.mf.updateStatus("")
-        dbopen = self.db.dbopen
-        if not dbopen:
-            self.db.openDbase()
-        popt = {
-            "mf": self.mf,
-            "bar": True,
-            "cln": True,
-            "pth": os.path.join(self.mf.rcdic["prgdir"], "csv"),
-            "pwd": self.mf.rcdic["dbpwd"],
-            "rcf": self.rcfile,
-            "sss": self.sysmod,
-            "upd": False,
-            "usr": self.mf.rcdic["dbuser"],
-            "ver": self.current[1]}
-        self.doRunModule("tb1020", **popt)
-        if not dbopen:
-            self.db.closeDbase()
-
-    def doVersionCheck(self, vtype="chk"):
-        error = None
-        self.oldver = (0, 0, 0)
-        self.ovtxt = "%s.%s.%s" % self.oldver
-        upddate = CCD(0, "d1", 10)
-        if self.xdisplay:
-            scrn = self.mf.window
-        else:
-            scrn = "text"
-        if not self.db.dbopen:
-            self.db.openDbase()
-            dbopend = True
-        else:
-            dbopend = False
-        sql = Sql(self.db, "verupd", prog="msc000")
-        if sql.error:
-            if vtype == "chk":
-                return "missing"
-            else:
-                return
-        ver = sql.getRec(tables="verupd", limit=1)
-        if ver:
-            v = ver[0].split(".")
-            self.oldver = (int(v[0]), int(v[1]), int(v[2]))
-            self.ovtxt = "%s.%s.%s" % self.oldver
-            upd = sql.getRec(tables="verupd", cols=["ver_upddate"],
-                where=[("ver_version", "=", ver[0])], limit=1)
-            if upd:
-                upddate = CCD(upd[0], "d1", 10)
-        if dbopend:
-            self.db.closeDbase()
-        if vtype == "chk" and not self.nocheck:
-            if self.oldver == (0, 0, 0):
-                error = "not"
-            elif self.oldver < (4, 1, 10):
-                error = "tooold"
-            elif self.oldver < self.current[0]:
-                error = "newer"
-            elif self.oldver > self.current[0]:
-                error = "older"
-        elif vtype == "upd":
-            if self.oldver == (0, 0, 0):
-                pass
-            elif self.oldver == self.current[0]:
-                error = "updated"
-            elif self.oldver > self.current[0]:
-                error = "older"
-        if error == "tooold":
-            showError(scrn, "Version Error",
-                """The Version of the Data, %s.%s.%s, is too Old.
-
-Please follow the upgrade instructions at http//www.tartan.co.za
-
-or
-
-Email info@tartan.co.za, with your current version number, for assistance.""" % self.oldver)
-            self.doExit()
-        elif error == "not":
-            showError(scrn, "Version Error", """'Update File Formats'
-Not Yet Done for this Version of TARTAN.""")
-        elif error == "newer":
-            if self.lvl < 8:
-                showError(scrn, "Version Error", """Your Version of TARTAN (%s) Is Newer than the File Formats!
-
-Please ask your Administrator to Update the File Formats.""" % self.current[1])
-                self.doExit()
-            else:
-                ok = askQuestion(scrn, "Version Error", """Your Version of TARTAN (%s) Is Newer than the File Formats!
-
-Do You Want to Update Your File Formats Now?""" % self.current[1],
-                default="yes")
-                if ok == "yes":
-                    self.tarUpd(True)
-                else:
-                    self.doExit()
-        elif error == "older":
-            showError(scrn, "Version Error", """Your Version of TARTAN (%s) Is Older than the File Formats!
-
-Please Upgrade Your Version of TARTAN.""" % self.current[1])
-        elif error == "updated":
-            ok = askQuestion(scrn, "Version Error", """Your File Formats for TARTAN (%s) were Already Updated on %s.
-
-Do You Want to Run the Update Again?""" % (self.current[1], upddate.disp))
-            if ok == "yes":
-                error = None
-        return error
-
-    def tarBck(self):
-        self.db.openDbase()
-        cf = PwdConfirm(self.mf, conum=0, system="MST", code="TarBck",
-            passwd=self.bpwd)
-        if cf.flag == "ok":
-            try:
-                sql = Sql(self.db, ["ctlmst", "ctlsys"], prog="msc000")
-                if sql.error:
-                    raise Exception
-                csys = sql.getRec(tables="ctlsys", cols=["sys_budays",
-                    "sys_msvr", "sys_mprt", "sys_msec", "sys_maut",
-                    "sys_mnam", "sys_mpwd"], limit=1)
-                if not csys:
-                    raise Exception
-            except:
-                csys = None
-            if self.zerobar:
-                TarBckRes(self.mf, mode="B", csys=csys, bar=False)
-            else:
-                TarBckRes(self.mf, mode="B", csys=csys)
-
-    def tarRes(self):
-        cf = PwdConfirm(self.mf, conum=0, system="MST", code="TarRes",
-            passwd=self.bpwd)
-        if cf.flag == "ok":
-            TarBckRes(self.mf, mode="R", ver=self.current[1])
-
-    def tarCfg(self):
-        cfg = TartanConfig(self.mf, rcdic=self.rcdic, level=self.lvl)
-        if cfg.rcfile:
-            self.rcfile = cfg.rcfile
-        self.rcdic = self.mf.rcdic = loadRcFile(self.rcfile)
-        geo = self.rcdic["geo"].split("x")
-        self.mf.geo = [int(geo[0]), int(geo[1])]
-        self.mf.resizeChildren()
-
-    def sysEnd(self):
-        self.userLogout()
-        self.doHousekeeping()
-        self.doExit()
-
-    def doAbout(self, event=None):
-        self.mf.destroyChildren()
-        self.about = AboutTartan(self.mf, self.current[1])
-
-    def doManual(self):
-        self.doBrowser("Manual")
-
-    def doQuick(self):
-        self.doBrowser("QuickStart")
-
-    def doBrowser(self, doc):
-        pdf = os.path.join(self.rcdic["prgdir"], "doc", "%s.pdf" % doc)
-        if os.path.exists(pdf):
-            exe, cmd = parsePrg(self.rcdic["vwr"])
-            cmd.append(pdf)
-            os.spawnv(os.P_NOWAIT, exe, tuple(cmd))
-        elif internetConnect():
-            try:
-                import webbrowser
-                web = "http://tartan.co.za/cgi-bin/simple_web.py/%s" % doc
-                webbrowser.open(web)
-            except:
-                showError(self.mf.window, "Error", "Browser Not Found.")
-        else:
-            showError(self.mf.window, "Error", "No Internet Connection.")
-
-    def doHousekeeping(self):
-        fles = []
-        for tp in ("csv", "gif", "jpg", "odt", "pdf", "png", "ps", "xls"):
-            fles.extend(glob.glob(os.path.join(self.rcdic["wrkdir"],
-                "*.%s" % tp)))
-        if fles:
-            ask = askQuestion(self.mf.body, "Temporary Files",
-                "Do you wish to Keep the Temporary Report Files "\
-                "in the wrk Directory?", default="no")
-            if ask == "no":
-                for fle in fles:
-                    try:
-                        os.remove(fle)
-                    except:
-                        pass
-
-    def doExit(self, dbm=True, sysexit=True):
-        if dbm and self.db.dbopen:
-            self.db.closeDbase()
-        if self.debug:
-            sys.settrace(None)
-        if self.output:
-            # Close and display stdout -- Windows Problem
-            try:
-                sys.stdout.close()
-                sys.stdout = sys.__stdout__
-                if os.path.getsize(self.stdout) and not self.debug:
-                    text = open(self.stdout, "r")
-                    lines = text.readlines()
-                    text.close()
-                    if self.debug and len(lines) > 50:
-                        maxi = 50
-                    else:
-                        maxi = len(lines)
-                    mess = ""
-                    for x in xrange(maxi):
-                        mess = "%s%s" % (mess, lines[x - maxi])
-                    if self.debug:
-                        if self.xdisplay:
-                            ScrollText(title="Trace Output", mess=mess)
-                        else:
-                            print("Trace Output: ", mess)
-                    else:
-                        if self.xdisplay:
-                            ScrollText(title="Standard Output", mess=mess)
-                        else:
-                            print("Standard Output: ", mess)
-                # Housekeeping
-                for pid in xrange(1000):
-                    try:
-                        os.remove(os.path.join(getPrgPath(),
-                            "stdout_%s.txt" % pid))
-                    except:
-                        pass
-            except:
-                pass
-        if sysexit:
-            os._exit(1)
-
-    def doCheckSys(self):
-        sql = Sql(self.db, "ctlsys", prog=__name__)
-        if sql.error:
-            return "error"
-        rec = sql.getRec(tables="ctlsys", limit=1)
-        if not rec:
-            self.user = {"name": "admin", "pwd": "", "lvl": 9}
-            self.execCommand("PNNY", "msc110", tit="System Record Maintenance",
-                menu=False, password=False)
-            rec = sql.getRec(tables="ctlsys", limit=1)
-        if not rec:
-            return "error"
-
-    def doCheckMst(self):
-        chk = self.conoCheck(1, ctl=True)
-        if not chk:
-            return
-        if "sc" in self.sss:
-            for mod in self.mod:
-                if mod[2] in ("ms1010", "scc110"):
-                    module = mod[2]
-                    break
-        else:
-            module = "ms1010"
-        self.user = {"name": "admin", "pwd": "", "lvl": 9}
-        self.execCommand("PNNY", module, tit="Company Records Maintenance",
-            menu=False, password=False)
-        chk = self.conoCheck(1, ctl=True)
-        if chk:
-            return "error"
-
-    def getCtlSys(self, cols):
-        try:
-            sql = Sql(self.db, "ctlsys", prog="msc000")
-            if sql.error:
-                raise Exception
-            sss = sql.getRec(tables="ctlsys", cols=cols, limit=1)
-            if not sss:
-                raise Exception
-            if len(cols) == 1:
-                return sss[0]
-            else:
-                return sss
-        except:
-            sss = []
-            for col in cols:
-                sss.append(None)
-            return sss
-
-    def doSqlCmd(self):
-        if type(self.query) is list:
-            flenam = self.query
-        else:
-            name = os.path.abspath(self.query)
-            if os.path.isfile(name):
-                flenam = open(name, "r")
-            else:
-                return "Invalid Query File (%s)" % name
-        self.db.openDbase()
-        for line in flenam:
-            line = line.rstrip()
-            if not line or line[0] == "#":
-                continue
-            comm = line.split()
-            sel = False
-            qty = None
-            if comm and comm[0].lower() == "select":
-                sel = True
-                if comm[1][:3].lower() in ("avg", "max", "min", "sum"):
-                    qty = 1
-                elif comm[1].lower() == "count(*)":
-                    qty = 1
-                for num, cmd in enumerate(comm):
-                    if num < 2:
-                        continue
-                    if cmd == "limit":
-                        qty = int(comm[num + 1])
-                        break
-            try:
-                if comm[0] == "commit":
-                    self.db.commitDbase()
-                else:
-                    sq = Sql(self.db)
-                    if sel:
-                        ret = sq.sqlRec(line, limit=qty)
-                        mess = ""
-                        for r in ret:
-                            if type(r) is list:
-                                r = str(r)[1:-1]
-                            else:
-                                r = str(r)
-                            if not mess:
-                                mess = r
-                            else:
-                                mess = mess + "\n" + r
-                        if self.xdisplay and self.output:
-                            self.mf.window.deiconify()
-                            self.mf.head.configure(text="SQL Query")
-                            ScrollText(scrn=self.mf.body, mess=mess)
-                        else:
-                            print(mess)
-                    else:
-                        sq.sqlRec(line)
-            except:
-                self.db.closeDbase()
-                return "Error in SQL Statement\n\n%s" % line
-        self.db.closeDbase()
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== modified file 'mst/msc110.py'
--- mst/msc110.py	2018-06-18 06:16:26 +0000
+++ mst/msc110.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/msy010.py'
--- mst/msy010.py	2018-05-31 15:57:14 +0000
+++ mst/msy010.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'mst/msy020.py'
--- mst/msy020.py	2017-08-24 07:49:34 +0000
+++ mst/msy020.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import SplashScreen, Sql, TartanDialog

=== modified file 'mst/msy030_rne.py'
--- mst/msy030_rne.py	2018-02-17 07:36:43 +0000
+++ mst/msy030_rne.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, ProgressBar, PwdConfirm, Sql, TartanDialog

=== modified file 'rca/rc1010.py'
--- rca/rc1010.py	2017-08-24 07:49:34 +0000
+++ rca/rc1010.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc1020.py'
--- rca/rc1020.py	2017-08-24 07:49:34 +0000
+++ rca/rc1020.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc1030.py'
--- rca/rc1030.py	2017-08-24 07:49:34 +0000
+++ rca/rc1030.py	2018-08-17 09:20:05 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -54,6 +54,11 @@
                 ("rtn_name", "", 0, "Name", "Y")),
             "where": [("rtn_cono", "=", self.opts["conum"])],
             "whera": (("T", "rtn_owner", 0, 0), ("T", "rtn_code", 1, 0))}
+        typ = {
+            "stype": "C",
+            "titl": "Select the Required Type",
+            "head": ("C", "Type"),
+            "data": ((4, "Services (Owner)"), (5, "Services (Agency)"))}
         r1s = (
             ("Monthly","M"),
             ("Quarterly","3"),
@@ -67,7 +72,7 @@
             (("T",0,2,0),"INA",7,"Account Code","",
                 "","N",self.doAccount,acc,None,("notblank",)),
             (("T",0,3,0),"INA",30,"Tenant Name","",
-                "","N",self.doName,None,self.doDelete,("notblank",)),
+                "","N",None,None,self.doDelete,("notblank",)),
             (("T",0,4,0),"INA",30,"Address Line 1","",
                 "","N",self.doAddr,None,None,("efld",)),
             (("T",0,5,0),"INA",30,"Address Line 2","",
@@ -77,23 +82,31 @@
             (("T",0,7,0),"INA",4,"Postal Code","",
                 "","N",None,None,None,("efld",)),
             (("T",0,8,0),"INA",20,"Telephone Number","",
-                "","N",self.doTelno,None,None,("efld",)),
+                "","N",None,None,None,("efld",)),
             (("T",0,9,0),"ITX",50,"E-Mail Address","",
-                "","N",self.doEmail,None,None,("email",)),
+                "","N",None,None,None,("email",)),
             (("T",0,10,0),"INA",10,"VAT Number","",
                 "","N",self.doVatNum,None,None,("efld",)),
             (("T",0,11,0),("IRB",r1s),0,"Payment Frequency","",
-                "M","N",self.doPayInd,None,None,None),
+                "M","N",None,None,None,None),
             (("T",0,12,0),"ID1",10,"Start Date","",
-                "","N",self.doStart,None,None,("notzero",)),
+                "","N",None,None,None,("notzero",)),
             (("T",0,13,0),"IUI",3,"Number of Periods","Periods",
-                "","N",self.doPeriod,None,None,("notzero",)),
+                "","N",None,None,None,("notzero",)),
             (("T",0,14,0),"IUD",12.2,"Rental Amount","",
-                "","N",self.doAmount,None,None,("notzero",)),
+                "","N",None,None,None,("notzero",)),
             (("T",0,15,0),"IUD",12.2,"Deposit Amount","",
-                "","N",self.doAmount,None,None,("efld",)),
-            (("T",0,16,0),"IUA",1,"Status","",
-                "","N",self.doStatus,None,None,("in",("C","X"))))
+                "","N",None,None,None,("efld",)),
+            (("T",0,16,0),"IUD",12.2,"Basic Water Amount","",
+                "","N",None,None,None,("efld",)),
+            (("T",0,16,0),"IUI",1,"Type","",
+                "","N",None,typ,None,("efld",)),
+            (("T",0,17,0),"IUD",12.2,"Basic Exlectricity Amount","",
+                "","N",None,None,None,("efld",)),
+            (("T",0,17,0),"IUI",1,"Type","",
+                "","N",self.doEType,typ,None,("efld",)),
+            (("T",0,18,0),"IUA",1,"Status","",
+                "","N",None,None,None,("in",("C","X"))))
         but = (
             ("Accept",None,self.doAccept,0,("T",0,2),("T",0,0)),
             ("Cancel",None,self.doCancel,0,("T",0,2),("T",0,0)),
@@ -156,9 +169,6 @@
             else:
                 self.trn = False
 
-    def doName(self, frt, pag, r, c, p, i, w):
-        pass
-
     def doAddr(self, frt, pag, r, c, p, i, w):
         if not w:
             self.df.loadEntry(frt, pag, p+1, data="")
@@ -166,35 +176,14 @@
             self.df.loadEntry(frt, pag, p+3, data="")
             return "sk3"
 
-    def doTelno(self, frt, pag, r, c, p, i, w):
-        pass
-
-    def doEmail(self, frt, pag, r, c, p, i, w):
-        pass
-
-    def doVatInd(self, frt, pag, r, c, p, i, w):
-        pass
-
     def doVatNum(self, frt, pag, r, c, p, i, w):
         if self.new == "n" and self.trn:
             return "sk1"
 
-    def doStart(self, frt, pag, r, c, p, i, w):
-        pass
-
-    def doPeriod(self, frt, pag, r, c, p, i, w):
-        pass
-
-    def doPayInd(self, frt, pag, r, c, p, i, w):
-        pass
-
-    def doAmount(self, frt, pag, r, c, p, i, w):
+    def doEType(self, frt, pag, r, c, p, i, w):
         if self.new == "y":
             self.df.loadEntry(frt, pag, p+1, data="C")
 
-    def doStatus(self, frt, pag, r, c, p, i, w):
-        pass
-
     def doDelete(self):
         if self.trn:
             return "Transactions Exist, Not Deleted"

=== modified file 'rca/rc2010.py'
--- rca/rc2010.py	2017-08-24 07:49:34 +0000
+++ rca/rc2010.py	2018-08-17 09:30:24 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -739,8 +739,8 @@
         # Tenants Journal Entries (Unallocated)
         if self.glint == "Y":
             amt = float(ASD(0) - ASD(amt))
-            data = [self.opts["conum"], self.rcatrx, curdt, self.trndat, gltyp,
-                self.trnref, self.batno, amt, 0, gld, "", "", 0,
+            data = [self.opts["conum"], self.rcatrx, curdt, self.trndat,
+                gltyp, self.trnref, self.batno, amt, 0, gld, "", "", 0,
                 self.opts["capnm"], self.sysdtw, 0]
             self.sql.insRec("gentrn", data=data)
 

=== modified file 'rca/rc3010.py'
--- rca/rc3010.py	2017-08-24 07:49:34 +0000
+++ rca/rc3010.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3020.py'
--- rca/rc3020.py	2017-08-24 07:49:34 +0000
+++ rca/rc3020.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3030.py'
--- rca/rc3030.py	2017-08-24 07:49:34 +0000
+++ rca/rc3030.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3040.py'
--- rca/rc3040.py	2017-08-24 07:49:34 +0000
+++ rca/rc3040.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time

=== modified file 'rca/rc3050.py'
--- rca/rc3050.py	2017-08-24 07:49:34 +0000
+++ rca/rc3050.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3060.py'
--- rca/rc3060.py	2017-08-24 07:49:34 +0000
+++ rca/rc3060.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc3070.py'
--- rca/rc3070.py	2017-08-24 07:49:34 +0000
+++ rca/rc3070.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rca/rc3080.py'
--- rca/rc3080.py	2017-08-24 07:49:34 +0000
+++ rca/rc3080.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rca/rc3090.py'
--- rca/rc3090.py	2017-08-24 07:49:34 +0000
+++ rca/rc3090.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc4010.py'
--- rca/rc4010.py	2017-08-24 07:49:34 +0000
+++ rca/rc4010.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rc4020.py'
--- rca/rc4020.py	2017-08-24 07:49:34 +0000
+++ rca/rc4020.py	2018-08-17 14:38:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -97,7 +97,11 @@
             (("T",2,6,0),"OUI",3,"Number of Periods"),
             (("T",2,7,0),"OUD",12.2,"Rental Amount"),
             (("T",2,8,0),"OUD",12.2,"Deposit Amount"),
-            (("T",2,9,0),"OUA",1,"Status"),
+            (("T",2,9,0),"OUD",12.2,"Basic Water Amount"),
+            (("T",2,9,0),"OUI",1,"Type"),
+            (("T",2,10,0),"OUD",12.2,"Basic Exlectricity Amount"),
+            (("T",2,10,0),"OUI",1,"Type"),
+            (("T",2,11,0),"OUA",1,"Status"),
             (("C",3,0,0),"OSD",13.2,"Value","",
                 "","N",None,None,None,None,("Details",7)),
             (("T",4,0,0),"IUI",3,"Sequence Number","",

=== removed file 'rca/rc6010.py'
--- rca/rc6010.py	2017-08-24 07:49:34 +0000
+++ rca/rc6010.py	1970-01-01 00:00:00 +0000
@@ -1,150 +0,0 @@
-"""
-SYNOPSIS
-    CSV File Imports.
-
-    This file is part of Tartan Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
-"""
-
-from TartanClasses import TartanDialog, Sql
-from tartanFunctions import askQuestion
-
-class rc6010:
-    def __init__(self, **opts):
-        self.opts = opts
-        if self.setVariables():
-            self.mainProcess()
-            self.opts["mf"].startLoop()
-
-    def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["ctlmst", "rcaowm", "rcaprm",
-            "rcatnm", "rcacon"], prog=__name__)
-        if self.sql.error:
-            return
-        self.commit = False
-        return True
-
-    def mainProcess(self):
-        tit = ("%s" % "CSV File Imports",)
-        fle = {
-            "stype": "F",
-            "types": "fle",
-            "ftype": (("CSV Files", "*.csv"),)}
-        coy = {
-            "stype": "R",
-            "tables": ("ctlmst",),
-            "cols": (
-                ("ctm_cono", "", 0, "Coy"),
-                ("ctm_name", "", 0, "Name", "Y"))}
-        r1s = (("Owner", "O"), ("Premises", "P"), ("Tenants", "T"))
-        r2s = (("Yes", "Y"), ("No", "N"))
-        fld = (
-            (("T",0,0,0),"INA",50,"File Name","",
-                "","N",self.doFile,fle,None,("fle",)),
-            (("T",0,1,0),("IRB",r1s),0,"File Type","",
-                "O","N",self.doType,None,None,None),
-            (("T",0,2,0),"IUI",3,"Company Number","",
-                1,"N",self.doCono,coy,None,("notzero",)),
-            (("T",0,3,0),("IRB",r2s),0,"Delete Existing","",
-                "N","N",self.doDelete,None,None,None))
-        tnd = ((self.doEnd,"y"), )
-        txt = (self.doExit, )
-        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt)
-
-    def doFile(self, frt, pag, r, c, p, i, w):
-        self.file = w
-
-    def doType(self, frt, pag, r, c, p, i, w):
-        self.rtyp = w
-
-    def doCono(self, frt, pag, r, c, p, i, w):
-        self.cono = w
-        acc = self.sql.getRec(tables="ctlmst", where=[("ctm_cono", "=",
-            self.cono)], limit=1)
-        if not acc:
-            return "Invalid Company"
-
-    def doDelete(self, frt, pag, r, c, p, i, w):
-        self.delete = w
-
-    def doEnd(self):
-        if self.delete == "Y":
-            if self.rtyp == "O":
-                self.sql.delRec("rcaowm", where=[("rom_cono", "=", self.cono)])
-            elif self.rtyp == "P":
-                self.sql.delRec("rcaprm", where=[("rcp_cono", "=", self.cono)])
-            if self.rtyp == "T":
-                self.sql.delRec("rcatnm", where=[("rtn_cono", "=", self.cono)])
-                self.sql.delRec("rcacon", where=[("rcc_cono", "=", self.cono)])
-        data = open(self.file, "r")
-        raw = data.readlines()
-        for line in raw:
-            line = line.rstrip().split(",")
-            if self.rtyp == "O":
-                if len(line) > 6:
-                    yes = askQuestion(self.opts["mf"].body, "Owner Error",
-                        "%s\n\nContinue??????" % line)
-                    if yes == "no":
-                        self.opts["mf"].dbm.rollbackDbase()
-                        break
-                else:
-                    data = [self.cono]
-                    data.extend(line)
-                    data.extend(["","","","","","","","","",0])
-                    self.sql.insRec("rcaowm", data=data)
-                    self.commit = True
-            elif self.rtyp == "P":
-                if len(line) > 7:
-                    yes = askQuestion(self.opts["mf"].body, "Premises Error",
-                        "%s\n\nContinue??????" % line)
-                    if yes == "no":
-                        self.opts["mf"].dbm.rollbackDbase()
-                        break
-                else:
-                    data = [self.cono]
-                    data.extend(line)
-                    data.append(0)
-                    self.sql.insRec("rcaprm", data=data)
-                    self.commit = True
-            elif self.rtyp == "T":
-                if len(line) > 13:
-                    yes = askQuestion(self.opts["mf"].body, "Tenant Error",
-                        "%s\n\nContinue??????" % line)
-                    if yes == "no":
-                        self.opts["mf"].dbm.rollbackDbase()
-                        break
-                else:
-                    data = [self.cono]
-                    data.extend(line[:4])
-                    data.extend(["","","",""])
-                    data.extend(line[4:6])
-                    data.append("")
-                    self.sql.insRec("rcatnm", data=data)
-                    data = [self.cono]
-                    data.extend(line[:3])
-                    data.append(1)
-                    data.extend(line[8:12])
-                    data.append(0)
-                    data.append(line[12])
-                    self.sql.insRec("rcacon", data=data)
-                    self.commit = True
-        yes = askQuestion(self.opts["mf"].body, "More",
-            "Would You Like To Import Another File?")
-        if yes == "no":
-            self.doExit()
-        else:
-            self.df.focusField("T", 0, 1)
-
-    def doExit(self):
-        if self.commit:
-            self.opts["mf"].dbm.commitDbase(ask=True)
-        self.df.closeProcess()
-        self.opts["mf"].closeLoop()
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== removed file 'rca/rc6020.py'
--- rca/rc6020.py	2017-08-24 07:49:34 +0000
+++ rca/rc6020.py	1970-01-01 00:00:00 +0000
@@ -1,154 +0,0 @@
-"""
-SYNOPSIS
-    CSV File Imports.
-
-    This file is part of Tartan Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
-"""
-
-import time
-from TartanClasses import ASD, TartanDialog, Sql
-from tartanFunctions import askQuestion
-
-class rc6020:
-    def __init__(self, **opts):
-        self.opts = opts
-        if self.setVariables():
-            self.mainProcess()
-            self.opts["mf"].startLoop()
-
-    def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["ctlmst", "rcaowt", "rcatnm",
-            "rcacon", "rcatnt"], prog=__name__)
-        if self.sql.error:
-            return
-        self.commit = False
-        t = time.localtime()
-        self.sysdtw = (t[0] * 10000) + (t[1] * 100) + t[2]
-        return True
-
-    def mainProcess(self):
-        tit = ("%s" % "CSV File Imports",)
-        fle = {
-            "stype": "F",
-            "types": "fle",
-            "ftype": (("CSV Files", "*.csv"),)}
-        coy = {
-            "stype": "R",
-            "tables": ("ctlmst",),
-            "cols": (
-                ("ctm_cono", "", 0, "Coy"),
-                ("ctm_name", "", 0, "Name", "Y"))}
-        r1s = (("Owner", "O"), ("Tenants", "T"))
-        r2s = (("Yes", "Y"), ("No", "N"))
-        fld = (
-            (("T",0,0,0),"INA",50,"File Name","",
-                "","N",self.doFile,fle,None,("fle",)),
-            (("T",0,1,0),("IRB",r1s),0,"File Type","",
-                "O","N",self.doType,None,None,None),
-            (("T",0,2,0),"IUI",3,"Company Number","",
-                1,"N",self.doCono,coy,None,("notzero",)),
-            (("T",0,3,0),("IRB",r2s),0,"Delete Existing","",
-                "N","N",self.doDelete,None,None,None))
-        tnd = ((self.doEnd,"y"), )
-        txt = (self.doExit, )
-        self.df = TartanDialog(self.opts["mf"], title=tit, eflds=fld, tend=tnd,
-            txit=txt)
-
-    def doFile(self, frt, pag, r, c, p, i, w):
-        self.file = w
-
-    def doType(self, frt, pag, r, c, p, i, w):
-        self.atyp = w
-
-    def doCono(self, frt, pag, r, c, p, i, w):
-        self.cono = w
-        acc = self.sql.getRec(tables="ctlmst", where=[("ctm_cono", "=",
-            self.cono)], limit=1)
-        if not acc:
-            return "Invalid Company"
-
-    def doDelete(self, frt, pag, r, c, p, i, w):
-        self.delete = w
-
-    def doEnd(self):
-        if self.delete == "Y":
-            if self.atyp == "O":
-                self.sql.delRec("rcaowt", where=[("rot_cono", "=", self.cono)])
-            if self.atyp == "T":
-                self.sql.delRec("rcatnt", where=[("rtu_cono", "=", self.cono)])
-                self.sql.delRec("rcaowt", where=[("rot_cono", "=", self.cono),
-                    ("rot_type", "=", 1)])
-        data = open(self.file, "r")
-        raw = data.readlines()
-        for line in raw:
-            line = line.rstrip().split(",")
-            if self.atyp == "O":
-                if len(line) > 6:
-                    yes = askQuestion(self.opts["mf"].body, "Owner Error",
-                        "%s\n\nContinue??????" % line)
-                    if yes == "no":
-                        self.opts["mf"].dbm.rollbackDbase()
-                        break
-                else:
-                    data = [self.cono]
-                    data.extend(line)
-                    data.extend(["","","","","","","","","",0])
-                    self.sql.insRec("rcaowm", data=data)
-                    self.commit = True
-            elif self.atyp == "T":
-                if len(line) != 7:
-                    yes = askQuestion(self.opts["mf"].body, "Tenant Error",
-                        "%s\n\nContinue??????" % line)
-                    if yes == "no":
-                        self.opts["mf"].dbm.rollbackDbase()
-                        break
-                else:
-                    data = [self.cono]
-                    data.extend(line[:3])
-                    data.append(1)
-                    data.append(4)
-                    data.append("Take/On")
-                    data.append("")
-                    data.append(20070720)
-                    if line[3]:
-                        self.sql.updRec("rcacon", cols=["rcc_deposit"],
-                            data=[line[3]], where=[("rcc_cono", "=",
-                            self.cono), ("rcc_owner", "=", line[0]),
-                            ("rcc_code", "=", line[1]), ("rcc_acno", "=",
-                            line[2]), ("rcc_cnum", "=", 1)])
-                    if line[4]:
-                        rec = [self.cono, line[0], line[1], line[2], 1, 1,
-                            "Take/On", "", 20070720, 1, line[4], 0.0, 200707,
-                            "Initial Takeon", "", "", self.sysdtw, 0]
-                        self.sql.insRec("rcatnt", data=rec)
-                        amt = float(ASD(0) - ASD(line[4]))
-                        rec = [self.cono, line[0], 1, "Take/On", "", 20070720,
-                            amt, 0.0, 200707, "Initial Takeon", "", "",
-                            self.sysdtw, 0]
-                        self.sql.insRec("rcaowt", data=rec)
-                    if line[5]:
-                        rec = [self.cono, line[0], line[1], line[2], 1, 4,
-                            "Take/On", "", 20070720, 5, line[5], 0.0, 200707,
-                            "Initial Takeon", "", "", self.sysdtw, 0]
-                        self.sql.insRec("rcatnt", data=rec)
-                    self.commit = True
-        yes = askQuestion(self.opts["mf"].body, "More",
-            "Would You Like To Import Another File?")
-        if yes == "no":
-            self.doExit()
-        else:
-            self.df.focusField("T", 0, 1)
-
-    def doExit(self):
-        if self.commit:
-            self.opts["mf"].dbm.commitDbase(ask=True)
-        self.df.closeProcess()
-        self.opts["mf"].closeLoop()
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== removed file 'rca/rc6030.py'
--- rca/rc6030.py	2017-08-24 07:49:34 +0000
+++ rca/rc6030.py	1970-01-01 00:00:00 +0000
@@ -1,69 +0,0 @@
-"""
-SYNOPSIS
-    Rentals Missing Masterfile Records.
-
-    This file is part of Tartan Systems (TARTAN).
-
-AUTHOR
-    Written by Paul Malherbe, <paul@tartan.co.za>
-
-COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
-"""
-
-from TartanClasses import ScrollText, Sql
-
-class rc6030:
-    def __init__(self, **opts):
-        self.opts = opts
-        if self.setVariables():
-            self.mainProcess()
-
-    def setVariables(self):
-        self.sql = Sql(self.opts["mf"].dbm, ["rcaowm", "rcaprm", "rcatnm",
-            "rcacon"], prog=__name__)
-        if self.sql.error:
-            return
-        self.chk = [
-            [                                                       # 0
-                ["rcaprm", ["rcp_cono", "rcp_owner"]],              # 0,0
-                ["rcaowm", ["rom_cono", "rom_acno"]]],              # 0,1
-            [                                                       # 1
-                ["rcatnm", ["rtn_cono", "rtn_owner"]],              # 1,0
-                ["rcaowm", ["rom_cono", "rom_acno"]]],              # 1,1
-            [
-                ["rcacon", ["rcc_cono", "rcc_owner"]],
-                ["rcaowm", ["rom_cono", "rom_acno"]]],
-            [
-                ["rcaprm", ["rcp_cono", "rcp_owner", "rcp_code"]],
-                ["rcatnm", ["rtn_cono", "rtn_owner", "rtn_code"]]],
-            [
-                ["rcatnm", ["rtn_cono", "rtn_owner", "rtn_code", "rtn_acno"]],
-                ["rcacon", ["rcc_cono", "rcc_owner", "rcc_code", "rcc_acno"]]]]
-        return True
-
-    def mainProcess(self):
-        miss = {}
-        for c in self.chk:
-            rec = self.sql.getRec(tables=c[0][0], cols=c[0][1])
-            if not rec:
-                continue
-            for r in rec:
-                whr = []
-                for n, w in enumerate(c[1][1]):
-                    whr.append((w, "=", r[n]))
-                acc = self.sql.getRec(tables=c[1][0], where=whr, limit=1)
-                if not acc:
-                    if c[1][0] not in miss:
-                        miss[c[1][0]] = [r]
-                    elif r not in miss[c[1][0]]:
-                        miss[c[1][0]].append(r)
-        missing = ""
-        for key in (("rcaowm", "Owner"), ("rcaprm", "Premises")):
-            if key[0] in miss:
-                for r in miss[key[0]]:
-                    missing = missing + "Missing %s %s\n" % (key[1], r)
-        ScrollText(scrn=self.opts["mf"].body, title="Missing Records",
-            mess=missing)
-
-# vim:set ts=4 sw=4 sts=4 expandtab:

=== modified file 'rca/rcc110.py'
--- rca/rcc110.py	2017-08-24 07:49:34 +0000
+++ rca/rcc110.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcc210.py'
--- rca/rcc210.py	2017-08-24 07:49:34 +0000
+++ rca/rcc210.py	2018-07-17 06:12:00 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'rca/rcc220.py'
--- rca/rcc220.py	2017-08-24 07:49:34 +0000
+++ rca/rcc220.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcc310.py'
--- rca/rcc310.py	2017-08-24 07:49:34 +0000
+++ rca/rcc310.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rca/rcm010.py'
--- rca/rcm010.py	2017-08-24 07:49:34 +0000
+++ rca/rcm010.py	2018-08-17 14:33:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, time
@@ -47,6 +47,7 @@
             self.rcacom = ctlctl["rca_com"]
             self.rcaown = ctlctl["rca_own"]
             self.rcatnt = ctlctl["rca_tnt"]
+            self.rcatrx = ctlctl["rca_trx"]
             self.convat = ctlctl["vat_ctl"]
         # Check for Company Record
         ctlmst = gc.getCtl("ctlmst", self.opts["conum"])
@@ -100,13 +101,15 @@
 
     def updateTables(self):
         self.df.closeProcess()
+        whr = [
+            ("rcc_cono", "=", self.opts["conum"]),
+            ("rtn_cono=rcc_cono",), ("rtn_owner=rcc_owner",),
+            ("rtn_code=rcc_code",), ("rtn_acno=rcc_acno",),
+            ("rcc_status", "<>", "X")]
         recs = self.sql.getRec(tables=["rcacon", "rcatnm"], cols=["rcc_cono",
             "rcc_owner", "rcc_code", "rcc_acno", "rcc_cnum", "rcc_payind",
-            "rcc_start", "rcc_period", "rcc_rtlamt", "rcc_deposit",
-            "rtn_name"], where=[("rcc_cono", "=", self.opts["conum"]),
-            ("rtn_cono=rcc_cono",), ("rtn_owner=rcc_owner",),
-            ("rtn_code=rcc_code",), ("rtn_acno=rcc_acno",), ("rcc_status",
-            "<>", "X")])
+            "rcc_start", "rcc_period", "rcc_rtlamt", "rcc_deposit", "rcc_wamt",
+            "rcc_wtyp", "rcc_eamt", "rcc_etyp", "rtn_name"], where=whr,)
         if recs:
             for num, self.con in enumerate(recs):
                 own = self.sql.getRec(tables="rcaowm", cols=["rom_vatdf"],
@@ -120,8 +123,7 @@
                 self.vatdf = own[0]
                 self.prm = self.sql.getRec(tables="rcaprm", cols=["rcp_crate"],
                     where=[("rcp_cono", "=", self.opts["conum"]), ("rcp_owner",
-                    "=", self.con[1]), ("rcp_code", "=", self.con[2])],
-                    limit=1)
+                    "=", self.con[1]), ("rcp_code", "=", self.con[2])], limit=1)
                 if not self.prm:
                     showError(self.opts["mf"].body, "Missing Premises",
                         "This Premises's Record (%s %s) Could Not Be Found!" %
@@ -132,6 +134,10 @@
                 self.pers = self.con[7]
                 self.amnt = self.con[8]
                 self.depo = self.con[9]
+                self.wamt = self.con[10]
+                self.wtyp = self.con[11]
+                self.eamt = self.con[12]
+                self.etyp = self.con[13]
                 if self.freq == "M":
                     mths = 1 * self.pers
                 elif self.freq == "3":
@@ -140,7 +146,6 @@
                     mths = 6 * self.pers
                 else:
                     mths = 12 * self.pers
-
                 yy = int(strt / 10000)
                 mm = int((strt % 10000) / 100) + mths - 1
                 while mm < 1:
@@ -166,11 +171,12 @@
                         "This contract has Expired, would you like to "\
                         "Renew it?\n\nOwner: %s\nPremises: %s\nAccount: %s\n"\
                         "Name: %s" % (self.con[1], self.con[2], self.con[3],
-                        self.con[10]))
+                        self.con[14]))
                     if ok == "no":
                         continue
                     self.doExpiredContract()
                 self.doRaiseRental(num)
+                self.doRaiseExtra(num)
         self.sql.updRec("rcactl", cols=["cte_lme"], data=[self.tme],
             where=[("cte_cono", "=", self.opts["conum"])])
         self.opts["mf"].dbm.commitDbase(ask=True, mess="Do You Want To Save "\
@@ -200,7 +206,15 @@
             (("T",0,7,0),"IUD",12.2,"Rental Amount","",
                 self.amnt,"N",None,None,None,("notzero",)),
             (("T",0,8,0),"IUD",12.2,"Deposit Amount","",
-                self.depo,"N",None,None,None,("efld",)))
+                self.depo,"N",None,None,None,("efld",)),
+            (("T",0,9,0),"IUD",12.2,"Basic Water Amount","",
+                "","N",None,None,None,("efld",)),
+            (("T",0,10,0),"IUI",1,"Type","",
+                "","N",None,None,None,("efld",)),
+            (("T",0,11,0),"IUD",12.2,"Basic Exlectricity Amount","",
+                "","N",None,None,None,("efld",)),
+            (("T",0,12,0),"IUI",1,"Type","",
+                "","N",None,None,None,("efld",)))
         tnd = ((self.doExpireEnd,"y"), )
         txt = (self.doLoadFocus, )
         self.na = TartanDialog(self.opts["mf"], tops=True, title=tit,
@@ -208,9 +222,6 @@
         self.doLoadFocus()
         self.opts["mf"].startLoop()
 
-    #def doDeposit(self, frt, pag, r, c, p, i, w):
-    #    self.diff = float(ASD(w) - ASD(self.depo))
-
     def doExpireEnd(self):
         dat = self.con[:4]
         dat.append(self.con[4] + 1)
@@ -230,6 +241,7 @@
             vrte = 0.0
         vat = CCD(round((amt * vrte / 100), 2), "SD", 11.2).work
         tot = float(ASD(amt) + ASD(vat))
+        # Tenant Transaction
         data = self.con[:5]
         data.extend([1, ref, self.batch, self.nxtdt, 1, tot, vat, self.nxtcd,
             "Rental Raised", self.vatdf, "", self.opts["capnm"], self.sysdtw,
@@ -244,6 +256,7 @@
             self.sql.insRec("gentrn", data=data)
         rta = float(ASD(0) - ASD(tot))
         rtv = float(ASD(0) - ASD(vat))
+        # Owner Transaction
         data = self.con[:2]
         data.extend([1, ref, self.batch, self.nxtdt, rta, rtv, self.nxtcd,
             "Rental on %s Premises" % self.con[2], self.vatdf, "",
@@ -267,6 +280,7 @@
             cma = float(ASD(0) - ASD(cma))
             tax = float(ASD(0) - ASD(cmv))
             des = "Commission @ %3.5s%s Inclusive" % (self.prm[0], "%")
+            # Raise Commission
             data = self.con[:2]
             data.extend([4, ref, self.batch, self.nxtdt, cmt, cmv, self.nxtcd,
                 des, self.taxdf, "", self.opts["capnm"], self.sysdtw, 0])
@@ -286,7 +300,7 @@
             if self.taxdf:
                 # VAT Transaction (ctlvtf)
                 data = [self.opts["conum"], self.taxdf, "O", self.nxtcd, "R",
-                    1, self.batch, ref, self.nxtdt, self.con[3], self.con[10],
+                    1, self.batch, ref, self.nxtdt, self.con[3], self.con[14],
                     cma, tax, 0, self.opts["capnm"], self.sysdtw, 0]
                 self.sql.insRec("ctlvtf", data=data)
                 if self.glint == "Y" and tax:
@@ -296,11 +310,58 @@
                         self.opts["capnm"], self.sysdtw, 0]
                     self.sql.insRec("gentrn", data=data)
 
+    def doRaiseExtra(self, num):
+        for x in ("W", "E"):
+            ref = CCD((num + 1), "Na", 9).work
+            num += 1
+            if x == "W":
+                if not self.con[10]:
+                    continue
+                amt = self.con[10]
+                typ = self.con[11]
+                des = "Basic Water Charge"
+            elif x == "E":
+                if not self.con[12]:
+                    continue
+                amt = self.con[12]
+                typ = self.con[13]
+                des = "Basic Electricity Charge"
+            # Tenant Transaction
+            data = self.con[:5]
+            data.extend([1, ref, self.batch, self.nxtdt, 4, amt, 0, self.nxtcd,
+                des, "", "", self.opts["capnm"], self.sysdtw, 0])
+            self.sql.insRec("rcatnt", data=data)
+            if self.glint == "Y":
+                gld = "%7s %7s %7s" % tuple(self.con[1:4])
+                data = [self.opts["conum"], self.rcatnt, self.nxtcd,
+                    self.nxtdt, 4, num, self.batch, amt, 0, gld, "",
+                    "", 0, self.opts["capnm"], self.sysdtw, 0]
+                self.sql.insRec("gentrn", data=data)
+            amt = float(ASD(0) - ASD(amt))
+            if typ == 4:
+                # Services - Owner Recovery
+                des = "Services Recovery on %s" % self.con[2]
+                data = [self.opts["conum"], self.con[1], 4, num, self.batch,
+                    self.nxtdt, amt, 0, self.nxtcd, des, "", "",
+                    self.opts["capnm"], self.sysdtw, 0]
+                self.sql.insRec("rcaowt", data=data)
+                if self.glint == "Y":
+                    # General Ledger Transaction for Owner Control
+                    gld = "%7s Services Recovery" % self.con[2]
+                    data = [self.opts["conum"], self.rcaown, self.nxtcd,
+                        self.nxtdt, 4, num, self.batch, amt, 0, gld, "",
+                        "", 0, self.opts["capnm"], self.sysdtw, 0]
+                    self.sql.insRec("gentrn", data=data)
+            elif self.glint == "Y":
+                # Non Recovery - Update Rental Control
+                data = [self.opts["conum"], self.rcatrx, self.nxtcd,
+                    self.nxtdt, 4, num, self.batch, amt, 0, gld, "",
+                    "", 0, self.opts["capnm"], self.sysdtw, 0]
+                self.sql.insRec("gentrn", data=data)
+
     def doLoadFocus(self):
-        self.na.loadEntry("T", 0, 0, data=self.con[1])
-        self.na.loadEntry("T", 0, 0, data=self.con[2])
-        self.na.loadEntry("T", 0, 1, data=self.con[3])
-        self.na.loadEntry("T", 0, 2, data=self.con[10])
+        for num, fld in enumerate(self.con[1:14]):
+            self.na.loadEntry("T", 0, num, data=fld)
         self.na.focusField("T", 0, 4)
 
     def closeProcess(self):

=== modified file 'rtl/rt1010.py'
--- rtl/rt1010.py	2017-08-24 07:49:34 +0000
+++ rtl/rt1010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt2010.py'
--- rtl/rt2010.py	2017-08-24 07:49:34 +0000
+++ rtl/rt2010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3010.py'
--- rtl/rt3010.py	2017-08-24 07:49:34 +0000
+++ rtl/rt3010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3020.py'
--- rtl/rt3020.py	2017-08-24 07:49:34 +0000
+++ rtl/rt3020.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3030.py'
--- rtl/rt3030.py	2017-08-24 07:49:34 +0000
+++ rtl/rt3030.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3040.py'
--- rtl/rt3040.py	2017-08-24 07:49:34 +0000
+++ rtl/rt3040.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt3050.py'
--- rtl/rt3050.py	2017-08-24 07:49:34 +0000
+++ rtl/rt3050.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'rtl/rt4010.py'
--- rtl/rt4010.py	2017-08-24 07:49:34 +0000
+++ rtl/rt4010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rt6010.py'
--- rtl/rt6010.py	2017-08-24 07:49:34 +0000
+++ rtl/rt6010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'rtl/rtc110.py'
--- rtl/rtc110.py	2017-08-24 07:49:34 +0000
+++ rtl/rtc110.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rtc210.py'
--- rtl/rtc210.py	2017-08-24 07:49:34 +0000
+++ rtl/rtc210.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'rtl/rtm010.py'
--- rtl/rtm010.py	2018-03-30 21:03:30 +0000
+++ rtl/rtm010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'scp/sc1010.py'
--- scp/sc1010.py	2017-08-24 07:49:34 +0000
+++ scp/sc1010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, Sql, TartanDialog

=== modified file 'scp/sc2010.py'
--- scp/sc2010.py	2018-02-17 07:36:43 +0000
+++ scp/sc2010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'scp/sc2020.py'
--- scp/sc2020.py	2018-05-31 15:57:14 +0000
+++ scp/sc2020.py	2018-07-17 06:12:01 +0000
@@ -25,7 +25,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, os, random, time

=== modified file 'scp/sc2030.py'
--- scp/sc2030.py	2018-05-31 15:57:14 +0000
+++ scp/sc2030.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, SelectChoice, Sql

=== modified file 'scp/sc3010.py'
--- scp/sc3010.py	2017-08-24 07:49:34 +0000
+++ scp/sc3010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'scp/scc210.py'
--- scp/scc210.py	2017-08-24 07:49:34 +0000
+++ scp/scc210.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, ProgressBar, TartanDialog, Sql

=== modified file 'sls/si2010.py'
--- sls/si2010.py	2018-05-01 16:28:35 +0000
+++ sls/si2010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si2020.py'
--- sls/si2020.py	2017-08-24 07:49:34 +0000
+++ sls/si2020.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import copy, socket, sys, time, functools

=== modified file 'sls/si3010.py'
--- sls/si3010.py	2018-05-31 15:57:14 +0000
+++ sls/si3010.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3020.py'
--- sls/si3020.py	2017-08-24 07:49:34 +0000
+++ sls/si3020.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3030.py'
--- sls/si3030.py	2017-08-24 07:49:34 +0000
+++ sls/si3030.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3040.py'
--- sls/si3040.py	2017-08-24 07:49:34 +0000
+++ sls/si3040.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3050.py'
--- sls/si3050.py	2017-08-24 07:49:34 +0000
+++ sls/si3050.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3060.py'
--- sls/si3060.py	2017-08-24 07:49:34 +0000
+++ sls/si3060.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3070.py'
--- sls/si3070.py	2017-08-24 07:49:34 +0000
+++ sls/si3070.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'sls/si3080.py'
--- sls/si3080.py	2017-08-24 07:49:34 +0000
+++ sls/si3080.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import PrintInvoice, Sql, TartanDialog

=== modified file 'sls/sic110.py'
--- sls/sic110.py	2018-04-08 06:05:45 +0000
+++ sls/sic110.py	2018-07-17 06:12:01 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== removed directory 'snd'
=== removed file 'snd/ding.wav'
Binary files snd/ding.wav	2014-03-28 07:32:49 +0000 and snd/ding.wav	1970-01-01 00:00:00 +0000 differ
=== modified file 'std/TartanClasses.py'
--- std/TartanClasses.py	2018-07-13 08:38:41 +0000
+++ std/TartanClasses.py	2018-08-15 15:05:52 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 #========================================================
 # Standard Python modules
@@ -1736,7 +1736,7 @@
                     "-default", ImageTk.PhotoImage(Image.open(self.icon)))
             except:
                 pass
-        self.newwin.protocol("WM_DELETE_WINDOW", self.doDestroyYes)
+        self.newwin.protocol("WM_DELETE_WINDOW", self.doDestroy)
         self.newwin.bind_all("<Tab>", lambda event: "break")
         if self.size:
             self.newwin.configure(width=self.size[0], height=self.size[1])
@@ -1765,11 +1765,8 @@
                 self.newwin.wait_visibility()
                 self.newwin.grab_set()
 
-    def doDestroyNo(self, widget=None):
-        return True
-
-    def doDestroyYes(self, widget=None, data=None):
-        if not self.remov:
+    def doDestroy(self, widget=None, data=None):
+        if not self.remov or "TARTANDB" in os.environ:
             return True
         ok = askQuestion(screen=self.newwin, head="Destroy Window",
             mess="Are you Sure you want to Quit this Window!\n\n"
@@ -2154,10 +2151,16 @@
                     self.dbdsn = os.path.join(self.dbdir, self.dbname)
                 else:
                     self.dbdsn = self.dbname
-            if self.dbase == "FBird":
-                self.dbmod = "fdb"
-                import fdb as engine
-                self.dbf = "?"
+                if self.dbase == "FBird":
+                    self.dbmod = "fdb"
+                    import fdb as engine
+                    self.dbf = "?"
+                else:
+                    self.dbmod = "sqlite3"
+                    from sqlite3 import dbapi2 as engine
+                    if int(engine.sqlite_version.split(".")[1]) < 8:
+                        self.mrecs = False
+                    self.dbf = "?"
             elif self.dbase == "MySQL":
                 try:
                     import MySQLdbs as engine
@@ -2173,12 +2176,6 @@
                 self.dbmod = "psycopg2"
                 import psycopg2 as engine
                 self.dbf = "%s"
-            elif self.dbase == "SQLite":
-                self.dbmod = "sqlite3"
-                from sqlite3 import dbapi2 as engine
-                if int(engine.sqlite_version.split(".")[1]) < 8:
-                    self.mrecs = False
-                self.dbf = "?"
             else:
                 raise Exception("Invalid Database Type (%s)" % self.dbase)
             self.err = False
@@ -2748,7 +2745,7 @@
             showException(None, self.dbm.wrkdir,
                 "Error Executing SQL Statement\n\n%s\n\nIn module %s" %
                 (str(state), self.prog), dbm=self.dbm)
-            os._exit(0)
+            os._exit(1)
 
     def insRec(self, table, data=[], unique=None, dofmt=True, pbar=None):
         """
@@ -2800,7 +2797,7 @@
 
 Length of Data %s, of CSV %s""" % (table, self.prog, len(tdat), len(col)))
                 self.dbm.rollbackDbase()
-                os._exit(0)
+                os._exit(1)
             # Test and Correct for a Column in Unique Keys (e.g. drt_ref1)
             if unique:
                 cols = self.sqlRec(state=("Select * from ftable where "
@@ -5485,15 +5482,17 @@
                 self.backUp(self.frt, self.pag)
         return True
 
-    def focusField(self, frt, pag, col, clr=True, err="", dir="F"):
+    def focusField(self, frt, pag, col, clr=True, err="", dir="F", tag=True):
         """
         This routine is used to focus on a widget:
             frt = The frame type, T = Top, C = Columnar
             pag = The frame number
             col = The column number
-            clr = Clear the frame if first field of first page, True or False
+            clr = Clear the frame if first field of first page or
+                  Clear the rest of the row if Col Frame - True or False
             err = An error message to display on the status line
             dir = Direction, F = Forwards, B = Backwards when skipping fields
+            tag = Select data in the text view widget
         """
         if frt == "T" and not self.topq[pag]:
             return
@@ -5507,7 +5506,7 @@
         # Force focus to application
         self.window.focus_force()
         if col == 1 and tuple(self.first[:2]) == (frt, pag) and clr:
-            # First field of first screen and page
+            # First field of first screen and page, clear all frames
             for x in xrange(0, self.pgs+1):
                 self.clearFrame("T", x)
                 self.clearFrame("C", x)
@@ -5533,6 +5532,14 @@
             else:
                 faut = False
             #===================================================================
+            # If column field with Y in [6] clear rest of row
+            #===================================================================
+            if len(flds) > 4 and flds[6] == "Y":
+                r1 = self.col
+                r2 = self.topq[pag]
+                for c in range(r1, r2):
+                    self.clearEntry(frt, pag, c)
+            #===================================================================
             # Setting the default data in top entry field
             #===================================================================
             if len(flds) > 4 and flds[6] == "Y":
@@ -5559,15 +5566,20 @@
             else:
                 faut = False
             #===================================================================
+            # If column field with Y in [6] clear rest of row
+            #===================================================================
+            if len(flds) > 4 and flds[6] == "Y":
+                r1 = self.col
+                r2 = self.col + self.colq[pag]
+                for c in range(r1, r2):
+                    self.clearEntry(frt, pag, c)
+            #===================================================================
             # Setting the default data in col entry field
             #===================================================================
-            if len(flds) > 4 and flds[6] == "Y":
-                if self.idx == 0:
-                    self.clearLine(self.pag, self.row)
-                work = ""
-            else:
-                work = self.c_work[self.pag][int(self.pos / self.colq[
-                    self.pag])][self.idx]
+            if len(flds) > 4 and flds[6] == "Y" and self.idx == 0:
+                self.clearLine(self.pag, self.row)
+            work = self.c_work[self.pag][int(self.pos / self.colq[
+                self.pag])][self.idx]
             if work:
                 dflt = work
             elif len(flds) == 4:
@@ -5641,18 +5653,7 @@
             else:
                 sufx = sufx + " or <Esc> to Back Up"
         if err and err != "ok":
-            if self.mf.rcdic["errs"] == "M":
-                flenam = os.path.join(self.mf.rcdic["prgdir"], "snd",
-                    "ding.wav")
-                try:
-                    if sys.platform == "win32":
-                        import winsound
-                        winsound.PlaySound(flenam, winsound.SND_FILENAME)
-                    else:
-                        os.system("aplay -q %s" % flenam)
-                except:
-                    self.mf.window.bell()
-            else:
+            if self.mf.rcdic["errs"] == "Y":
                 self.mf.window.bell()
             self.mf.updateStatus("%s, Retry%s" % (err, sufx), "white", "red")
         else:
@@ -5664,7 +5665,7 @@
             elif flds[1][0][1:] == "RB":
                 self.doRadioButton(fldd, "focus", dflt)
         elif flds[1][1:] in ("TV", "Tv"):
-            self.doTextView(self.frt, self.pag, fldd, "focus", dflt)
+            self.doTextView(self.frt, self.pag, fldd, "focus", dflt, tag)
         else:
             self.doEntryField(self.frt, self.pag, self.idx, fldd, faut,
                 "focus", dflt)
@@ -5722,7 +5723,6 @@
         else:
             flds = self.colf[pag]
             fldd = self.colEntry[pag][self.pos]
-        last = (frt, pag, self.pos)
         if (frt == "T" and self.col == 1) or (frt == "C" and self.idx == 0):
             self.doExitFrame(frt, pag)
             return
@@ -5754,25 +5754,10 @@
             if (frt == "T" and self.col == 1) or (frt == "C" and self.idx == 0):
                 self.doExitFrame(frt, pag)
                 return
-            else:
-                self.idx = self.idx - 1
-                self.pos = self.pos - 1
-                self.col = self.col - 1
-        if last[0] == "T":
-            wrk = self.t_work[last[1]][0][last[2]]
-        else:
-            row = int(last[2] / self.colq[last[1]])
-            idx = int(last[2] % self.colq[last[1]])
-            wrk = self.c_work[last[1]][row][idx]
-        self.loadEntry(last[0], last[1], last[2], data=wrk)
-        self.focusField(frt, pag, self.col, clr=self.doGetClrFlag(flds))
-
-    def doGetClrFlag(self, flds):
-        if len(flds[self.idx]) > 4 and flds[self.idx][6] == "Y":
-            frt = flds[self.idx][0][0]
-            pag = flds[self.idx][0][1]
-            self.clearEntry(frt, pag, self.col)
-            return True
+            self.idx = self.idx - 1
+            self.pos = self.pos - 1
+            self.col = self.col - 1
+        self.focusField(frt, pag, self.col)
 
     def clearFrame(self, frt, pag):
         self.skip[pag] = []
@@ -6250,7 +6235,7 @@
         elif action == "load":
             grp[0][1].set(data)
 
-    def doTextView(self, frt, pag, vwr, act, data=None):
+    def doTextView(self, frt, pag, vwr, act, data=None, tag=True):
         """
         vwr:      The textview widget
         act:      The action to take as follows:
@@ -6265,7 +6250,8 @@
             self.has_focus.append(vwr)
             if data is not None:
                 self.loadEntry(frt, pag, self.pos, data=data)
-                vwr.tag_add("sel", "1.0", "end")
+                if tag:
+                    vwr.tag_add("sel", "1.0", "end")
             vwr.focus_set()
         elif act == "disable":
             vwr.configure(state="disabled")
@@ -8128,8 +8114,7 @@
         r2s = (("Left", "L"), ("Centre", "C"), ("Right", "R"))
         r3s = (("Yes", "Y"), ("No", "N"))
         r4s = (("In-Line", "I"), ("List", "L"), ("None", "N"))
-        r5s = (("Multimedia", "M"), ("Internal", "Y"), ("None", "N"))
-        r6s = (("Red", "R"), ("Green", "G"), ("Blue", "B"), ("Custom", "C"))
+        r5s = (("Red", "R"), ("Green", "G"), ("Blue", "B"), ("Custom", "C"))
         tag = (
             ("DataBase",None,("T",1,1),("T",3,0)),
             ("General",None,("T",1,1),("T",3,0)),
@@ -8198,7 +8183,7 @@
                 self.rcdic["acnf"].upper(),"N",None,None,None,None),
             (("T",2,13,0),("IRB",r3s),0,"Tool-tips","",
                 self.rcdic["ttip"].upper(),"N",None,None,None,None),
-            (("T",2,14,0),("IRB",r5s),0,"Error Alarm","",
+            (("T",2,14,0),("IRB",r3s),0,"Error Alarm","",
                 self.rcdic["errs"].upper(),"N",None,None,None,None),
             (("T",3,0,0),"INA",30,"Menu Font Name","",
                 self.rcdic["mft"],"N",self.doFtNam,aft,None,("in",self.aft),
@@ -8215,7 +8200,7 @@
             (("T",3,2,0),"INA",30,"Theme","",
                 self.rcdic["theme"],"N",self.doTheme,thm,None,("in",self.thm),
                 None,"The Theme to be used"),
-            (("T",3,3,0),("IRB",r6s),0,"Colour Scheme","",
+            (("T",3,3,0),("IRB",r5s),0,"Colour Scheme","",
                 self.rcdic["dcs"],"N",self.doScheme,None,None,None,
                 None,"The Colour Scheme to be used"),
             (("T",3,4,0),"INA",20,"Normal  FG","",
@@ -13953,7 +13938,7 @@
                     "T" = Containing Table Names
                     "D" = Containing lists of Data
     prtdia  :   Whether to have a printer and mail dialog, default is False or
-                   print and mail parameters eg [("Y","V"), ("Y","N")]
+                   print and mail parameters e.g. [("Y","V"), ("Y","N")]
     repprt  :   A list as derived from TartanDialog for print options
     repeml  :   A list as derived from TartanDialog for email options
     fromad  :   The senders email address or None for the default company one
@@ -14958,7 +14943,7 @@
             self.acoy = ""
             self.dcoy = ""
             self.lvl = 9
-            return "sk4"
+            return "sk5"
 
     def doCopyUser1(self, frt, pag, r, c, p, i, w):
         self.cpy = w
@@ -15199,13 +15184,12 @@
     def __init__(self, mf, mode="B", csys=None, ver=None, bar=True):
         self.mf = mf
         self.mode = mode
+        self.budays = 0
         self.smtp = False
         if csys:
             self.budays = csys[0]
             if sendMail(csys[1:], "", "", "", check=True):
                 self.smtp = csys[1:]
-        else:
-            self.budays = 0
         self.ver = ver
         self.bar = bar
         if self.setVariables():

=== modified file 'std/tartanFunctions.py'
--- std/tartanFunctions.py	2018-06-18 06:16:26 +0000
+++ std/tartanFunctions.py	2018-08-15 15:04:56 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from __future__ import generators
@@ -211,6 +211,8 @@
             rcdic[o] = prgdir
         if o in ("vwr", "prn") and rcdic[o].count("Temp"):
             rcdic[o] = os.path.join(prgdir, "uty", os.path.basename(rcdic[o]))
+        if o == "errs" and rcdic[o] == "M":
+            rcdic[o] = "Y"
     if not rcdic["geo"] or rcdic["geo"] == "0":
         try:
             w, h, f = getFontSize()
@@ -1203,6 +1205,11 @@
     This function returns None if the account allows postings or is not an
     integrated control else if pwd it asks for a Password and returns an
     Error Message if not correct otherwise return desc, ind, vat and type.
+
+    coy    - The company number.
+    acc    - The general ledger account number.
+    ctl    - Whether to check if it is an integrated control account.
+    pwd    - Allow overriding restrictions if the password is known.
     """
     from TartanClasses import GetCtl, PwdConfirm, Sql
 
@@ -1333,11 +1340,23 @@
     return rec
 
 def chkAggregate(fld):
+    """
+    Use this function to check if fld is a sql aggregate function.
+    """
     for typ in ("avg(","count(","max(","min(","sum("):
         if fld.lower().count(typ):
             return True
 
 def callModule(mf, df, mod, coy=None, period=None, user=None, args=None, ret=None):
+    """
+    Use yhis funtion to call another module and pass arguments to it.
+
+    coy    - A list of company number and name.
+    period - The financial period tuple.
+    user   - The user name.
+    args   - Any arguments to send to the called module.
+    ret    - A variable to return to the calling module.
+    """
     if df:
         state = df.disableButtonsTags()
         df.setWidget(df.mstFrame, state="hide")

=== modified file 'std/tartanWork.py'
--- std/tartanWork.py	2018-02-25 13:05:58 +0000
+++ std/tartanWork.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 #--------

=== modified file 'std/tartanWork_rne.py'
--- std/tartanWork_rne.py	2017-02-25 14:03:05 +0000
+++ std/tartanWork_rne.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 #--------

=== modified file 'str/st1010.py'
--- str/st1010.py	2018-02-17 07:36:43 +0000
+++ str/st1010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st1020.py'
--- str/st1020.py	2018-02-17 07:36:43 +0000
+++ str/st1020.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/st2010.py'
--- str/st2010.py	2018-04-08 06:05:45 +0000
+++ str/st2010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st2020.py'
--- str/st2020.py	2018-02-17 07:36:43 +0000
+++ str/st2020.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st2030.py'
--- str/st2030.py	2018-02-17 07:36:43 +0000
+++ str/st2030.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st2040.py'
--- str/st2040.py	2018-02-17 07:36:43 +0000
+++ str/st2040.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3010.py'
--- str/st3010.py	2017-08-24 07:49:34 +0000
+++ str/st3010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3020.py'
--- str/st3020.py	2018-02-25 13:05:58 +0000
+++ str/st3020.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3030.py'
--- str/st3030.py	2018-02-17 07:36:43 +0000
+++ str/st3030.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3040.py'
--- str/st3040.py	2018-02-17 07:36:43 +0000
+++ str/st3040.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3050.py'
--- str/st3050.py	2017-08-24 07:49:34 +0000
+++ str/st3050.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3060.py'
--- str/st3060.py	2017-08-24 07:49:34 +0000
+++ str/st3060.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3070.py'
--- str/st3070.py	2017-08-24 07:49:34 +0000
+++ str/st3070.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3080.py'
--- str/st3080.py	2018-03-30 21:03:30 +0000
+++ str/st3080.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3090.py'
--- str/st3090.py	2017-08-24 07:49:34 +0000
+++ str/st3090.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3100.py'
--- str/st3100.py	2017-08-24 07:49:34 +0000
+++ str/st3100.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'str/st3110.py'
--- str/st3110.py	2018-02-17 07:36:43 +0000
+++ str/st3110.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st3120.py'
--- str/st3120.py	2018-02-17 07:36:43 +0000
+++ str/st3120.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st4010.py'
--- str/st4010.py	2018-02-25 13:05:58 +0000
+++ str/st4010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5010.py'
--- str/st5010.py	2018-02-17 07:36:43 +0000
+++ str/st5010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5020.py'
--- str/st5020.py	2018-02-17 07:36:43 +0000
+++ str/st5020.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5030.py'
--- str/st5030.py	2017-08-24 07:49:34 +0000
+++ str/st5030.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st5040.py'
--- str/st5040.py	2017-08-24 07:49:34 +0000
+++ str/st5040.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st6010.py'
--- str/st6010.py	2017-08-24 07:49:34 +0000
+++ str/st6010.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import FileImport, GetCtl, ProgressBar, Sql, TartanDialog

=== modified file 'str/st6020.py'
--- str/st6020.py	2018-02-17 07:36:43 +0000
+++ str/st6020.py	2018-07-17 06:12:02 +0000
@@ -9,7 +9,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st6030.py'
--- str/st6030.py	2017-08-24 07:49:34 +0000
+++ str/st6030.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/st6040.py'
--- str/st6040.py	2018-02-17 07:36:43 +0000
+++ str/st6040.py	2018-07-17 06:12:02 +0000
@@ -9,7 +9,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc110.py'
--- str/stc110.py	2017-08-24 07:49:34 +0000
+++ str/stc110.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc210.py'
--- str/stc210.py	2017-08-24 07:49:34 +0000
+++ str/stc210.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'str/stc220.py'
--- str/stc220.py	2017-08-24 07:49:34 +0000
+++ str/stc220.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc310.py'
--- str/stc310.py	2017-08-24 07:49:34 +0000
+++ str/stc310.py	2018-07-17 06:12:02 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/stc320.py'
--- str/stc320.py	2017-08-24 07:49:34 +0000
+++ str/stc320.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'str/stc410.py'
--- str/stc410.py	2017-08-24 07:49:34 +0000
+++ str/stc410.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'str/stc420.py'
--- str/stc420.py	2017-08-24 07:49:34 +0000
+++ str/stc420.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'tab/tb1010.py'
--- tab/tb1010.py	2017-08-24 07:49:34 +0000
+++ tab/tb1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'tab/tb1020.py'
--- tab/tb1020.py	2018-06-18 06:16:26 +0000
+++ tab/tb1020.py	2018-08-11 10:25:30 +0000
@@ -23,7 +23,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, os, sys, time
@@ -58,8 +58,11 @@
                 self.doBwlSkp()
             if self.opts["cln"]:
                 self.doCleanDatabase()
-            if self.bwltyp and len(self.bwltyp[0]) != 15:
-                self.doBwlPts()
+            if self.bwltyp:
+                sql = Sql(self.dbm, "bwlpts", prog=__name__)
+                chk = sql.getRec("bwlpts", cols=["count(*)"], limit=1)
+                if not chk[0]:
+                    self.doBwlPts(sql)
             if self.opts["ver"]:
                 sql = Sql(self.dbm, "verupd", prog=__name__)
                 if not sql.getRec(tables="verupd"):
@@ -691,8 +694,7 @@
                 sql.insRec("bwltab", data=data)
         self.dbm.commitDbase()
 
-    def doBwlPts(self):
-        sql = Sql(self.dbm, "bwlpts", prog=__name__)
+    def doBwlPts(self, sql):
         for rec in self.bwltyp:
             data = rec[:2]
             data.append("D")
@@ -765,10 +767,10 @@
             self.opts["mf"].updateStatus("Creating Standard Records")
         elif self.opts["bar"]:
             print("Creating Standard Records .... Please Wait")
-        sql = Sql(self.dbm, "frelat", prog=__name__)
+        sql = Sql(self.dbm, ["ffield", "frelat"], prog=__name__)
         if not sql.error:
             sql.sqlRec("Delete from frelat")
-            self.doPopulate(sql, "frelat")
+            self.doPopulate(sql, "frelat", "_cono")
         sql = Sql(self.dbm, "wagrcv", prog=__name__)
         if not sql.error:
             sql.sqlRec("Delete from wagrcv")
@@ -836,7 +838,12 @@
             spl.closeSplash()
         self.dbm.commitDbase()
 
-    def doPopulate(self, sql, table):
+    def doPopulate(self, sql, table, cono=None):
+        if cono:
+            recs = sql.getRec(tables="ffield", cols=["ff_tabl", "ff_name"],
+                where=[("ff_name", "like", "%_cono")])
+            for rec in recs:
+                sql.insRec(table, data=[rec[0], rec[1], "ctlmst", "ctm_cono"])
         dat = "%s.dat" % os.path.join(self.opts["pth"], table)
         if os.path.isfile(dat):
             fle = open(dat, "r")

=== modified file 'tab/tb1030.py'
--- tab/tb1030.py	2017-08-24 07:49:34 +0000
+++ tab/tb1030.py	2018-07-17 06:12:03 +0000
@@ -9,7 +9,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, SChoice, Sql, TartanDialog

=== modified file 'tab/tb1040.py'
--- tab/tb1040.py	2017-08-24 07:49:34 +0000
+++ tab/tb1040.py	2018-07-17 06:12:03 +0000
@@ -9,7 +9,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, sys

=== modified file 'tab/tb3010.py'
--- tab/tb3010.py	2017-08-24 07:49:34 +0000
+++ tab/tb3010.py	2018-07-17 06:12:03 +0000
@@ -9,7 +9,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'uty/bm1010.py'
--- uty/bm1010.py	2017-09-10 14:30:43 +0000
+++ uty/bm1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, glob, imghdr, os, requests, sys, time

=== modified file 'uty/fc1010.py'
--- uty/fc1010.py	2017-08-24 07:49:34 +0000
+++ uty/fc1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import TartanDialog

=== modified file 'uty/pkgprg.py'
--- uty/pkgprg.py	2018-07-13 08:38:41 +0000
+++ uty/pkgprg.py	2018-08-15 14:27:49 +0000
@@ -135,7 +135,7 @@
               "cr3340", "cr3350", "cr3360", "cr3370", "cr3380", "cr3390",
               "cr4010", "cr6010", "cr6020", "gl3030", "gl3100", "gl3110",
               "gl3120", "gl3130", "gl3140", "gl3150", "glc310", "glc410",
-              "glc510", "ln2020", "msc000", "ms1010", "msy030", "tartanWork"]]
+              "glc510", "ln2020", "ms1010", "msy030", "tartanWork"]]
     exclude = ["cr3080", "dr1020", "dr2030", "dr6030", "drc210", "drc220",
                "drc310", "drc320", "drc510", "drc520", "drc610", "drc620",
                "drc710", "drc810", "msy020", "si2020", "si3010", "si3070",
@@ -501,7 +501,6 @@
     exeCmd("rst2pdf doc/BQS.rst -o doc/QuickStart.pdf -s doc/mystylesheet")
     exeCmd("zip -qr %s/TartanSve/%s doc/QuickStart.pdf" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/tartan.ico" % (bd, zipfle))
-exeCmd("zip -q %s/TartanSve/%s snd/ding.wav" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/*.gif" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s img/*.png" % (bd, zipfle))
 exeCmd("zip -q %s/TartanSve/%s uty/SumatraPDF.exe" % (bd, zipfle))
@@ -602,18 +601,18 @@
         print("Version Number is %s.%s.%s" % tuple(ver))
         print("")
         # FTP Server
-        exeCmd("ssh root@server rm /srv/ftp/%s*" % system.capitalize())
-        exeCmd("rsync -artz %s/TartanExe/current root@server:/srv/ftp/ --progress" % bd)
-        exeCmd("rsync -artz %s/TartanExe/%s* root@server:/srv/ftp/ --progress" % (bd, system.capitalize()))
-        exeCmd("ssh root@server chmod a+rwx /srv/ftp/*")
-        exeCmd("ssh root@server chown paul:users /srv/ftp/*")
-        exeCmd("ssh root@server chmod a-w /srv/ftp")
+        exeCmd("ssh root@server rm /var/www/tartan.co.za/files/%s*" % system.capitalize())
+        exeCmd("rsync -az %s/TartanExe/current root@server:/var/www/tartan.co.za/files/ --progress" % bd)
+        exeCmd("rsync -az %s/TartanExe/%s* root@server:/var/www/tartan.co.za/files/ --progress" % (bd, system.capitalize()))
+        exeCmd("ssh root@server chmod a+r /var/www/tartan.co.za/files/*")
+        exeCmd("ssh root@server chown paul:users /var/www/tartan.co.za/files/*")
+        #exeCmd("ssh root@server chmod a-w /var/www/tartan.co.za/files")
         # WWW Server
         if system == "tartan":
-            exeCmd("rsync -artz %s/%s/doc/Tartan.rst root@server:/var/www/tartan.co.za/htdocs/Manual/Manual.rst --progress" % (bd, bv))
-            exeCmd("rsync -artz %s/%s/doc/QST.rst root@server:/var/www/tartan.co.za/htdocs/QuickStart/QuickStart.rst --progress" % (bd, bv))
-            exeCmd("rsync -artz %s/%s/doc/Downloads.rst root@server:/var/www/tartan.co.za/htdocs/Downloads/ --progress" % (bd, bv))
-            exeCmd("rsync -artz %s/%s/doc/Changes.rst root@server:/var/www/tartan.co.za/htdocs/Changes/ --progress" % (bd, bv))
+            exeCmd("rsync -az %s/%s/doc/Tartan.rst root@server:/var/www/tartan.co.za/htdocs/Manual/Manual.rst --progress" % (bd, bv))
+            exeCmd("rsync -az %s/%s/doc/QST.rst root@server:/var/www/tartan.co.za/htdocs/QuickStart/QuickStart.rst --progress" % (bd, bv))
+            exeCmd("rsync -az %s/%s/doc/Downloads.rst root@server:/var/www/tartan.co.za/htdocs/Downloads/ --progress" % (bd, bv))
+            exeCmd("rsync -az %s/%s/doc/Changes.rst root@server:/var/www/tartan.co.za/htdocs/Changes/ --progress" % (bd, bv))
 #os.remove("%s/%s/doc/Manual.pdf" % (bd, bv))
 os.remove("%s/%s/doc/%s.rst" % (bd, bv, man))
 if system in ("tartan", "bwlclb"):
@@ -649,6 +648,7 @@
             "karen@spargs.co.za",
             "keith@barrowdale.co.za",
             "lawrence@hawcweb.co.za",
+            "liezelstroud@gmail.com",
             "lorraine@agfin.co.za",
             "lorraine@acsaccounting.co.za",
             "marindag@buildinn-el.co.za",

=== modified file 'uty/pm1010.py'
--- uty/pm1010.py	2018-05-31 15:57:14 +0000
+++ uty/pm1010.py	2018-07-17 06:12:03 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, os, shutil, sys

=== modified file 'uty/pw1010.py'
--- uty/pw1010.py	2017-08-24 07:49:34 +0000
+++ uty/pw1010.py	2018-07-17 06:12:03 +0000
@@ -12,7 +12,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import random

=== modified file 'uty/rp1010.py'
--- uty/rp1010.py	2017-08-24 07:49:34 +0000
+++ uty/rp1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os

=== modified file 'uty/ss1010.py'
--- uty/ss1010.py	2017-08-24 07:49:34 +0000
+++ uty/ss1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, CCD, RepPrt, Sql, SChoice, TartanDialog

=== modified file 'uty/td1010.py'
--- uty/td1010.py	2017-08-24 07:49:34 +0000
+++ uty/td1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'uty/tdc110.py'
--- uty/tdc110.py	2017-08-24 07:49:34 +0000
+++ uty/tdc110.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'uty/tp1010.py'
--- uty/tp1010.py	2017-08-24 07:49:34 +0000
+++ uty/tp1010.py	2018-07-17 06:12:03 +0000
@@ -10,7 +10,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import operator, os

=== modified file 'wag/sl1010.py'
--- wag/sl1010.py	2017-08-24 07:49:34 +0000
+++ wag/sl1010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2010.py'
--- wag/sl2010.py	2017-08-24 07:49:34 +0000
+++ wag/sl2010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2020.py'
--- wag/sl2020.py	2017-08-24 07:49:34 +0000
+++ wag/sl2020.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl2030.py'
--- wag/sl2030.py	2017-08-24 07:49:34 +0000
+++ wag/sl2030.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3010.py'
--- wag/sl3010.py	2017-08-24 07:49:34 +0000
+++ wag/sl3010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3020.py'
--- wag/sl3020.py	2017-08-24 07:49:34 +0000
+++ wag/sl3020.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3030.py'
--- wag/sl3030.py	2017-08-24 07:49:34 +0000
+++ wag/sl3030.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl3040.py'
--- wag/sl3040.py	2017-08-24 07:49:34 +0000
+++ wag/sl3040.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/sl4010.py'
--- wag/sl4010.py	2017-08-24 07:49:34 +0000
+++ wag/sl4010.py	2018-07-17 06:12:03 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg1010.py'
--- wag/wg1010.py	2017-08-24 07:49:34 +0000
+++ wag/wg1010.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg2010.py'
--- wag/wg2010.py	2017-08-24 07:49:34 +0000
+++ wag/wg2010.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg2020.py'
--- wag/wg2020.py	2017-08-24 07:49:34 +0000
+++ wag/wg2020.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'wag/wg2030.py'
--- wag/wg2030.py	2017-08-24 07:49:34 +0000
+++ wag/wg2030.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wg3010.py'
--- wag/wg3010.py	2017-08-24 07:49:34 +0000
+++ wag/wg3010.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg3020.py'
--- wag/wg3020.py	2017-08-24 07:49:34 +0000
+++ wag/wg3020.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg3030.py'
--- wag/wg3030.py	2017-08-24 07:49:34 +0000
+++ wag/wg3030.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wg3040.py'
--- wag/wg3040.py	2017-08-24 07:49:34 +0000
+++ wag/wg3040.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import ASD, GetCtl, RepPrt, Sql, TartanDialog

=== modified file 'wag/wg3050.py'
--- wag/wg3050.py	2017-08-24 07:49:34 +0000
+++ wag/wg3050.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import csv, os, time

=== modified file 'wag/wg3060.py'
--- wag/wg3060.py	2017-08-24 07:49:34 +0000
+++ wag/wg3060.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import CCD, GetCtl, NotesPrint, ProgressBar, RepPrt, Sql

=== modified file 'wag/wg3070.py'
--- wag/wg3070.py	2017-08-24 07:49:34 +0000
+++ wag/wg3070.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import os, time

=== modified file 'wag/wg4010.py'
--- wag/wg4010.py	2017-08-24 07:49:34 +0000
+++ wag/wg4010.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc110.py'
--- wag/wgc110.py	2017-08-24 07:49:34 +0000
+++ wag/wgc110.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc210.py'
--- wag/wgc210.py	2017-08-24 07:49:34 +0000
+++ wag/wgc210.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc220.py'
--- wag/wgc220.py	2017-08-24 07:49:34 +0000
+++ wag/wgc220.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc310.py'
--- wag/wgc310.py	2017-08-24 07:49:34 +0000
+++ wag/wgc310.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog

=== modified file 'wag/wgc320.py'
--- wag/wgc320.py	2017-08-24 07:49:34 +0000
+++ wag/wgc320.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc410.py'
--- wag/wgc410.py	2017-08-24 07:49:34 +0000
+++ wag/wgc410.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc420.py'
--- wag/wgc420.py	2017-08-24 07:49:34 +0000
+++ wag/wgc420.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time

=== modified file 'wag/wgc510.py'
--- wag/wgc510.py	2017-08-24 07:49:34 +0000
+++ wag/wgc510.py	2018-07-17 06:12:04 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import Sql, TartanDialog

=== modified file 'wag/wgc520.py'
--- wag/wgc520.py	2017-08-24 07:49:34 +0000
+++ wag/wgc520.py	2018-08-13 05:57:48 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 import time
@@ -54,7 +54,7 @@
             order="mss_system, mss_message")
         if not recs:
             showError(self.opts["mf"].body, "Transaction Error",
-            "No Transactions Selected")
+                "No Transactions Selected")
         else:
             self.printReport(recs)
         self.opts["mf"].closeLoop()

=== modified file 'wag/wgc610.py'
--- wag/wgc610.py	2017-08-24 07:49:34 +0000
+++ wag/wgc610.py	2018-08-13 06:33:08 +0000
@@ -8,7 +8,7 @@
     Written by Paul Malherbe, <paul@tartan.co.za>
 
 COPYING
-    Copyright (C) 2004-2017 Paul Malherbe.
+    Copyright (C) 2004-2018 Paul Malherbe.
 """
 
 from TartanClasses import GetCtl, Sql, TartanDialog
@@ -110,7 +110,7 @@
             self.tx = w
         else:
             if p != 3 and w <= self.rt:
-                return "Invalid rate, Less Than Previous"
+                return "Invalid Rate, Less Than Previous"
             self.rt = w
 
     def doEnd(self):

